<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These functions perform cross-validation regressions
    given either the output of prisma for
    full evaluation (prismaCrossValidate) or one
    PRS candidate data frame with SNPs in proper format
    (prsCrossValidate). Several metrics are 
    returned for inspection and evaluation and are all
    used in the PRISMA HTML report."><title>Functions to perform PRS cross-validation evaluations — prismaCvFuns • prisma</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functions to perform PRS cross-validation evaluations — prismaCvFuns"><meta property="og:description" content="These functions perform cross-validation regressions
    given either the output of prisma for
    full evaluation (prismaCrossValidate) or one
    PRS candidate data frame with SNPs in proper format
    (prsCrossValidate). Several metrics are 
    returned for inspection and evaluation and are all
    used in the PRISMA HTML report."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">prisma</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-introduction.html">Introduction to the prisma package</a>
    <a class="dropdown-item" href="../articles/02-installation.html">PRISMA installation</a>
    <a class="dropdown-item" href="../articles/03-gwasexperiment.html">The GWASExperiment class</a>
    <a class="dropdown-item" href="../articles/04-inoutfilter.html">Reading, writing and filtering files and objects</a>
    <a class="dropdown-item" href="../articles/05-imputemerge.html">Imputation of missing genotypes, genotype extension and dataset merging</a>
    <a class="dropdown-item" href="../articles/06-gwasfuns.html">Single trait association tests and summary statistics</a>
    <a class="dropdown-item" href="../articles/07-prsfuns.html">Derivation of PRS candidates and evaluation</a>
    <a class="dropdown-item" href="../articles/08-pipelines.html">Complete PRISMA pipelines</a>
    <a class="dropdown-item" href="../articles/09-external.html">Evaluation of external PRS or external GWAS</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pmoulos/prisma/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Functions to perform PRS cross-validation evaluations</h1>
      
      <div class="d-none name"><code>prismaCvFuns.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions perform cross-validation regressions
    given either the output of <code><a href="prismaFuns.html">prisma</a></code> for
    full evaluation (<code>prismaCrossValidate</code>) or one
    PRS candidate data frame with SNPs in proper format
    (<code>prsCrossValidate</code>). Several metrics are 
    returned for inspection and evaluation and are all
    used in the PRISMA HTML report.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">prismaCrossValidate</span><span class="op">(</span><span class="va">prismaOut</span>, <span class="va">gwe</span>, <span class="va">response</span>, 
        covariates <span class="op">=</span> <span class="cn">NULL</span>, pcs <span class="op">=</span> <span class="cn">FALSE</span>, 
        leaveOut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">10</span>,
        prsCalc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avg"</span>, <span class="st">"sum"</span>, <span class="st">"std"</span><span class="op">)</span>, family <span class="op">=</span> <span class="cn">NULL</span>, 
        rc <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>
    
    <span class="fu">prsCrossValidate</span><span class="op">(</span><span class="va">snpSelection</span>, <span class="va">gwe</span>, <span class="va">response</span>, 
        covariates <span class="op">=</span> <span class="cn">NULL</span>, pcs <span class="op">=</span> <span class="cn">FALSE</span>, leaveOut <span class="op">=</span> <span class="fl">0.05</span>,
        times <span class="op">=</span> <span class="fl">10</span>, prsCalc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avg"</span>, <span class="st">"sum"</span>, <span class="st">"std"</span><span class="op">)</span>,
        family <span class="op">=</span> <span class="cn">NULL</span>, rc <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>
    
    <span class="fu">applyPRS</span><span class="op">(</span><span class="va">snpSelection</span>, <span class="va">gwe</span>, <span class="va">response</span>, 
        covariates <span class="op">=</span> <span class="cn">NULL</span>, pcs <span class="op">=</span> <span class="cn">FALSE</span>, minSnps <span class="op">=</span> <span class="fl">2</span>,
        prsCalc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avg"</span>, <span class="st">"sum"</span>, <span class="st">"std"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">10</span>,
        family <span class="op">=</span> <span class="cn">NULL</span>, rc <span class="op">=</span> <span class="cn">NULL</span>,<span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>prismaOut</dt>
<dd><p>an output from the <code>link{prisma}</code>
    function containing the results of an iterative PRS
    extraction.</p></dd>
<dt>gwe</dt>
<dd><p>a <code>GWASExperiment</code> object (same as the one
    used to generate <code>prismaOut</code>).</p></dd>
<dt>snpSelection</dt>
<dd><p>A data frame with candidate SNPs, the
    output, or part of the output of 
    <code><a href="aggregatePrsMarkers.html">aggregatePrsMarkers</a></code>, or one of the list 
    members of the output of <code><a href="selectPrs.html">selectPrs</a></code>.</p></dd>
<dt>response</dt>
<dd><p>The trait for which a PRS is sought to be
    extracted. It should be a character of length 1 and exist
    in the phenotypes of <code>gwe</code>.</p></dd>
<dt>covariates</dt>
<dd><p>The covariates to include in regression
    models. It should be a character vector of traits all 
    existing in the phenotypes of <code>gwe</code>.</p></dd>
<dt>leaveOut</dt>
<dd><p>The fraction (percentage) of samples to
    leave-out in a cross-validation run. This can be a vector
    of multiple fractions for <code>prismaCrossValidate</code>.</p></dd>
<dt>times</dt>
<dd><p>For <code>prismaCrossValidate</code>, how many 
    cross-validations to perform. For <code>applyPRS</code>, the
    number of SNP randomizations to perform if summary 
    statistics are present to <code>gwe</code>. Defaults to 
    <code>10</code>. See also Details.</p></dd>
<dt>prsCalc</dt>
<dd><p>How the final PRS is calculated from the
    data frame of the PRS candidate SNPs? One of <code>"avg"</code> 
    (default), <code>"sum"</code> or <code>"std"</code>. See also 
    Details.</p></dd>
<dt>family</dt>
<dd><p>Regression family of functions, e.g. 
    <code>"gaussian"</code> for classical linear regression or
    <code>"binomial"</code> for logistic regression. See also
    <code><a href="gwaFuns.html">gwa</a></code>. Defaults to <code>NULL</code> for trying to
    set automatically.</p></dd>
<dt>pcs</dt>
<dd><p>Inlcude PCs in the regression model? Defaults
    to <code>FALSE</code>. See also Details.</p></dd>
<dt>minSnps</dt>
<dd><p>The minimum number of SNPs present in
    <code>gwe</code> in order to continue with PRS application
    using the genotypes of <code>gwe</code>. Defaults to 
    <code>2</code>.</p></dd>
<dt>rc</dt>
<dd><p>The fraction of available cores to use for 
    parallel calculations. Default is <code>NULL</code> for no
    parallelization.</p></dd>
<dt>...</dt>
<dd><p>Further arguments passed to regression 
    functions, like <code>glm</code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For <code>prismaCrossValidate</code>, a list of 
    cross-validation metrics, for each GWA method used, for
    each PRS candidate and for each leave-out percentage.
    The list is nested, with the first level being the GWA 
    method, the second level being the SNP candidates (named
    after the number of SNPs in the PRS candidate) and the
    third level being the leave-out percentage of samples
    in cross-validation. The actual value of the third
    level is a data frame with <code>times</code> rows, containing
    the metrics collected after each cross-validation,
    leaving out <code>leaveOut[i]</code> fraction of samples,
    with <code>i=1:ntimes</code>. This data frame is the output
    of <code>prsCrossValidate</code>. For the collected metrics,
    see Details.
    For <code>applyPRS</code> a list with three or four members:</p><ul><li><p><code>metrics</code>: The same as the cross
        validation metrics - see Details.</p></li>
<li><p><code>values</code>: A data frame with the following
        columns:</p><ul><li><p><code>raw_pheno</code>: The phenotype which
            the PRS contributes to its explanation</p></li>
<li><p><code>red_pheno</code>: The predicted phenotype
            in a regression model without the PRS as a
            covariate</p></li>
<li><p><code>full_pheno</code>: The predicted phenotype
            in a regression model including the PRS as a
            covariate</p></li>
<li><p><code>prs</code>: The PRS calculated according
            to <code>prsCalc</code></p></li>
</ul></li>
<li><p><code>plots</code>: A list of two ggplot objects:</p><ul><li><p><code>scatter</code>: A scatterplot of
            <code>raw_pheno</code> against <code>prs</code></p></li>
<li><p><code>hist</code>: A histogram of <code>prs</code></p></li>
</ul></li>
<li><p><code>permutations</code>: This is available only
        when <code>times &gt; 0</code> and only when summary 
        statistics (<code>effects</code> slot) are present in the
        <code>gwe</code> GWASExperiment object.</p><ul><li><p><code>metrics</code>: A matrics of evaluation
            metrics (same as the <code>metrics</code> upper level
            member) over <code>times</code> iterations (the number
            of rows)</p></li>
<li><p><code>bootp</code>: A bootstrap p-value denoting
            the statistical significance of the tested PRS
            being non-random (essentially the number of times
            the PRS R^2 of the random PRS is larger than
            the original PRS R^2 divided by <code>times</code>)</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Regarding the <code>prsCalc</code> argument, this tells the CV
    functions how to calculate the PRS in the model given the
    genotypic data. The three available method reflect the 
    three first ways of calculating the PRS in the PRSice2
    software (https://www.prsice.info/step_by_step/) and
    are named accordingly (see the <code>--score</code> option in
    PRSice2).</p>    
<p>Regarding the <code>pcs</code> argument, if <code>TRUE</code>, the PCs 
    in <code>gwe</code> will be used. If <code>gwe</code> does not contain 
    any PCs, a warning is issued and <code>pcs</code> is set to 
    <code>FALSE</code>.</p>    
<p>Regarding the <code>times</code> argument in the 
    <code>applyPRS</code> function, this instructs the function 
    to perform <code>times</code> random SNP selections from the
    input <code>gwe</code> and repeat the validation procedure 
    through the calculation of evaluation metrics. This 
    process is available only when summary statistics are
    present in <code>gwe</code> and is useful to test how a random
    PRS performs in explaining the examined phenotype. 
    Normally, the metrics should be worse. A boostrap 
    p-value is also calculated for some of the evaluation 
    metrics.</p>    
<p>Regarding the collected metrics, these are:</p><ul><li><p>R^2 of the reduced regression model 
        (<code>reduced_r2</code>): The R^2 of the reduced
        regression model, including all the covariates
        and PCs if requested, but not the PRS.</p></li>
<li><p>R^2 of the full regression model 
        (<code>full_r2</code>): The R^2 of the full regression
        model including all the covariates and the PRS.</p></li>
<li><p>R^2 of the PRS (<code>prs_r2</code>): The adjusted
        R^2 of the PRS (essentially R^2 of full model minus
        the R^2 of the reduced model).</p></li>
<li><p>Statistical significance (p-value) of the PRS 
        effect coefficient in the regression model
        (<code>prs_pvalue</code>).</p></li>
<li><p>R^2 of the reduced regression model 
        (<code>reduced_r2</code>): The R^2 of the reduced
        regression model, including all the covariates
        and PCs if requested, but not the PRS.</p></li>
<li><p>RMSE (Root Mean Squared Error) of the reduced 
        regression model (<code>reduced_rmse</code>): The RMSE of 
        the reduced regression model, including all the 
        covariates and PCs if requested, but not the PRS.</p></li>
<li><p>RMSE of the full regression model 
        (<code>full_rmse</code>): The RMSE of the full regression
        model including all the covariates and the PRS.</p></li>
<li><p>MAE (Mean Absolute Error) of the reduced 
        regression model (<code>reduced_mae</code>): The MAE of 
        the reduced regression model, including all the 
        covariates and PCs if requested, but not the PRS.</p></li>
<li><p>MAE of the full regression model 
        (<code>full_mae</code>): The MAE of the full regression
        model including all the covariates and the PRS.</p></li>
<li><p>Correlation between observed and predicted
        phenotype values for the reduced regression model
        (<code>reduced_pred_cor</code>).</p></li>
<li><p>Correlation between observed and predicted
        phenotype values for the full regression model
        (<code>full_pred_cor</code>).</p></li>
<li><p>R^2 for the observed and predicted phenotype
        values for the reduced regression model
        (<code>reduced_pred_r2</code>).</p></li>
<li><p>R^2 for the observed and predicted phenotype
        values for the full regression model
        (<code>full_pred_r2</code>).</p></li>
<li><p>R^2 of the PRS for the observed and predicted 
        phenotype values for the reduced regression model
        (<code>prs_pred_r2</code>).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Panagiotis Moulos</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">toy</span>,package<span class="op">=</span><span class="st">"prisma"</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">prisma_out</span>,package<span class="op">=</span><span class="st">"prisma"</span><span class="op">)</span></span>
<span class="r-in">    </span>
<span class="r-in">    <span class="va">response</span> <span class="op">&lt;-</span> <span class="st">"BMI"</span></span>
<span class="r-in">    <span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Case_Control"</span>,<span class="st">"Gender"</span>,<span class="st">"Age"</span><span class="op">)</span></span>
<span class="r-in">    </span>
<span class="r-in">    <span class="va">cvm</span> <span class="op">&lt;-</span> <span class="fu">prismaCrossValidate</span><span class="op">(</span><span class="va">prismaOut</span>,<span class="va">toy</span>,response<span class="op">=</span><span class="va">response</span>,</span>
<span class="r-in">        covariates<span class="op">=</span><span class="va">covariates</span>,leaveOut<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.4</span><span class="op">)</span>,times<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ################################################################</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running cross-validations for glm with 2 leave-out cases across 1 PRS candidates</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ################################################################</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validating PRS candidate with 24 markers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ----- Leave-out percentage 20% -----</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regressing with GLM</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Trait(s)    : BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Covariate(s): Case_Control, Gender, Age</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regression  : gaussian (predicted)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use PCs     : No</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ----- Leave-out percentage 40% -----</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regressing with GLM</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Trait(s)    : BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Covariate(s): Case_Control, Gender, Age</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regression  : gaussian (predicted)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use PCs     : No</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ################################################################</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running cross-validations for statgen with 2 leave-out cases across 1 PRS candidates</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ################################################################</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validating PRS candidate with 4 markers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ----- Leave-out percentage 20% -----</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regressing with GLM</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Trait(s)    : BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Covariate(s): Case_Control, Gender, Age</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regression  : gaussian (predicted)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use PCs     : No</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ----- Leave-out percentage 40% -----</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regressing with GLM</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Trait(s)    : BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Covariate(s): Case_Control, Gender, Age</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regression  : gaussian (predicted)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use PCs     : No</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ################################################################</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done! Use summarizeCvMetrics() and plotCvMetrics() to summarize and inspect the results.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ################################################################</span>
<span class="r-in">    </span>
<span class="r-in">    <span class="va">can</span> <span class="op">&lt;-</span> <span class="fu"><a href="prismaOutFuns.html">getPrsCandidates</a></span><span class="op">(</span><span class="va">prismaOut</span>,<span class="st">"glm"</span>,<span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">prsCrossValidate</span><span class="op">(</span><span class="va">can</span>,<span class="va">toy</span>,response<span class="op">=</span><span class="va">response</span>,</span>
<span class="r-in">        covariates<span class="op">=</span><span class="va">covariates</span>,leaveOut<span class="op">=</span><span class="fl">0.2</span>,times<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regressing with GLM</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Trait(s)    : BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Covariate(s): Case_Control, Gender, Age</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Regression  : gaussian (predicted)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use PCs     : No</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----&gt; Cross-validation iteration 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Partitioning dataset into 1 partitions by BMI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the reduced model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating the full model</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Panagiotis Moulos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

