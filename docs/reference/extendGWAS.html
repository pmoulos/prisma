<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is a convenient wrapper around the IMPUTE2
    program for imputing genotypes based on an initial 
    dataset of genotyped SNPs and a reference panel based on
    population studies such as the 1000 genomes project."><title>External imputation of GWAS data using IMPUTE2 — extendGWAS • prisma</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="External imputation of GWAS data using IMPUTE2 — extendGWAS"><meta property="og:description" content="This function is a convenient wrapper around the IMPUTE2
    program for imputing genotypes based on an initial 
    dataset of genotyped SNPs and a reference panel based on
    population studies such as the 1000 genomes project."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">prisma</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-introduction.html">Introduction to the prisma package</a>
    <a class="dropdown-item" href="../articles/02-installation.html">PRISMA installation</a>
    <a class="dropdown-item" href="../articles/03-gwasexperiment.html">The GWASExperiment class</a>
    <a class="dropdown-item" href="../articles/04-inoutfilter.html">Reading, writing and filtering files and objects</a>
    <a class="dropdown-item" href="../articles/05-imputemerge.html">Imputation of missing genotypes, genotype extension and dataset merging</a>
    <a class="dropdown-item" href="../articles/06-gwasfuns.html">Single trait association tests and summary statistics</a>
    <a class="dropdown-item" href="../articles/07-prsfuns.html">Derivation of PRS candidates and evaluation</a>
    <a class="dropdown-item" href="../articles/08-pipelines.html">Complete PRISMA pipelines</a>
    <a class="dropdown-item" href="../articles/09-external.html">Evaluation of external PRS or external GWAS</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pmoulos/prisma/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>External imputation of GWAS data using IMPUTE2</h1>
      
      <div class="d-none name"><code>extendGWAS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is a convenient wrapper around the IMPUTE2
    program for imputing genotypes based on an initial 
    dataset of genotyped SNPs and a reference panel based on
    population studies such as the 1000 genomes project.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">extendGWAS</span><span class="op">(</span><span class="va">obj</span>, intSize <span class="op">=</span> <span class="fl">1e+6</span>, wspace <span class="op">=</span> <span class="cn">NULL</span>, 
        refSpace <span class="op">=</span> <span class="cn">NULL</span>, continue <span class="op">=</span> <span class="cn">FALSE</span>,
        cleanup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"intermediate"</span>, <span class="st">"all"</span><span class="op">)</span>,
        runId <span class="op">=</span> <span class="cn">NULL</span>, convTool <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gtool"</span>, <span class="st">"qctool"</span><span class="op">)</span>,
        rc <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>obj</dt>
<dd><p>A <code>GWASEXperiment</code> object.</p></dd>
<dt>intSize</dt>
<dd><p>The interval size where IMPUTE2
    will operate. Defaults to <code>1e+6</code>. See also
    Details.</p></dd>
<dt>wspace</dt>
<dd><p>The path to a directory that will be used
    as IMPUTE2 workspace. If <code>NULL</code> a temporary 
    directory is used, however no intermediate files can
    be saved in this way. It is therefore advised to
    explicitly provide a path.</p></dd>
<dt>refSpace</dt>
<dd><p>The local directory where the IMPUTE2
    reference panel files are located. See also the 
    <code>link{download1000GP3}</code> function. If <code>NULL</code>
    it is assumed that the files have been downloaded in
    the default path used by the aforementioned function.</p></dd>
<dt>continue</dt>
<dd><p>Continue a crashed imputation session?
    Defaults to <code>FALSE</code> for the initial run. See also
    Details.</p></dd>
<dt>cleanup</dt>
<dd><p>The cleanup level after the imputation 
    process. <code>"none"</code> (default) leaves all the 
    intermediate files intact while <code>"intermediate"</code>
    removes interval GEN files and <code>"all"</code> removes the
    entire <code>wspace</code>.</p></dd>
<dt>runId</dt>
<dd><p>An identification string for the run. It
    is used to create a subdirectory inside <code>wspace</code>.
    If not provided (<code>NULL</code>, default), a random string
    is generated.</p></dd>
<dt>convTool</dt>
<dd><p>The conversion tool to use between GEN
    and PLINK file formats. Defaults to <code>"gtool"</code>. See
    also Details.</p></dd>
<dt>rc</dt>
<dd><p>The fraction of available cores to use. These
    are used to impute SNPs in multiple genomic intervals
    at the same time.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A (larger) GWASExperiment object with the imputed SNPs
    based on the IMPUTE2 reference panel. Bare in mind that
    the SNP ids that were not present in the initial
    GWASExperiment object do not follow the same naming 
    format but they have the names of the SNPs present
    in the reference panel used by IMPUTE2. The 
<code>gfeatures</code> of the output will be augmented by
    one column with the INFO score returned by IMPUTE2 and
    denoting the "trustworthiness" of the imputed position.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Regarding the <code>intSize</code> argument, this controls
    the genomic interval (on the same chromosome) where
    IMPUTE2 will impute reference panel variants based on
    the variants that exist on the same interval in
    <code>obj</code>. By default IMPUTE2 does not operate on
    whole chromosomes as the process will not be as accurate
    as operating on intervals and will take longer. Using
    intervals also IMPUTE2 is parallelized according to the
    <code>rc</code> parameter.</p>    
<p>Regarding the <code>continue</code> argument, this can be used
    to continue a crashed imputation session, provided that
    the path to the IMPUTE2 working space is given 
    (<code>wspace</code>). The function then automatically 
    determines what has been already done and restarts from
    a specific checkpoint. This funcionality is provided as 
    the imputation process may take a long time, especially
    for <code>GWASExperiment</code>s containing a lot of samples,
    and something could go wrong resulting in the stop of
    the process.</p>    
<p>Regarding the <code>"cleanup"</code> argument, the intermediate
    files produced are PLINK files and GEN files produced and
    and used by IMPUTE2 and also intermediate GEN files per
    imputation interval. These are removed in the case of
    <code>cleanup="intermediate"</code>, where also the final 
    imputed PLINK files are left on the workspace. If the
    workspace is not deleted, the output of the function can
    be recostructed using also the <code>runId</code>, otherwise, 
    the resulting <code>GWASExperiment</code> should be stored in 
    an RDA file for later usage.</p>    
<p>Regarding the <code>convTool</code> argument, this controls
    which external tool will be used for the conversion of
    PLINK files to GEN files and vice-versa. The default is
    <code>"gtool"</code> but we have experienced crashed therefore
    support for <code>"qctool"</code> was added. See also the
    <code><a href="downloadExternalFuns.html">downloadGtool</a></code> and 
    <code><a href="downloadExternalFuns.html">downloadQctool</a></code> functions.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Panagiotis Moulos</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="co"># The process may take long or crash because of the</span></span>
<span class="r-in">    <span class="co"># small sample size.</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">toy</span>,package<span class="op">=</span><span class="st">"prisma"</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">toyEx</span> <span class="op">&lt;-</span> <span class="fu">extendGWAS</span><span class="op">(</span><span class="va">toy</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Panagiotis Moulos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

