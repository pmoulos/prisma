<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function aggregates the results of an iterative
    PRS extraction derived using prsPipeline.
    The aggregation is done by intersecting or unifying the
    SNPs extracted by more than one PRS algorithms. The
    aggregated result can be then subjected to a PRS 
    selection process according to the frequency of 
    appearance of each marker and result in a subset of
    the aggregated markers as the final PRS."><title>Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers • prisma</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers"><meta property="og:description" content="This function aggregates the results of an iterative
    PRS extraction derived using prsPipeline.
    The aggregation is done by intersecting or unifying the
    SNPs extracted by more than one PRS algorithms. The
    aggregated result can be then subjected to a PRS 
    selection process according to the frequency of 
    appearance of each marker and result in a subset of
    the aggregated markers as the final PRS."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">prisma</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01-introduction.html">Introduction to the prisma package</a>
    <a class="dropdown-item" href="../articles/02-installation.html">PRISMA installation</a>
    <a class="dropdown-item" href="../articles/03-gwasexperiment.html">The GWASExperiment class</a>
    <a class="dropdown-item" href="../articles/04-inoutfilter.html">Reading, writing and filtering files and objects</a>
    <a class="dropdown-item" href="../articles/05-imputemerge.html">Imputation of missing genotypes, genotype extension and dataset merging</a>
    <a class="dropdown-item" href="../articles/06-gwasfuns.html">Single trait association tests and summary statistics</a>
    <a class="dropdown-item" href="../articles/07-prsfuns.html">Derivation of PRS candidates and evaluation</a>
    <a class="dropdown-item" href="../articles/08-pipelines.html">Complete PRISMA pipelines</a>
    <a class="dropdown-item" href="../articles/09-external.html">Evaluation of external PRS or external GWAS</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pmoulos/prisma/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Aggregate PRS candidate SNPs from iterative extraction</h1>
      
      <div class="d-none name"><code>aggregatePrsMarkers.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function aggregates the results of an iterative
    PRS extraction derived using <code><a href="prismaFuns.html">prsPipeline</a></code>.
    The aggregation is done by intersecting or unifying the
    SNPs extracted by more than one PRS algorithms. The
    aggregated result can be then subjected to a PRS 
    selection process according to the frequency of 
    appearance of each marker and result in a subset of
    the aggregated markers as the final PRS.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">aggregatePrsMarkers</span><span class="op">(</span><span class="va">gwaList</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intersect"</span>, 
        <span class="st">"union"</span><span class="op">)</span>, qcut <span class="op">=</span> <span class="fl">0.9</span>, assoc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"glm"</span>,
        <span class="st">"rrblup"</span>, <span class="st">"statgen"</span>, <span class="st">"snptest"</span>, <span class="st">"plink"</span>, <span class="st">"lasso"</span><span class="op">)</span>,
        avgfun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"weight"</span><span class="op">)</span>, gwe <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>gwaList</dt>
<dd><p>A list of GWASExperiments or their 
    summaries as derived from <code><a href="prismaFuns.html">prsPipeline</a></code>.</p></dd>
<dt>mode</dt>
<dd><p>Aggregation mode, can be <code>"intersect"</code>
    (default) or <code>"union"</code>.</p></dd>
<dt>qcut</dt>
<dd><p>A quantile cutoff for the frequency of SNP
    appearances in <code>gwaList</code>. SNPs with frequencies 
    below the one corresponding to this quantile are ignored
    from the output.</p></dd>
<dt>assoc</dt>
<dd><p>Which effects to use out of the performed
    GWA tests as the SNP weights in PRS. Can be <code>"auto"</code>
    (default) or any of <code>"glm"</code>, <code>"rrblup"</code>, 
    <code>"statgen"</code>, <code>"snptest"</code>, <code>"plink"</code>, as
    long as it exists. See also Details.</p></dd>
<dt>avgfun</dt>
<dd><p>How to summarize SNP effects (regression 
    coefficients) after the iterative extraction process.
    One of <code>"mean"</code> (default), <code>"median"</code> or 
    <code>"weight"</code>. See also Details.</p></dd>
<dt>gwe</dt>
<dd><p>The GWASExperiment object used to derive the
    PRS. If given, the output is a more complete data frame,
    harmonized with the scores from EBI PGS Catalog.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>gwe</code> is not <code>NULL</code>, a data frame of SNP
    markers summarized a <code>prsPipeline</code> run with the
    following columns:</p><ul><li><p><code>chromosome</code>: the chromosome where the 
        marker is located</p></li>
<li><p><code>position</code>: the marker position in
        chromosome</p></li>
<li><p><code>variant_id</code>: SNP rs id or other 
        identification where available</p></li>
<li><p><code>risk_allele</code>: The risk allele</p></li>
<li><p><code>reference_allele</code>: The non-risk allele</p></li>
<li><p><code>locus_name</code>: The SNP's closest gene
        (<code>NA</code> here, assigned later through 
        <code><a href="assignGenes.html">assignGenes</a></code>)</p></li>
<li><p><code>effect_weight</code>: The SNP effect as 
        derived from regression functions and <code>avgfun</code></p></li>
<li><p><code>OR</code>: The <code>effect_weight</code> 
        transformed to Odds Ratio</p></li>
<li><p><code>asm</code>: The genome assembly (<code>"hg19"</code>
        or <code>"hg38"</code> or <code>"nr"</code> if unknown)</p></li>
<li><p><code>freq</code>: The number of appearances in the
        <code>prsPipeline</code> iterative process</p></li>
</ul><p>If <code>gwe</code> is <code>NULL</code>, a simpler data frame of
    SNP marker with the following columns:</p><ul><li><p><code>snp</code> SNP rs id or other 
        identification where available</p></li>
<li><p><code>freq</code> The number of appearances in the
        <code>prsPipeline iterative process</code></p></li>
<li><p><code>effect</code> The SNP effect as derived
        from regression functions and <code>avgfun</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Regarding the <code>assoc</code> argument, this controls which
    effects should be included in the final PRS data frame,
    out of the available ones. If <code>"auto"</code> (the 
    default), the final effects are selected based on the
    GWA algorithms that have been executed and an internal
    prioritization scheme according to our perception 
    regarding algorithm popularity. Specifically, the
    first available effects are used based on the following
    prioritization:</p><ol><li><p>SNPTEST (<code>"snptest"</code>)</p></li>
<li><p>PLINK (<code>"plink"</code>)</p></li>
<li><p>statgenGWAS (<code>"statgen"</code>)</p></li>
<li><p>GLM (<code>"glm"</code>)</p></li>
<li><p>rrBLUP (<code>"rrblup"</code>)</p></li>
</ol><p>In the future we intend to combine all available
    effects based on linear optimization methods (work in
    progress)</p>    
<p>Regarding the <code>avgfun</code> argument, this controls how
    the SNP effects in PRS candidates are summarized after 
    the iterative PRS extraction process in order to produce 
    the final effects for the calculation of weighted PRS. 
    When <code>"mean"</code> (default), the final effect for a SNP 
    is the mean off all its effects across the iterations
    and when it appears. When <code>"median"</code>, it is the 
    respective median while when <code>"weight"</code>, the SNP 
    effects are weighted by 1 minus the recorded PRS R^2 so 
    that the "best" runs can be given more value.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Panagiotis Moulos</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">toy</span>,package<span class="op">=</span><span class="st">"prisma"</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">prisma_out</span>,package<span class="op">=</span><span class="st">"prisma"</span><span class="op">)</span></span>
<span class="r-in">    </span>
<span class="r-in">    <span class="va">iters</span> <span class="op">&lt;-</span> <span class="va">prismaOut</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">glm</span><span class="op">$</span><span class="va">iterations</span></span>
<span class="r-in">    <span class="co">#iters &lt;- getRawIterations(prismaOut,"glm")</span></span>
<span class="r-in">    <span class="va">snps</span> <span class="op">&lt;-</span> <span class="fu">aggregatePrsMarkers</span><span class="op">(</span><span class="va">iters</span>,qcut<span class="op">=</span><span class="fl">0.25</span>,gwe<span class="op">=</span><span class="va">toy</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregation mode: intersect</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iteration 1 yields 3 markers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iteration 2 yields 62 markers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iteration 3 yields 40 markers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   iteration 4 yields 2 markers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating frequencies</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Averaging effects with mean</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Constructing output</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done!</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Panagiotis Moulos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

