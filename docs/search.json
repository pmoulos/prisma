[{"path":"/articles/01-introduction.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to the prisma package","text":"rise modern genotyping technologies Next Generation Sequencing (Whole Exome Whole Genome Sequencing) well continuous thriving older genotyping technologies genotyping DNA microarrays allowed unprecedented collection massive, large-cohort population-level genetic data spanning variety application, medical research consumer genomics. time, several perspective sometimes country-level studies reaching maturity levels regarding amount quality data collected various levels anthropometric, phenotypic, biomarker genetic levels, times molecular -omics layers gene expression. aforementioned facts allowed accurate versatile Genome-Wide Association Studies identify potential genetic cause many simple complex genetic traits also combine phenotypic genotypic data unique ways derive multi-way genetic signatures characterize individuals respect several anthropometric features well traits biomarker levels. genetic signatures seamingly endless portfolio applications, spanning characterization predisposition individual general healthstyle issues obesity estimating risk several diseases like cancer potential life-threatening conditions including cardiovascular disease kidney malfunction. also used characterize less life-threatening conditions deteriorate general well-psychological disease anomalies central nervous system. aforementioned biotechnological thriving well increased complete data sources availability (coupled genotypic phenotypic records large cohorts) gradually allowing creation exploration Polygenic Risk Scores risk predictors evaluators variety disease healthstyle conditions. Polygenic Risk Scores (PRS) (usually) simple genotype scoring schemes take account many variants individual based calculated score, attempt assess heritable risk developing/expressing particular phenotype combination phenotypes. phenotypes can disease-related phenotypes cancer, cardiovascular disease obesity, plain lifestyle traits endurance sports effects caffeine. different Genetic Risk Scores (GRS) sense GRSs compiled (usually) limited number well characterized variants related particular phenotype across literature strong statistical evidence, PRSs relaxed regarding statistical power comprise usually much number variants accounting additive genetic risk individual given /total genetic profile. PRS GRS essentially variables constructed based (weighted) sum genotypes (usually coded 0, 1, 2 according alleles genotype) comprise covariates regression models attempt explain observed genotypic/phenotypic relationships. approach seems -simplified, nevertheless shown numerous studies genetic scores able explain aforementioned variabilities times even outperform complex Machine Learning approaches. , succesful model construction, distribution PRS constructed based ppopulation used extract calculate PRS, based distribution, risk new samples can assessed according position new PRS reference distribution. process extracting PRS complex includes main following steps: Derivation summary statistics (regression coefficients/Odds Ratios, p-values etc.) variant major representative population study (often GWAS) recording also phenotypes interest. Filtering variants according potential informative redundancy (Linkage Disequilbrium), content respect population (Hardy-Weinberg Equilibrium) statistical significance/power contribute phenotype investigation (effects assessed regression coefficients, p-values). process often refered Clumping + Thresholding although popular sole method reduce noise extracting PRS. Another often complementary process penalized regression lasso. Construction PRS: step, variants (usually SNPs) passed filtering procedure used calculate PRS. various ways calculate PRS, simplest one just sum genotypes (0, 1, 2) popular seem weighted PRS genotype marker (SNP, variant) participating PRS mutliplied inferred effect given summary statistics e.g. GWAS. Multiple PRSs can constructed tested given different thresholds p-values /scores. PRSs constructed based genotypes samples ones used derive summary statistics, otherwise, strong overfitting effects observed. Construction evaluation multiple regression models: step many regression models fitted evaluated PRS candidates covariates aim select PRS providing largest explanatory power terms metric R2 model significance PRS covariate (p-value). strategy followed e.g. PRSice-2. strategies exist selecting one PRS without repetitions using SNPs PRS effect-shrinking methods (lassosum ) using penalized regression LASSO techniques. Selection evaluation final PRS candidates goal selecting final PRS phenotype investigation. evaluation can done based split--test cross-validations initital dataset. case, final PRS subjected slight changes initial dataset changed (e.g. new samples added).","code":""},{"path":[]},{"path":"/articles/01-introduction.html","id":"general-introduction","dir":"Articles","previous_headings":"The PRISMA package","what":"General introduction","title":"Introduction to the prisma package","text":"PRISMA package designed provide one-stop shop PRS extraction evaluation steps described . top , implements linear optimization methodology combines regression effects multiple statistical tests GWAS-like association tests offers variety PRS evaluation metrics scores. Furthermore, PRISMA implements semi- automated methodology selecting suggesting best performing PRS candidates extracted based iterative procedure input dataset split training (summary statistics) test (PRS extraction) subsets resulting PRS candidates integrated evaluated resulting best candidate sets. findings finally collected described interactive report also includes lookup selected SNPs EBI GWAS Catalog. Finally, PRISMA offers several side functions facilities merging datasets (e.g. two datasets complement datasets coming different array platforms), input/output functions also SNP imputation based reference panels wrapping IMPUTE2. Although generally assumed PRS extraction evaluation based summary statistics calculalated GWAS based sufficiently large homogenous possible cohorts may always possible. Examples include smaller cohorts used study rare disease (e.g. pediatric nephropathies) examine traits smaller groups isolated populations athletic groups. cases, PRS extraction process result rather unstable PRSs terms SNP content. fact, instability may also show cases sufficiently large populations used estimate summary statistics. PRISMA tries provide solution cases offering resampling framework PRS candidates partly stabilized based ensemble technique markers gathered PRSs based aggregation multiple PRS extraction runs smart usage state--art algorithms PRSice2 lassosum, coupled semi-automated selection best candidates based metrics R2 regression models including PRS covariate.","code":""},{"path":"/articles/01-introduction.html","id":"summary-statistics-extraction-and-gwas-analysis","dir":"Articles","previous_headings":"The PRISMA package","what":"Summary statistics extraction and GWAS analysis","title":"Introduction to the prisma package","text":"PRISMA supports five methods estimating SNP effects single-trait associations. specifically: General Linear Models (GLM), respective R functions. SNP regressed phenotype selected covariates. SNP effects p-value reported. Ridge regression R package rrBLUP. package deploys penalized regression shrinking effects less informative SNPs relation phenotype. Single-trait association tests statgenGWAS R package. association based linear regression incorporation internally calculated kinship matrix. Frequentist association tests SNPTEST (Oxford). SNP regressed phenotype selected covariates using additive model (SNPTEST options also supported). Association tests PLINK (linear regression covariates simple X2 association tests covariates present).","code":""},{"path":"/articles/01-introduction.html","id":"de-novo-prs-extraction","dir":"Articles","previous_headings":"The PRISMA package","what":"De novo PRS extraction","title":"Introduction to the prisma package","text":"PRISMA currently supports two methods extracting PRSs. specifically: PRSice2, operates based PLINK framework automates PRS extraction process based clumping thresholding followed weighted PRS construction evaluation linear regression. lassosum, utilizes penalized (LASSO) regression shrink effects less informative variants without completely removing PRS. default, PRISMA uses PRSice2 lassosum offers two ways integrating results: . intersecting PRS candidates algorithm ii. considering respective union. cases, effects GWA tests considered weights SNP constructed PRS.","code":""},{"path":"/articles/01-introduction.html","id":"prisma-pipelines-for-prs-extraction","dir":"Articles","previous_headings":"The PRISMA package","what":"PRISMA pipelines for PRS extraction","title":"Introduction to the prisma package","text":"Starting set phenotypic genotypic data assembled PRISMA GWASExperiment object /PRS external resource (e.g. PGS Catalog) can used subset former, PRISMA supports four pipelines outlined . Prior pipeline, basic filtering genotypic data performed across SNPs samples, missing genotype imputation performed followed PCA (optionally) extract covariates characterizing whole available population. stored original object, used towards final steps model evaluation.","code":""},{"path":"/articles/01-introduction.html","id":"de-novo-prs-extraction-pipeline","dir":"Articles","previous_headings":"The PRISMA package > PRISMA pipelines for PRS extraction","what":"De novo PRS extraction pipeline","title":"Introduction to the prisma package","text":"main PRS candidate extraction pipeline performs following steps: 1. Split input data object usually larger training set smaller independent test set. 2. De novo quality control training test sets well optional PCA training set capture local population structure used covariates subsequent GWA tests. 3. Execution GWA tests phenotype using one supported methods extract summary statistics (SNP effects p-values). 4. Execution one PRS extraction algorithms derive PRS candidate SNPs. Steps (1) – (4) executed N times different training test sets capture much variation selection process possible. Subsequently: candidate SNPs PRSs extracted iteration aggregated frequency appearance recorded. time, new effects calculated either averaging SNP effects iteration, statistically valid process generally corrects overfitting, weighted averaging effects based performance PRSs constructed iteration (measured adjusted PRS R2 returned PRSice2).","code":""},{"path":"/articles/01-introduction.html","id":"de-novo-prs-evaluation-pipeline","dir":"Articles","previous_headings":"The PRISMA package > PRISMA pipelines for PRS extraction","what":"De novo PRS evaluation pipeline","title":"Introduction to the prisma package","text":"evaluation de novo extracted PRS pipeline performs following steps: Create sets PRS candidates step (5) de novo PRS extraction pipeline based : Fixed quantiles frequency distribution (e.g. 10%, 20%, 30%, 40%, 50%, 60%, 75%, 80%, 90%, 95%, 99%). stepwise set creation process based frequency appearance, .e. set contains SNPs appear 5, 6, … maximum number appearances. set created (1), split de novo initial data object training test set. Using training test, reperform GWA tests extract summary statistics (averaged effects used) use PRSice2 PRS application mode assess PRS sets (1) test set new summary statistics. Evaluate PRS application using adjusted PRS R2 coefficient PRSice2. Steps (2) (3) repeated M times (ideally M=N iterations). pipeline includes heavy input/output form PLINK files quite slow. cases may accurate though, although provide straightforward way calculating final SNP effects PRS. Finally, pipeline may appropriate evaluating external PGS scores, like scores retrieved PGS Catalog.","code":""},{"path":"/articles/01-introduction.html","id":"prs-evaluation-pipeline-based-on-the-original-traintest-split-with-prsice2","dir":"Articles","previous_headings":"The PRISMA package > PRISMA pipelines for PRS extraction","what":"PRS evaluation pipeline based on the original train/test split with PRSice2","title":"Introduction to the prisma package","text":"pipeline similar de novo PRS evaluation pipeline uses initial train/test split described PRS evaluation. steps similar described evaluation performed PRSice2 framework, limiting somehow available model evaluation metrics. Also, averaged SNP effects used.","code":""},{"path":"/articles/01-introduction.html","id":"prs-evaluation-pipeline-based-on-the-original-traintest-split-with-r","dir":"Articles","previous_headings":"The PRISMA package > PRISMA pipelines for PRS extraction","what":"PRS evaluation pipeline based on the original train/test split with R","title":"Introduction to the prisma package","text":", pipeline similar one described time evaluation done native R functions (manual PRS construction outside PRSice2 followed GLM regressions). fastest evaluation pipeline allows collection many additional metrics.","code":""},{"path":"/articles/01-introduction.html","id":"prs-selection-process","dir":"Articles","previous_headings":"The PRISMA package","what":"PRS selection process","title":"Introduction to the prisma package","text":"final PRS selection several candidates performed two-step semi-automatic process involves graphical inspection evaluation plots also suggestion best PRSs using simple mathematical functions evaluation plots.","code":""},{"path":"/articles/01-introduction.html","id":"the-prisma-adjusted-prs-r2","dir":"Articles","previous_headings":"The PRISMA package > PRS selection process","what":"The PRISMA adjusted PRS R2","title":"Introduction to the prisma package","text":"Although many cases related work based R2 coefficient (adjusted versions one suggested PRSice2) explain phenotypic variance percentages explained PRS, often desired PRS may include huge number SNPs construction, several reasons, including: Potential overfitting including many SNPs may heavily dependent specific populations used derive summary statistics, thus presenting problematic generalization applied slightly different populations. ability use non-high-throughput techniques derive genotypes, qPCR, benefit smaller number markers genotyping. Easier downstream investigation tracking SNP markers included PRS. Potential robustness tuning predictive regression model, example including excluding covariates. reasons, introduce PRISMA adjusted PRS R2 calculated using formula: \\[R_{P}^{2} = \\sqrt[2]{\\frac{R_{PRS}^{2}}{log(N)}} \\] \\(R_{PRS}^{2}\\) adjusted R2 explaining PRS contribution (R2 full model including PRS – R2 reduced model including covariates phenotype) N number SNPs included PRS. Essentially, \\(R_{P}^{2}\\) penalizes \\(R_{PRS}^{2}\\) according number SNPs N, maintaining scale monotonic pattern using square root. practice, seriously differ using \\(R_{PRS}^{2}\\) selection optimal number SNPs, useful controlling number SNPs maintaining accuracy desirable.","code":""},{"path":"/articles/01-introduction.html","id":"graphical-evaluations","dir":"Articles","previous_headings":"The PRISMA package > PRS selection process","what":"Graphical evaluations","title":"Introduction to the prisma package","text":"executing possible evaluation pipeline, best PRS firstly evaluated graphically : bar plot average adjusted PRS R2 ± standard deviations SNP frequency cutoff can checked cutoff increasing R2 compared baseline (R2 de novo PRS extraction iterations). dot plot PRISMA adjusted PRS R2 R_P^2, can inspected adjusted R2 potentially maximized. dot plot SNP frequencies.","code":""},{"path":"/articles/01-introduction.html","id":"automatic-prs-selection","dir":"Articles","previous_headings":"The PRISMA package > PRS selection process","what":"Automatic PRS selection","title":"Introduction to the prisma package","text":"number SNPs finally used build one candidate PRS determined two possible stepwise SNP inclusion methods: Using Elbow method, essentially detects cutoff number SNPs PRS R2 metrics significantly increase including SNPs PRS. method can applied R2 distribution mostly monotonic. detecting local maxima R2 distribution, corresponding local maximizations latter specific number SNPs. main PRS includes SNPs maximize \\(R_{PRS}^{2}\\) \\(R_{P}^{2}\\) compensate number SNPs PRS (default behavior). option returns also SNP sets local maxima R2 distribution. similar approach like (ii) regarding maximization R2 used recent work presented study.","code":""},{"path":"/articles/01-introduction.html","id":"prs-evaluation-metrics","dir":"Articles","previous_headings":"The PRISMA package","what":"PRS evaluation metrics","title":"Introduction to the prisma package","text":"following metrics used evaluation PRS candidates iterative selection: Full regression model R2: R2 model including PRS. Reduced model R2: R2 model without PRS (covariates phenotype interrogation). Adjusted PRS R2: PRSice2 adjusted PRS R2. Full reduced model Root Mean Squared Error (RMSE). Full reduced model Mean Absolute Error (MAE). Statistical significance average differences using Student’s t-test, Wilcoxon rank test empirical bootstrap p-value. metrics collected evaluation pipeline vanilla R also cross-validation runs based regression models selected PRSs total available dataset.","code":""},{"path":"/articles/01-introduction.html","id":"prs-retrieval-from-external-resources","dir":"Articles","previous_headings":"The PRISMA package","what":"PRS retrieval from external resources","title":"Introduction to the prisma package","text":"PRISMA supports retrieval candidate PRSs candidate PRS components (SNPs) trait following resources: EBI PRS Catalog EBI GWAS Catalog Retrieval data regarding specific PRS also impute.currently tested. data retrieved online resources harmonized common format including recording existing PRS coefficients, statistical significance, related loci GWAS association scores (p-values). also enriched following data: Location assignment dbSNP (rs) ids provided. dbSNP id assignment location provided. Locus (gene) assignment provided possible (.e. SNP intronic). resulting structure can used one PRISMA pipelines evaluate retrieved PRS (.e. check markers needed local data) reconstruct PRS.","code":""},{"path":"/articles/01-introduction.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick start","title":"Introduction to the prisma package","text":"commands can executed within R's command line interface use toy data accompanying package. many details regarding installation, usage package presentation, also look vignettes. running examples, least installed PRSice2 (also look Installation vignette) visible R (.e. included system's PATH variable).","code":""},{"path":"/articles/01-introduction.html","id":"load-some-toy-data","dir":"Articles","previous_headings":"Quick start","what":"Load some toy data","title":"Introduction to the prisma package","text":"toy dataset contains genotypes chromosomes 18 21 case/control described Kalafati et al.. trait PRS candidates sought Body-Mass Index (continuous variable).","code":"library(prisma)  data(toy,package=\"prisma\") gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")"},{"path":"/articles/01-introduction.html","id":"apply-some-filters","dir":"Articles","previous_headings":"Quick start","what":"Apply some filters","title":"Introduction to the prisma package","text":"","code":"# Lose filters for the toy dataset filts <- getDefaults(\"filters\") filts$IBD <- NA filts$hwe <- 1e-3 filts$pcaOut <- FALSE filts$inbreed <- NA"},{"path":"/articles/01-introduction.html","id":"full-pipeline---create-prs-candidates","dir":"Articles","previous_headings":"Quick start","what":"Full pipeline - create PRS candidates","title":"Introduction to the prisma package","text":"","code":"# Workspace d1 <- tempfile() wspace1 <- file.path(tempdir(),d1)  # Traits response <- \"BMI\" covariates <- c(\"Case_Control\",\"Gender\",\"Age\")  # Complete 4-iteration PRS pipeline - ~1 min to run with 4 cores - no PCA if (Sys.which(\"PRSice_linux\") != \"\") {     prismaOut <- prisma(         gwe=toy,         phenotype=response,         covariates=covariates,         pcs=FALSE,         trainSize=0.8,         niter=4,         resolution=\"frequency\",         minSnps=2,         filters=filts,         pcaMethod=\"snprel\",         imputeMissing=FALSE,         gwaMethods=c(\"glm\",\"statgen\"),         prsiceOpts=list(clump_p=0.75,perm=100),         prsWorkspace=wspace1,         cleanup=\"intermediate\",         logging=\"file\",         output=\"normal\",         rc=0.25     ) }"},{"path":"/articles/01-introduction.html","id":"step-by-step-pipeline","dir":"Articles","previous_headings":"Quick start","what":"Step-by-step pipeline","title":"Introduction to the prisma package","text":", execute step--step individual steps implemented prisma wrapper statgenGWAS GWA testing.","code":""},{"path":"/articles/01-introduction.html","id":"iterate-prs-extraction-over-the-dataset","dir":"Articles","previous_headings":"Quick start > Step-by-step pipeline","what":"1. Iterate PRS extraction over the dataset","title":"Introduction to the prisma package","text":"","code":"d2 <- tempfile() wspace2 <- file.path(tempdir(),d2) if (Sys.which(\"PRSice_linux\") != \"\") {     dnList <- prsPipeline(         gwe=toy,         phenotype=response,         covariates=covariates,         pcs=FALSE,         trainSize=0.8,         niter=4,         filters=filts,         pcaMethod=\"snprel\",         imputeMissing=FALSE,         gwaMethods=\"statgen\",         prsiceOpts=list(clump_p=0.75,perm=100),         prsWorkspace=wspace2,         cleanup=\"intermediate\",         logging=\"file\",         rc=0.25     ) }"},{"path":"/articles/01-introduction.html","id":"calculate-the-evaluation-metrics-that-lead-to-prs-selection","dir":"Articles","previous_headings":"Quick start > Step-by-step pipeline","what":"2. Calculate the evaluation metrics that lead to PRS selection","title":"Introduction to the prisma package","text":"","code":"d3 <- tempfile() wspace3 <- file.path(tempdir(),d3) evalMetrics <- prsSelection(     dnList=dnList,     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=\"statgen\",     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace3,     cleanup=\"intermediate\",     logging=\"file\",     output=\"summary\",     useDenovoWorkspace=dnList,     rc=0.25 )"},{"path":"/articles/01-introduction.html","id":"based-on-the-metrics-find-the-best-prs-candidates","dir":"Articles","previous_headings":"Quick start > Step-by-step pipeline","what":"3. Based on the metrics, find the best PRS candidates","title":"Introduction to the prisma package","text":"prisma wrapper implements additional steps assemble results create plots displayed final report.","code":"candidates <- selectPrs(     metrics=evalMetrics$metrics,     snpSelection=evalMetrics$pgs,     gwe=toy,     base=evalMetrics$baseline )"},{"path":"/articles/01-introduction.html","id":"complete-prisma-pipeline-with-report","dir":"Articles","previous_headings":"Quick start","what":"Complete PRISMA pipeline with report","title":"Introduction to the prisma package","text":"prismaPipeline wrapper servers complete \"wrapper wrapper\" \"meta-wrapper\" end--end PRS extraction pipeline, SNP effect estimation given population genotypes phenotypes. pipeline runs prisma wrapper making sure crashes resumed (10 times default), followed cross-validation PRS candidates, lookup EBI GWAS Catalog creation HTML report.","code":"outPath <- tempfile() d4 <- tempfile() wspace4 <- file.path(outPath,d4)  # Traits response <- \"BMI\" covariates <- c(\"Case_Control\",\"Gender\",\"Age\")  prismaPipeline(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=c(\"glm\",\"statgen\"),     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace4,     cleanup=\"intermediate\",     logging=\"file\",     output=\"normal\",     rc=0.25,     outPath=outPath ) ##  ## $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ## This is PRISMA 0.0.2 PRS builder ## $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ##  ## @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ## 2022-06-06 20:21:49 - Try 1 ## @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ##  ## 2022-06-06 20:21:49: Data processing started... ##  ## Input ## -------------------------------------------------------------------- ## Input object (gwe) : a GWASExperiment object with 1000 markers (SNPs) and 100 samples ##  ## Regression parameters ## -------------------------------------------------------------------- ## Phenotypic response (phenotype)          : BMI ## Regression covariates (covariates)       : Case_Control, Gender, Age ## Principal Components in covariates (pcs) : No ## Number of Principal Components (npcs)    : - ##  ## Preprocessing options ## -------------------------------------------------------------------- ## Sample and genotype filtering options (filters)     : ##   snpCallRate    : 0.98 ##   sampleCallRate : 0.95 ##   maf            : 0.05 ##   hwe            : 0.001 ##   heteroStat     : median ##   heteroFac      : 3 ##   heteroHard     : NA ##   pcaOut         : No ##   pcaRobust      : hubert ##   nPC            : NA ##   LD             : 0.2 ##   IBD            : NA ##   inbreed        : NA ## Principal Components calculation method (pcaMethod) : snprel ## Impute missing genotypes (imputeMissing)            : No ## Missing genotype imputation method (imputeMethod)   : singlesplit ##  ## GWA analysis options ## -------------------------------------------------------------------- ## Genome-Wide Association tests (gwaMethods)        : glm, statgen ## Association tests combination method (gwaCombine) : fishersimesmaxminharmonicwhitlockpandora ## Association tests options                         : ##   glm : ##     family : - ##     size   : 1 ##   statgen : ##     kinship : astle ##     reml    : EMMA ##     gls     : single ##  ## PRS candidate extraction options ## -------------------------------------------------------------------- ## PRS extraction algorithms (prsMethods) : lassosum, prsice ## PRS algorithms options (prsMethods)    : ##   lassosum : ##     anc   : eur ##     valid : auto ##   prsice : ##     clump_kb : 250 ##     clump_r2 : 0.1 ##     clump_p  : 0.75 ##     score    : avg ##     perm     : 100 ##     seed     : 42 ##  ## PRS construction and evaluation options ## -------------------------------------------------------------------- ## Training set size (trainSize)                               : 80% ## Number of PRS selection iterations (niter)                  : 4 ## PRS selection resolution method (resolution)                : frequency ## PRS selection resolution step (step)                        : 1 ## Minimum SNP frequency in PRS (minFreq)                      : 2 ## Minimum number of SNPs in PRS (minSnps)                     : 2 ## Drop quantiles with same number of SNPs (dropSameQuantiles) : Yes ## PRS aggregation method (aggregation)                        : intersectionunion ## SNP effect summarization method (effectWeight)              : meanmedianweight ## PRS evaluation framework (evalWith)                         : vanillaprscice ##  ## PRS selection options ## -------------------------------------------------------------------- ## PRS selection method (prsSelectMethod)           : maxima ## PRS selection criterion (prsSelectCrit)          : prs_r2 ## PRS criterion summarization (prsSelectStat)      : mean ## R^2 type if criterion includes R^2 (prsSelectR2) : adjusted ##  ## Miscellaneous options ## -------------------------------------------------------------------- ## Local workspace directory (prsWorkspace) : /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2 ## Cleanup level (cleanup)                  : intermediate ## PRS pipeline output type (dnOutput)      : normal ## Output level (output)                    : normal ## Run ID (runId)                           : auto ## Available cores fraction (rc)            : 25% ##  ## **************************************************************** ## Executing PRISMA pipeline with glm ## **************************************************************** ##  ## ################################################################ ## 1. Discovery of de novo PRS candidates ## ################################################################ ## prisma operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline ##  ## Executing denovo pipeline iteration 1, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_iter_1.log ## ================================================================ ## -----> Denovo pipeline iteration 1 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 120 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 124 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 13 associations (uncorrected p-values). ##  ## Overall, found 13 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 13 associations (uncorrected p-values). ##  ## Overall, found 13 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 13 associations found out of 562 markers ##   Part 21: 13 associations found out of 317 markers ##  ## Overall, found 26 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1 ## Preparing lassosum run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0299419330259365 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1 ## Preparing PRSice run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1/base_ASEYL8061W \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1/pheno_ASEYL8061W \\ ##   --target /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1/plink_prsice_ASEYL8061W \\ ##   --cov /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1/covar_ASEYL8061W \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_ASEYL8061W \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.128117 ## Full model R^2 is: 0.460406 ## Null model R^2 is: 0.332289 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 1 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_1/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 2, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_iter_2.log ## ================================================================ ## -----> Denovo pipeline iteration 2 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 116 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 142 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 28 associations (uncorrected p-values). ##  ## Overall, found 28 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 13 associations (uncorrected p-values). ##  ## Overall, found 13 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 28 associations found out of 569 markers ##   Part 21: 13 associations found out of 315 markers ##  ## Overall, found 41 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2 ## Preparing lassosum run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.000260334133183589 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2 ## Preparing PRSice run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2/base_RPITG5899K \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2/pheno_RPITG5899K \\ ##   --target /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2/plink_prsice_RPITG5899K \\ ##   --cov /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2/covar_RPITG5899K \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_RPITG5899K \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0462982 ## Full model R^2 is: 0.454096 ## Null model R^2 is: 0.407798 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 2 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_2/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 3, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_iter_3.log ## ================================================================ ## -----> Denovo pipeline iteration 3 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 120 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 122 ##   Hardy-Weinberg equilibrium: 3 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 28 associations (uncorrected p-values). ##  ## Overall, found 28 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 15 associations (uncorrected p-values). ##  ## Overall, found 15 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 28 associations found out of 566 markers ##   Part 21: 15 associations found out of 314 markers ##  ## Overall, found 43 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3 ## Preparing lassosum run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.00649079901227329 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3 ## Preparing PRSice run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3/base_IURIS9128L \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3/pheno_IURIS9128L \\ ##   --target /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3/plink_prsice_IURIS9128L \\ ##   --cov /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3/covar_IURIS9128L \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_IURIS9128L \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0704192 ## Full model R^2 is: 0.620807 ## Null model R^2 is: 0.550387 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 3 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_3/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 4, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_iter_4.log ## ================================================================ ## -----> Denovo pipeline iteration 4 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 123 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 124 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 19 associations (uncorrected p-values). ##  ## Overall, found 19 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 14 associations (uncorrected p-values). ##  ## Overall, found 14 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 19 associations found out of 566 markers ##   Part 21: 14 associations found out of 311 markers ##  ## Overall, found 33 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4 ## Preparing lassosum run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0745972421160187 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4 ## Preparing PRSice run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4/base_FPGMY8235M \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4/pheno_FPGMY8235M \\ ##   --target /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4/plink_prsice_FPGMY8235M \\ ##   --cov /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4/covar_FPGMY8235M \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_FPGMY8235M \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0861154 ## Full model R^2 is: 0.604763 ## Null model R^2 is: 0.518648 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 4 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline/TAQGFLMFRTW7949V_denovo_4/denovo_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/baseline ##  ## ################################################################ ## 2. Calculation of PRS evaluation metrics ## ################################################################ ## Aggregation mode: intersect ##   iteration 1 yields 8 markers ##   iteration 2 yields 10 markers ##   iteration 3 yields 187 markers ##   iteration 4 yields 80 markers ## Calculating frequencies ## Averaging effects with mean ## Constructing output ## Done! ##  ## ================================================================ ## -----> Frequency 2 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2/2_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs9977668 ##  ## ----- Saving iteration 1 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2/2_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2/2_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ## 2 SNPs not found in target data! Excluding... ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs9977668 ##  ## ----- Saving iteration 2 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2/2_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2/2_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs9977668 ##  ## ----- Saving iteration 3 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2/2_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2/2_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs9977668 ##  ## ----- Saving iteration 4 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2/2_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/2 ##  ## ================================================================ ## -----> Frequency 3 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3/3_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs8093690 ##  ## ----- Saving iteration 1 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3/3_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3/3_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs8093690 ##  ## ----- Saving iteration 2 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3/3_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3/3_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs8093690 ##  ## ----- Saving iteration 3 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3/3_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3/3_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs8093690 ##  ## ----- Saving iteration 4 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3/3_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/3 ##  ## ================================================================ ## -----> Frequency 4 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4/4_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs7280065 ##  ## ----- Saving iteration 1 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4/4_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4/4_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs7280065 ##  ## ----- Saving iteration 2 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4/4_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4/4_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs7280065 ##  ## ----- Saving iteration 3 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4/4_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4/4_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs7280065 ##  ## ----- Saving iteration 4 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4/4_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/glm/selection/4 ##  ## ################################################################ ## 3. Selection of best PRS candidate markers ## ################################################################ ## The optimal number of markers for PRS based on prs_r2 is 3 at prs_r2=0.12735 ##  ## ################################################################ ## 4. Wrap-up and graphics ## ################################################################ ## sitadela database found at /home/panos/.local/share/R/sitadela directory ## Getting latest annotation on the fly for hg19 from refseq ## Retrieving genome information for hg19 from refseq ## Retrieving latest gene annotation for hg19 from refseq ## Loading required namespace: RMySQL ## Converting annotation to GenomicRanges object... ##  ## Attaching package: 'Biostrings' ## The following object is masked from 'package:base': ##  ##     strsplit ## Getting DNA sequences... ## Getting GC content... ##  ## **************************************************************** ## Executing PRISMA pipeline with statgen ## **************************************************************** ##  ## ################################################################ ## 1. Discovery of de novo PRS candidates ## ################################################################ ## prisma operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline ##  ## Executing denovo pipeline iteration 1, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_iter_1.log ## ================================================================ ## -----> Denovo pipeline iteration 1 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 120 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 118 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 28 associations (uncorrected p-values). ##  ## Overall, found 28 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 17 associations (uncorrected p-values). ##  ## Overall, found 17 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 28 associations found out of 565 markers ##   Part 21: 17 associations found out of 315 markers ##  ## Overall, found 45 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1 ## Preparing lassosum run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0290419547627459 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1 ## Preparing PRSice run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1/base_WDLAA4420N \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1/pheno_WDLAA4420N \\ ##   --target /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1/plink_prsice_WDLAA4420N \\ ##   --cov /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1/covar_WDLAA4420N \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_WDLAA4420N \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0367345 ## Full model R^2 is: 0.678118 ## Null model R^2 is: 0.641384 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 1 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_1/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 2, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_iter_2.log ## ================================================================ ## -----> Denovo pipeline iteration 2 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 120 ##   Hardy-Weinberg equilibrium: 4 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 128 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 20 associations (uncorrected p-values). ##  ## Overall, found 20 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 19 associations (uncorrected p-values). ##  ## Overall, found 19 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 20 associations found out of 565 markers ##   Part 21: 19 associations found out of 313 markers ##  ## Overall, found 39 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2 ## Preparing lassosum run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.00454142411810441 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2 ## Preparing PRSice run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2/base_HKQMJ5481Y \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2/pheno_HKQMJ5481Y \\ ##   --target /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2/plink_prsice_HKQMJ5481Y \\ ##   --cov /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2/covar_HKQMJ5481Y \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_HKQMJ5481Y \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.102703 ## Full model R^2 is: 0.770589 ## Null model R^2 is: 0.667886 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 2 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_2/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 3, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_iter_3.log ## ================================================================ ## -----> Denovo pipeline iteration 3 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 124 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 118 ##   Hardy-Weinberg equilibrium: 0 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 22 associations (uncorrected p-values). ##  ## Overall, found 22 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 17 associations (uncorrected p-values). ##  ## Overall, found 17 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 22 associations found out of 563 markers ##   Part 21: 17 associations found out of 313 markers ##  ## Overall, found 39 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3 ## Preparing lassosum run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0085994593263661 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3 ## Preparing PRSice run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3/base_MHDVL4655S \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3/pheno_MHDVL4655S \\ ##   --target /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3/plink_prsice_MHDVL4655S \\ ##   --cov /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3/covar_MHDVL4655S \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_MHDVL4655S \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.163973 ## Full model R^2 is: 0.581528 ## Null model R^2 is: 0.417555 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 3 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_3/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 4, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_iter_4.log ## ================================================================ ## -----> Denovo pipeline iteration 4 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 119 ##   Hardy-Weinberg equilibrium: 4 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 120 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 21 associations (uncorrected p-values). ##  ## Overall, found 21 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 13 associations (uncorrected p-values). ##  ## Overall, found 13 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 21 associations found out of 563 markers ##   Part 21: 13 associations found out of 316 markers ##  ## Overall, found 34 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4 ## Preparing lassosum run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0180435952879536 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4 ## Preparing PRSice run at workspace directory: /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4/base_VSKNM0230S \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4/pheno_VSKNM0230S \\ ##   --target /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4/plink_prsice_VSKNM0230S \\ ##   --cov /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4/covar_VSKNM0230S \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_VSKNM0230S \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0654275 ## Full model R^2 is: 0.554396 ## Null model R^2 is: 0.488968 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 4 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline/TAQGFLMFRTW7949V_denovo_4/denovo_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/baseline ##  ## ################################################################ ## 2. Calculation of PRS evaluation metrics ## ################################################################ ## Aggregation mode: intersect ##   iteration 1 yields 1 markers ##   iteration 2 yields 5 markers ##   iteration 3 yields 23 markers ##   iteration 4 yields 2 markers ## Calculating frequencies ## Averaging effects with mean ## Constructing output ## Done! ##  ## ================================================================ ## -----> Frequency 2 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2/2_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs508857 to rs7280065 ##  ## ----- Saving iteration 1 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2/2_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2/2_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs508857 to rs7280065 ##  ## ----- Saving iteration 2 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2/2_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2/2_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs508857 to rs7280065 ##  ## ----- Saving iteration 3 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2/2_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2/2_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs508857 to rs7280065 ##  ## ----- Saving iteration 4 result to /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2/2_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpfOBGMb/file9f86ff09697//tmp/RtmpfOBGMb/file9f87292a3d2/statgen/selection/2 ##  ## ################################################################ ## 3. Selection of best PRS candidate markers ## ################################################################ ## The optimal number of markers for PRS based on prs_r2 is 4 at prs_r2=0.16732 ##  ## ################################################################ ## 4. Wrap-up and graphics ## ################################################################ ## sitadela database found at /home/panos/.local/share/R/sitadela directory ## Getting latest annotation on the fly for hg19 from refseq ## Retrieving genome information for hg19 from refseq ## Retrieving latest gene annotation for hg19 from refseq ## Converting annotation to GenomicRanges object... ## Getting DNA sequences... ## Getting GC content... ##  ## 2022-06-06 20:25:41: Data processing finished! ## Total processing time: 03 minutes 51 seconds ## @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ## 2022-06-06 20:25:41 - Cross-validation ## @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ##  ## ################################################################ ## Running cross-validations for glm with 10 leave-out cases across 1 PRS candidates ## ################################################################ ##  ## ================================================================ ## -----> Cross-validating PRS candidate with 3 markers ## ================================================================ ##  ## ----- Leave-out percentage 5% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 10% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 15% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 20% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 25% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 30% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 35% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 40% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 45% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 50% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ################################################################ ## Running cross-validations for statgen with 10 leave-out cases across 1 PRS candidates ## ################################################################ ##  ## ================================================================ ## -----> Cross-validating PRS candidate with 4 markers ## ================================================================ ##  ## ----- Leave-out percentage 5% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 10% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 15% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 20% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 25% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 30% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 35% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 40% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 45% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 50% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ################################################################ ## Done! Use summarizeCvMetrics() and plotCvMetrics() to summarize and inspect the results. ## ################################################################ ##  ## @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ## 2022-06-06 20:26:05 - GWAS Catalog lookup ## @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ## -----> Querying for glm ## Querying GWAS Catalog with the largest PRS ## -----> Querying for statgen ## Querying GWAS Catalog with the largest PRS ##  ## @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ## 2022-06-06 20:26:08 - Report ## @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ## processing file: prisma_report.Rmd ##  ## Attaching package: 'pander' ## The following object is masked from 'package:htmltools': ##  ##     p ##  ## Attaching package: 'grid' ## The following object is masked from 'package:Biostrings': ##  ##     pattern ## Summarizing cross-validation statistics for PRS with 3 SNPs ## Summarizing cross-validation statistics for PRS with 4 SNPs ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## A project name here ## output file: prisma_report.knit.md ## /usr/bin/pandoc +RTS -K512m -RTS prisma_report.knit.md --to html4 --from markdown+autolink_bare_uris+tex_math_single_backslash --output /tmp/RtmpfOBGMb/file9f86ff09697/index.html --variable 'robobook:true' --variable 'lightbox:true' --variable 'gallery:false' --variable 'cards:true' --variable bs3=TRUE --standalone --section-divs --table-of-contents --toc-depth 2 --template /home/panos/R/x86_64-pc-linux-gnu-library/4.1/rmdformats/templates/template.html --highlight-style kate --variable theme=bootstrap --include-in-header /tmp/RtmpfOBGMb/rmarkdown-str9f855104b09.html ##  ## Output created: /tmp/RtmpfOBGMb/file9f86ff09697/index.html"},{"path":"/articles/01-introduction.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R session info","title":"Introduction to the prisma package","text":"","code":"sessionInfo() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 18.04.6 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] grid      stats4    stats     graphics  grDevices utils     datasets  ## [8] methods   base      ##  ## other attached packages: ##  [1] pander_0.6.5                      magrittr_2.0.3                    ##  [3] htmltools_0.5.2                   ggplot2_3.3.5                     ##  [5] DT_0.22                           kableExtra_1.3.4                  ##  [7] rmdformats_1.0.3                  knitr_1.39                        ##  [9] BSgenome.Hsapiens.UCSC.hg19_1.4.3 BSgenome_1.62.0                   ## [11] rtracklayer_1.54.0                Biostrings_2.62.0                 ## [13] XVector_0.34.0                    prisma_0.0.2                      ## [15] SNPRelate_1.28.0                  gdsfmt_1.30.0                     ## [17] snpStats_1.44.0                   Matrix_1.4-1                      ## [19] survival_3.3-1                    SummarizedExperiment_1.24.0       ## [21] Biobase_2.54.0                    GenomicRanges_1.46.1              ## [23] GenomeInfoDb_1.30.1               IRanges_2.28.0                    ## [25] S4Vectors_0.32.4                  BiocGenerics_0.40.0               ## [27] MatrixGenerics_1.6.0              matrixStats_0.62.0                ## [29] lassosum_0.4.5                    ##  ## loaded via a namespace (and not attached): ##  [1] utf8_1.2.2             R.utils_2.11.0         tidyselect_1.1.2       ##  [4] gwascat_2.26.0         htmlwidgets_1.5.4      RSQLite_2.2.14         ##  [7] AnnotationDbi_1.56.2   BiocParallel_1.28.3    munsell_0.5.0          ## [10] codetools_0.2-18       ragg_1.2.2             future_1.25.0          ## [13] withr_2.5.0            quincunx_0.1.4         islasso_1.4.3          ## [16] colorspace_2.0-3       filelock_1.0.2         OrganismDbi_1.36.0     ## [19] highr_0.9              rstudioapi_0.13        robustbase_0.95-0      ## [22] TTR_0.24.3             listenv_0.8.0          labeling_0.4.2         ## [25] urltools_1.7.3         optparse_1.7.1         GenomeInfoDbData_1.2.7 ## [28] farver_2.1.0           bit64_4.0.5            rprojroot_2.0.3        ## [31] parallelly_1.31.1      vctrs_0.4.1            generics_0.1.2         ## [34] xfun_0.31              BiocFileCache_2.2.1    R6_2.5.1               ## [37] bitops_1.0-7           cachem_1.0.6           DelayedArray_0.20.0    ## [40] assertthat_0.2.1       gwasrapidd_0.99.12     BiocIO_1.4.0           ## [43] Homo.sapiens_1.3.1     scales_1.2.0           gtable_0.3.0           ## [46] globals_0.15.0         rlang_1.0.2            systemfonts_1.0.4      ## [49] splines_4.1.3          rsnps_0.5.0.0          sitadela_1.3.1         ## [52] BiocManager_1.30.16    yaml_2.3.5             reshape2_1.4.4         ## [55] crosstalk_1.2.0        GenomicFeatures_1.46.5 quantmod_0.4.20        ## [58] RMySQL_0.10.23         RBGL_1.70.0            tools_4.1.3            ## [61] lava_1.6.10            bookdown_0.26          liftOver_1.18.0        ## [64] ellipsis_0.3.2         jquerylib_0.1.4        Rcpp_1.0.8.3           ## [67] rrBLUP_4.6.1           plyr_1.8.7             progress_1.2.2         ## [70] zlibbioc_1.40.0        purrr_0.3.4            RCurl_1.98-1.6         ## [73] prettyunits_1.1.1      cowplot_1.1.1          zoo_1.8-10             ##  [ reached getOption(\"max.print\") -- omitted 92 entries ]"},{"path":"/articles/02-installation.html","id":"prisma-installation","dir":"Articles","previous_headings":"","what":"PRISMA installation","title":"PRISMA installation","text":"Apart CRAN Bioconductor dependencies, PRISMA also depends : presence certain system packages presence lassosum CRAN Bioconductor presence certain 3rd party tools must findable PRISMA (can installed also PRISMA functions) following outline whole process.","code":""},{"path":[]},{"path":"/articles/02-installation.html","id":"system-packages","dir":"Articles","previous_headings":"PRISMA installation > Prerequisites","what":"System packages","title":"PRISMA installation","text":"may already installed system. might additional ones depending Linux distribution prisma installed . list maintained updated.","code":"sudo apt install -y apt-transport-https software-properties-common \\     build-essential zlib1g-dev libdb-dev libcurl4-openssl-dev libssl-dev \\     libxml2-dev apache2 libfontconfig1-dev libjpeg-dev"},{"path":[]},{"path":"/articles/02-installation.html","id":"basic-installation-of-bioconductor","dir":"Articles","previous_headings":"PRISMA installation > Prerequisites > R packages","what":"Basic installation of Bioconductor","title":"PRISMA installation","text":"","code":"if (!require(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\") BiocManager::install(version = \"3.15\")"},{"path":"/articles/02-installation.html","id":"additional-packages","dir":"Articles","previous_headings":"PRISMA installation > Prerequisites > R packages","what":"Additional packages","title":"PRISMA installation","text":"following packages either CRAN Bioconductor: Also, lassosum CRAN:","code":"pkgs <- c(\"BSgenome.Hsapiens.UCSC.hg19\",\"BSgenome.Hsapiens.UCSC.hg38\",     \"Biobase\",\"biomaRt\",\"BSgenome\",\"data.table\",\"GenomicRanges\",\"ggplot2\",     \"gwasrapidd\",\"harmonicmeanp\",\"islasso\",\"jsonlite\",\"kableExtra\",\"knitr\",     \"liftOver\",\"Matrix\",\"magrittr\",\"methods\",\"openxlsx\",\"pander\",\"parallel\",     \"PhenotypeSimulator\",\"quincunx\",\"R.utils\",\"rmarkdown\",\"rmdformats\",     \"RcppArmadillo\",\"RMTstat\",\"rrBLUP\",\"rrcov\",\"rsnps\",\"rtracklayer\",     \"S4Vectors\",\"scales\",\"scrime\",\"snpStats\",\"SNPRelate\",     \"SNPlocs.Hsapiens.dbSNP151.GRCh38\",\"statgenGWAS\",\"SummarizedExperiment\",     \"survcomp\",\"testthat\",\"tseries\",\"utils\")  BiocManager::install(pkgs) library(devtools) install_github(\"tshmak/lassosum\")"},{"path":"/articles/02-installation.html","id":"other-external-tools-and-resources","dir":"Articles","previous_headings":"PRISMA installation > Prerequisites","what":"Other external tools and resources","title":"PRISMA installation","text":"following tools findable R, example included system's PATH environmental variable.","code":""},{"path":"/articles/02-installation.html","id":"summary-statistics","dir":"Articles","previous_headings":"PRISMA installation > Prerequisites > Other external tools and resources","what":"Summary statistics","title":"PRISMA installation","text":"SNPTEST PLINK","code":""},{"path":"/articles/02-installation.html","id":"prs-extraction","dir":"Articles","previous_headings":"PRISMA installation > Prerequisites > Other external tools and resources","what":"PRS extraction","title":"PRISMA installation","text":"PRSice-2","code":""},{"path":"/articles/02-installation.html","id":"other-tools-format-conversion-and-imputation","dir":"Articles","previous_headings":"PRISMA installation > Prerequisites > Other external tools and resources","what":"Other tools (format conversion and imputation)","title":"PRISMA installation","text":"GTOOL QCTOOL IMPUTE2 IMPUTE2 reference panel files","code":""},{"path":"/articles/02-installation.html","id":"installation-of-prisma","dir":"Articles","previous_headings":"PRISMA installation","what":"Installation of PRISMA","title":"PRISMA installation","text":"PRISMA can installed GitHub time :","code":"library(devtools) install_github(\"pmoulos/prisma\")"},{"path":"/articles/02-installation.html","id":"installation-of-3rd-party-tools","dir":"Articles","previous_headings":"","what":"Installation of 3rd party tools","title":"PRISMA installation","text":"order exploit PRISMA functionalities, certain 3rd party tools calculation summary statistics, PRS extraction, file format conversion imputation must present system. Particulalry, PRSice-2 must present findable, otherwise PRS extraction functionalities (also main purpose package) limited. Furthermore, wish manually run full test-suite package, certain tests skipped required 3rd party tools present. 3rd party tools can installed outside R PRISMA manually withing R via PRISMA package funcitonalities. first case, manual steps required freedom user install tools whatever location, long placed system's PATH variable. second case, tools downloaded installed automatically must live specific location defined R faclities order findable PRISMA.","code":""},{"path":"/articles/02-installation.html","id":"installation-of-3rd-party-tools-outside-prisma","dir":"Articles","previous_headings":"Installation of 3rd party tools","what":"Installation of 3rd party tools outside PRISMA","title":"PRISMA installation","text":"installation location can user wishes . , assume tools installed ~/prs-tools:","code":"TOOLS_HOME=~/prs-tools mkdir -p $TOOLS_HOME"},{"path":[]},{"path":"/articles/02-installation.html","id":"snptest","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools outside PRISMA > Installation of tools for summary statistics","what":"SNPTEST","title":"PRISMA installation","text":"assume version 2.5.4 Ubuntu:","code":"mkdir -p $TOOLS_HOME/snptest-2.5.4 && cd $TOOLS_HOME/snptest-2.5.4 wget --no-check-certificate  http://www.well.ox.ac.uk/~gav/resources/snptest_v2.5.4-beta3_linux_x86_64_static.tgz tar -xvf snptest_v2.5.4-beta3_linux_x86_64_static.tgz cd snptest_v2.5.4-beta3_linux_x86_64_static mv * ../ && cd ../ rm -r snptest_v2.5.4-beta3_linux_x86_64_static* # PRISMA expects to find an executable named snptest mv snptest_v2.5.4-beta3 snptest"},{"path":"/articles/02-installation.html","id":"plink","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools outside PRISMA > Installation of tools for summary statistics","what":"PLINK","title":"PRISMA installation","text":"assume version 1.90 64-bit Linux:","code":"mkdir -p $TOOLS_HOME/plink-1.90 && cd $TOOLS_HOME/plink-1.90 wget https://s3.amazonaws.com/plink1-assets/plink_linux_x86_64_20220402.zip unzip plink_linux_x86_64_20220402.zip rm plink_linux_x86_64_20220402.zip"},{"path":[]},{"path":"/articles/02-installation.html","id":"installation-of-prsice-2","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools outside PRISMA > Installation of PRS extraction tools","what":"Installation of PRSice-2","title":"PRISMA installation","text":"assume version 2.3.5 64-bit Linux:","code":"mkdir -p $TOOLS_HOME/prsice-2.3.5 && cd $TOOLS_HOME/prsice-2.3.5 wget https://github.com/choishingwan/PRSice/releases/download/2.3.5/PRSice_linux.zip unzip PRSice_linux.zip rm PRSice_linux.zip"},{"path":[]},{"path":"/articles/02-installation.html","id":"installation-of-impute2","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools outside PRISMA > Installation of additional tools","what":"Installation of IMPUTE2","title":"PRISMA installation","text":"assume version 2.3.2 Linux:","code":"mkdir -p $TOOLS_HOME/impute-2.3.2 && cd $TOOLS_HOME/impute-2.3.2 wget --no-check-certificate https://mathgen.stats.ox.ac.uk/impute/impute_v2.3.2_x86_64_static.tgz tar -xvf impute_v2.3.2_x86_64_static. cd impute_v2.3.2_x86_64_static mv * ../ cd .. rm -r impute_v2.3.2_x86_64_static*"},{"path":"/articles/02-installation.html","id":"installation-of-gtool","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools outside PRISMA > Installation of additional tools","what":"Installation of GTOOL","title":"PRISMA installation","text":"assume version 0.7.5 Linux:","code":"mkdir -p $TOOLS_HOME/gtool-0.7.5 && cd $TOOLS_HOME/gtool-0.7.5 wget --no-check-certificate  https://www.well.ox.ac.uk/~cfreeman/software/gwas/gtool_v0.7.5_x86_64.tgz tar -xvf gtool_v0.7.5_x86_64.tgz rm gtool_v0.7.5_x86_64.tgz"},{"path":"/articles/02-installation.html","id":"installation-of-qctool","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools outside PRISMA > Installation of additional tools","what":"Installation of QCTOOL","title":"PRISMA installation","text":"assume version 2.2.0 later version Linux (e.g. Ubuntu > 18.04). older versions, either download version 2.0.8 GTOOL enough. PRISMA uses QCTOOL GTOOL convert PED files GEN format later Linux systems, reason GTOOL fails (older tools!)","code":"mkdir -p $TOOLS_HOME/qctool-2.2.0 && cd $TOOLS_HOME/qctool-2.2.0 wget --no-check-certificate https://www.well.ox.ac.uk/~gav/resources/qctool_v2.2.0-CentOS_Linux7.8.2003-x86_64.tgz tar -xvf qctool_v2.2.0-CentOS_Linux7.8.2003-x86_64.tgz cd qctool_v2.2.0-CentOS\\ Linux7.8.2003-x86_64/ mv * ../ rm -r qctool_v2.2.0-CentOS\\ Linux7.8.2003-x86_64/ qctool_v2.2.0-CentOS_Linux7.8.2003-x86_64.tgz"},{"path":"/articles/02-installation.html","id":"editing-the-path-variable","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools outside PRISMA","what":"Editing the PATH variable","title":"PRISMA installation","text":"following now added end ~/.bashrc file end ~/.profile file shell starting file according Linux operating system version. Windows, similar path must followed, described example . logout re-login : changes take effect.","code":"PRS_TOOLS=~/prs-tools # or wherever the TOOLS_HOME variable points to export PATH=$PATH:\\     $TOOLS_HOME/snptest-2.5.4:\\     $TOOLS_HOME/plink-1.90:\\     $TOOLS_HOME/prsice-2.3.5:\\     $TOOLS_HOME/impute-2.3.2:\\     $TOOLS_HOME/gtool-0.7.5:\\     $TOOLS_HOME/qctool-2.2.0: source ~/.basrhc"},{"path":"/articles/02-installation.html","id":"installation-of-impute2-reference-panel","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools outside PRISMA","what":"Installation of IMPUTE2 reference panel","title":"PRISMA installation","text":"take time. Also, path reference stored somewhere within PRISMA provided every time extendGWAS function used. path reference file $TOOLS_HOME/impute_reference/1000GP_Phase3.","code":"mkdir -p $TOOLS_HOME/impute_reference && cd $TOOLS_HOME/impute_reference wget --no-check-certificate https://mathgen.stats.ox.ac.uk/impute/1000GP_Phase3.tgz tar -xvf 1000GP_Phase3.tgz rm 1000GP_Phase3.tgz"},{"path":"/articles/02-installation.html","id":"installation-of-3rd-party-tools-within-prisma","dir":"Articles","previous_headings":"Installation of 3rd party tools","what":"Installation of 3rd party tools within PRISMA","title":"PRISMA installation","text":"installation location specific defined tools::R_user_dir(d). , inside directory, aforementioned name convention followed tool, .e. tool_name_in_lowercase/tool.version. choose install way instead manual installation placing PATH variable, tools moved otherwise PRISMA able find . user prompted accept installation path. download wrapper downloads, installs tests tools.","code":"library(prisma)"},{"path":"/articles/02-installation.html","id":"installation-of-all-tools","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools within PRISMA","what":"Installation of all tools","title":"PRISMA installation","text":"","code":"downloadExternalTools()"},{"path":[]},{"path":"/articles/02-installation.html","id":"snptest-1","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools within PRISMA > Installation of tools for summary statistics","what":"SNPTEST","title":"PRISMA installation","text":"assume version 2.5.4 Ubuntu:","code":"downloadSnptest(ver=\"v2.5.4\")"},{"path":"/articles/02-installation.html","id":"plink-1","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools within PRISMA > Installation of tools for summary statistics","what":"PLINK","title":"PRISMA installation","text":"assume version 1.90 64-bit Linux:","code":"downloadPlink(ver=\"v1.90\") # or just # downloadPlink()"},{"path":[]},{"path":"/articles/02-installation.html","id":"installation-of-prsice-2-1","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools within PRISMA > Installation of PRS extraction tools","what":"Installation of PRSice-2","title":"PRISMA installation","text":"assume version 2.3.5 64-bit Linux:","code":"downloadPrsice(ver=\"v2.3.5\") # or just # downloadPrsice()"},{"path":[]},{"path":"/articles/02-installation.html","id":"installation-of-impute2-1","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools within PRISMA > Installation of additional tools and resources","what":"Installation of IMPUTE2","title":"PRISMA installation","text":"assume version 2.3.2 Linux:","code":"downloadImpute2(ver=\"v2.3.2\") # or just # downloadImpute2()"},{"path":"/articles/02-installation.html","id":"installation-of-gtool-1","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools within PRISMA > Installation of additional tools and resources","what":"Installation of GTOOL","title":"PRISMA installation","text":"assume version 0.7.5 Linux:","code":"downloadGtool(ver=\"v0.7.5\") # or just # downloadGtool()"},{"path":"/articles/02-installation.html","id":"installation-of-qctool-1","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools within PRISMA > Installation of additional tools and resources","what":"Installation of QCTOOL","title":"PRISMA installation","text":"assume version 2.2.0 later version Linux (e.g. Ubuntu > 18.04). older versions, either download version 2.0.8 GTOOL enough. PRISMA uses QCTOOL GTOOL convert PED files GEN format later Linux systems, reason GTOOL fails (older tools!)","code":"downloadQctool(ver=\"v2.2.0\") # or just # downloadQctool()"},{"path":"/articles/02-installation.html","id":"installation-of-impute2-reference-panel-1","dir":"Articles","previous_headings":"Installation of 3rd party tools > Installation of 3rd party tools within PRISMA","what":"Installation of IMPUTE2 reference panel","title":"PRISMA installation","text":"take time. Also, path reference stored somewhere within PRISMA provided every time extendGWAS function used. path reference file TOOLS_HOME/impute_reference/1000GP_Phase3.","code":"dir.create(\"TOOLS_HOME/impute_reference\") download1000GP3(\"TOOLS_HOME/impute_reference\")"},{"path":"/articles/02-installation.html","id":"test-the-prisma-installation","dir":"Articles","previous_headings":"","what":"Test the PRISMA installation","title":"PRISMA installation","text":"Prior build release, perform extensive tests shipping package. wish run tests (can take time) :","code":"library(testthat) test_package(\"prisma\")"},{"path":"/articles/03-gwasexperiment.html","id":"the-gwasexperiment-class","dir":"Articles","previous_headings":"","what":"The GWASExperiment class","title":"The GWASExperiment class","text":"following subsections outline main data object used throughout package various data interchange package functions.","code":""},{"path":"/articles/03-gwasexperiment.html","id":"description-and-structure","dir":"Articles","previous_headings":"The GWASExperiment class","what":"Description and structure","title":"The GWASExperiment class","text":"main data structure PRISMA GWASExperiment class briefly provides facilities : Data import using facilities Bioconductor package snpStats. Data integrity checks, data selections well recording metadata gathered analysis steps, filtering result tracking Principal Component Analysis. Robust Principal Component Analysis automatic exclusion outlier samples (R package rrcov. Automatic selection informative PCs used population stratification covariates subsequent GWAS PRS analyses using Tracy-Widom statistic. SNP call rate. Minor Allele Frequency monomorphic markers (MAF). Hardy-Weinberg equilibrium (HWE). Linkage Disequilibrium pruning (LD). Sample call rate. Heterozygosity. Identity Descent (IBD, preceded LD pruning). Outlier filtering based robust PCA preceded LD pruning. Iterative imputation using facilities snpStats package (regression SNP nearby ones extraction imputation rules). remaining missing values, imputation using R package scrime, specialized missing value imputation genotypic data. Slots hold marker calculated effects statistical significance (p-values) application one multiple GWA tests, number association tests (e.g. using different covariates). Facilities combining outcome multiple GWA tests (p-value combination methods). Slots hold outcome PRS extraction outcomes (effects adjusted betas). Apart GWASExperiment class, PRISMA deploys additional simpler structures goals Grouping results way useful reporting. Harmonizing PRS candidate SNP format accompanying details format similar scores format PGS Catalog. Finally, aforementioned missing value imputation process found 88% 92% accurate imputing known genotypes (data shown report).","code":""},{"path":"/articles/03-gwasexperiment.html","id":"object-design","dir":"Articles","previous_headings":"The GWASExperiment class","what":"Object design","title":"The GWASExperiment class","text":"GWASExperiment class direct extension SummarizedExperiment class, additional slots host phenotypes, statistical outcomes, effects used weight PRS candidates certain metadata. , main extensions summarized (information please see related man page): rowData slot/accessor SummarizedExperiment renamed gfeatures (rowData can still used formatting checks performed may cause crashes) DataFrame SNP data similar contents PLINK bim files, imported snpStats. colData slot/accessor SummarizedExperiment renamed gsamples (colData can still used ) DataFrame SNP data similar contents PLINK fam files, imported snpStats. assays assay slot/accessor SummarizedExperiment extended genotypes (assay, assays can still used) checks performed respect genotype format. metadata slot/accessor SummarizedExperiment completely free content must least contain information data genome version applied filters. phenotypes slot/accessor hosts phenotypic measurements sample parallel gsamples. pvalues, effects, prsbetas slots/accessors hosts statistical scores GWA tests (pvalues, effects) PRS extraction algorithms (prsbetas) SNP/feature parallel gfeatures. slots lists (SimpleList) many members number different models tested (e.g. different covariates, number PCs). way, whole GWASExperiment object replicated maintaining information many models. allPvalues, allEffects, allPrsbetas can used retrieve totality respective scores models associated GWASExperiment object. accessors purpose-related functions genome get/set genome version gfeatures, pcaCovariates get/set PCs calculated GWASExperiment object data, gsplit split object feature- sample-wise according variables present features samples others mentioned respective man page. Combining functions (cbind, rbind) also supported. following figure summarizes GWASExperiment object structure:","code":""},{"path":"/articles/03-gwasexperiment.html","id":"examples","dir":"Articles","previous_headings":"The GWASExperiment class","what":"Examples","title":"The GWASExperiment class","text":"following sections show examples usage GWASExperiment objects including creation function.","code":""},{"path":"/articles/03-gwasexperiment.html","id":"gwasexperiment-from-simulated-data","dir":"Articles","previous_headings":"The GWASExperiment class > Examples","what":"GWASExperiment from simulated data","title":"The GWASExperiment class","text":"create simulated data 100 SNPs, 10 samples 10 causative SNPs speed simplicity. also add pseudo-effects pseudo-pvalues two virtual GWA tests demonstrate slots object. genome unknown. create additional simulated dataset demonstrate joining splitting operations. important note merging datasets via cbind rbind following changes made respect final object: statistical GWA/PRS operations scores dropped. p-values, effects PRS betas longer meaning either tested SNPs number samples changes. case change sample number (cbind), principal components also dropped. drop rbind still might usage can recalculated. drop PCs also applies subsetting. metadata merged. importance, check outcome adjust accordingly. genome versions combining objects must identical.","code":"dat1 <- makeSimData(nsnp=100,nsam=10,nphe=3,csnp=10) ## coercing object of mode  numeric  to SnpMatrix  # Simple GWASExperiment object gwe1 <- GWASExperiment(     genotypes=dat1$snp,     features=dat1$feature,     samples=dat1$sample,     phenotypes=dat1$pheno )  # With pseudo-effects and pseudo-pvalues pspval <- matrix(runif(200),100,2) rownames(pspval) <- rownames(dat1$snp) colnames(pspval) <- c(\"test1\",\"test2\")  # Pseudo-effects and directions pseff <- matrix(runif(200,min=0,max=2),100,2) dire <- matrix(FALSE,100,2) dire[sample(nrow(dire),50),1] <- TRUE dire[sample(nrow(dire),50),2] <- TRUE pseff[dire[,1],1] <- -pseff[dire[,1],1] pseff[dire[,2],2] <- -pseff[dire[,2],2] rownames(pseff) <- rownames(dat1$snp) colnames(pseff) <- c(\"test1\",\"test2\")  # Assign effects and p-values to the object, assuming a model # with 'Trait_1' as response and 'Trait_2', 'Trait_3' as # covariates has been fit (no PCs) pvalues(gwe1,response=\"Trait_1\",     covariates=c(\"Trait_2\",\"Trait_3\")) <- pspval effects(gwe1,response=\"Trait_1\",     covariates=c(\"Trait_2\",\"Trait_3\")) <- pseff  gwe1 ## class: GWASExperiment  ## dim: 100 10  ## metadata(3): genome backend filters ## assays class: SnpMatrix with 100 rows (SNPs) and 10 columns (samples) ## assays(1): '' ## rownames(100): snp_1 snp_2 ... snp_99 snp_100 ## feature names(5): chromosome snp.name position allele.1 allele.2 ## colnames(10): sample_1 sample_2 ... sample_9 sample_10 ## sample names(6): pedigree member ... sex affected ## phenotype names(3): Trait_1 Trait_2 Trait_3 ## performed tests(2): test1 test2 ## associated PRS(0): # Add SNPs (rbind) dat2 <- makeSimData(nsnp=100,nsam=10,nphe=3,csnp=10) ## coercing object of mode  numeric  to SnpMatrix rownames(dat2$snp) <- rownames(dat2$feature) <-      paste(\"snp\",101:200,sep=\"_\") gwe2 <- GWASExperiment(     genotypes=dat2$snp,     features=dat2$feature,     samples=dat1$sample,     phenotypes=dat1$pheno ) # p-values and effects will be dropped with warning gwe12 <- suppressWarnings(rbind(gwe1,gwe2))  gwe12 ## class: GWASExperiment  ## dim: 200 10  ## metadata(5): genome backend genome backend filters ## assays class: SnpMatrix with 200 rows (SNPs) and 10 columns (samples) ## assays(1): '' ## rownames(200): snp_1 snp_2 ... snp_199 snp_200 ## feature names(5): chromosome snp.name position allele.1 allele.2 ## colnames(10): sample_1 sample_2 ... sample_9 sample_10 ## sample names(6): pedigree member ... sex affected ## phenotype names(3): Trait_1 Trait_2 Trait_3 ## performed tests(0): ## associated PRS(0):  # Add samples (cbind) dat3 <- makeSimData(nsnp=100,nsam=10,nphe=3,csnp=10) ## coercing object of mode  numeric  to SnpMatrix rownames(dat3$sample) <- rownames(dat3$pheno) <-      colnames(dat3$snp) <- paste(\"sample\",11:20,sep=\"_\") gwe3 <- GWASExperiment(     genotypes=dat3$snp,     features=dat1$feature,     samples=dat3$sample,     phenotypes=dat3$pheno ) # p-values and effects will be dropped with warning gwe13 <- suppressWarnings(cbind(gwe1,gwe3))  gwe13 ## class: GWASExperiment  ## dim: 100 20  ## metadata(5): genome backend genome backend filters ## assays class: SnpMatrix with 100 rows (SNPs) and 20 columns (samples) ## assays(1): '' ## rownames(100): snp_1 snp_2 ... snp_99 snp_100 ## feature names(5): chromosome snp.name position allele.1 allele.2 ## colnames(20): sample_1 sample_2 ... sample_19 sample_20 ## sample names(6): pedigree member ... sex affected ## phenotype names(3): Trait_1 Trait_2 Trait_3 ## performed tests(0): ## associated PRS(0):"},{"path":"/articles/03-gwasexperiment.html","id":"gwasexperiment-from-plink-files","dir":"Articles","previous_headings":"The GWASExperiment class > Examples","what":"GWASExperiment from PLINK files","title":"The GWASExperiment class","text":"use example files shipping snpStats package: Without phenotypes: phenotypes","code":"fam <- system.file(\"extdata/sample.fam\",package=\"snpStats\") bim <- system.file(\"extdata/sample.bim\",package=\"snpStats\") bed <- system.file(\"extdata/sample.bed\",package=\"snpStats\") input <- list(fam=fam,bim=bim,bed=bed) gwe <- importGWAS(input,backend=\"snpStats\") ## Reading PLINK files with snpStats framework ## Reading PLINK files with SNPRelate framework and storing output tp /tmp/RtmpNz2YkH/filed6823cbf419 ## Start file conversion from PLINK BED to SNP GDS ... ##     BED file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bed' ##         SNP-major mode (Sample X SNP), 603 bytes ##     FAM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.fam' ##     BIM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bim' ## Mon Jun  6 20:29:57 2022     (store sample id, snp id, position, and chromosome) ##     start writing: 120 samples, 20 SNPs ... ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:29:57 2022     Done. ## Optimize the access efficiency ... ## Clean up the fragments of GDS file: ##     open the file '/tmp/RtmpNz2YkH/filed6823cbf419' (5.1K) ##     # of fragments: 50 ##     save to '/tmp/RtmpNz2YkH/filed6823cbf419.tmp' ##     rename '/tmp/RtmpNz2YkH/filed6823cbf419.tmp' (4.8K, reduced: 312B) ##     # of fragments: 24  gwe ## class: GWASExperiment  ## dim: 20 120  ## metadata(5): genome backend filters gdsfile alleleOrder ## assays class: SnpMatrix with 20 rows (SNPs) and 120 columns (samples) ## assays(1): '' ## rownames(20): IGR1118a_1 IGR1119a_1 ... IGR2016a_1 IGR2020a_1 ## feature names(6): chromosome snp.name ... allele.1 allele.2 ## colnames(120): 430 412 ... 1991 17702 ## sample names(6): pedigree member ... sex affected ## phenotype names(0): ## performed tests(0): ## associated PRS(0): set.seed(42)  fam <- system.file(\"extdata/sample.fam\",package=\"snpStats\") bim <- system.file(\"extdata/sample.bim\",package=\"snpStats\") bed <- system.file(\"extdata/sample.bed\",package=\"snpStats\") input <- list(fam=fam,bim=bim,bed=bed) sample <- snpStats::read.plink(input$bed,input$bim,input$fam)  pseudopheno <- data.frame(     case_control=sample(c(0,1),nrow(sample$fam),replace=TRUE),     other_pheno=sample(c(\"drug\",\"nodrug\"),nrow(sample$fam),replace=TRUE),     cont=round(runif(nrow(sample$fam)),3),     row.names=rownames(sample$fam) ) gwe <- importGWAS(input,phenos=pseudopheno,backend=\"snpStats\") ## Reading PLINK files with snpStats framework ## Reading PLINK files with SNPRelate framework and storing output tp /tmp/RtmpNz2YkH/filed684e7dcc74 ## Start file conversion from PLINK BED to SNP GDS ... ##     BED file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bed' ##         SNP-major mode (Sample X SNP), 603 bytes ##     FAM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.fam' ##     BIM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bim' ## Mon Jun  6 20:29:58 2022     (store sample id, snp id, position, and chromosome) ##     start writing: 120 samples, 20 SNPs ... ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:29:58 2022     Done. ## Optimize the access efficiency ... ## Clean up the fragments of GDS file: ##     open the file '/tmp/RtmpNz2YkH/filed684e7dcc74' (5.1K) ##     # of fragments: 50 ##     save to '/tmp/RtmpNz2YkH/filed684e7dcc74.tmp' ##     rename '/tmp/RtmpNz2YkH/filed684e7dcc74.tmp' (4.8K, reduced: 312B) ##     # of fragments: 24  gwe ## class: GWASExperiment  ## dim: 20 120  ## metadata(5): genome backend filters gdsfile alleleOrder ## assays class: SnpMatrix with 20 rows (SNPs) and 120 columns (samples) ## assays(1): '' ## rownames(20): IGR1118a_1 IGR1119a_1 ... IGR2016a_1 IGR2020a_1 ## feature names(6): chromosome snp.name ... allele.1 allele.2 ## colnames(120): 430 412 ... 1991 17702 ## sample names(6): pedigree member ... sex affected ## phenotype names(3): case_control other_pheno cont ## performed tests(0): ## associated PRS(0):"},{"path":"/articles/03-gwasexperiment.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R session info","title":"The GWASExperiment class","text":"","code":"sessionInfo() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 18.04.6 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] prisma_0.0.2                SNPRelate_1.28.0            ##  [3] gdsfmt_1.30.0               snpStats_1.44.0             ##  [5] Matrix_1.4-1                survival_3.3-1              ##  [7] SummarizedExperiment_1.24.0 Biobase_2.54.0              ##  [9] GenomicRanges_1.46.1        GenomeInfoDb_1.30.1         ## [11] IRanges_2.28.0              S4Vectors_0.32.4            ## [13] BiocGenerics_0.40.0         MatrixGenerics_1.6.0        ## [15] matrixStats_0.62.0          lassosum_0.4.5              ##  ## loaded via a namespace (and not attached): ##   [1] utf8_1.2.2                               ##   [2] R.utils_2.11.0                           ##   [3] tidyselect_1.1.2                         ##   [4] gwascat_2.26.0                           ##   [5] RSQLite_2.2.14                           ##   [6] AnnotationDbi_1.56.2                     ##   [7] grid_4.1.3                               ##   [8] BiocParallel_1.28.3                      ##   [9] munsell_0.5.0                            ##  [10] codetools_0.2-18                         ##  [11] ragg_1.2.2                               ##  [12] future_1.25.0                            ##  [13] quincunx_0.1.4                           ##  [14] islasso_1.4.3                            ##  [15] colorspace_2.0-3                         ##  [16] filelock_1.0.2                           ##  [17] OrganismDbi_1.36.0                       ##  [18] highr_0.9                                ##  [19] knitr_1.39                               ##  [20] rstudioapi_0.13                          ##  [21] robustbase_0.95-0                        ##  [22] TTR_0.24.3                               ##  [23] listenv_0.8.0                            ##  [24] optparse_1.7.1                           ##  [25] GenomeInfoDbData_1.2.7                   ##  [26] bit64_4.0.5                              ##  [27] rprojroot_2.0.3                          ##  [28] parallelly_1.31.1                        ##  [29] vctrs_0.4.1                              ##  [30] generics_0.1.2                           ##  [31] xfun_0.31                                ##  [32] BiocFileCache_2.2.1                      ##  [33] R6_2.5.1                                 ##  [34] rmdformats_1.0.3                         ##  [35] bitops_1.0-7                             ##  [36] cachem_1.0.6                             ##  [37] DelayedArray_0.20.0                      ##  [38] assertthat_0.2.1                         ##  [39] gwasrapidd_0.99.12                       ##  [40] BiocIO_1.4.0                             ##  [41] Homo.sapiens_1.3.1                       ##  [42] scales_1.2.0                             ##  [43] gtable_0.3.0                             ##  [44] globals_0.15.0                           ##  [45] rlang_1.0.2                              ##  [46] systemfonts_1.0.4                        ##  [47] splines_4.1.3                            ##  [48] rtracklayer_1.54.0                       ##  [49] rsnps_0.5.0.0                            ##  [50] sitadela_1.3.1                           ##  [51] BiocManager_1.30.16                      ##  [52] yaml_2.3.5                               ##  [53] reshape2_1.4.4                           ##  [54] GenomicFeatures_1.46.5                   ##  [55] quantmod_0.4.20                          ##  [56] RBGL_1.70.0                              ##  [57] tools_4.1.3                              ##  [58] lava_1.6.10                              ##  [59] bookdown_0.26                            ##  [60] liftOver_1.18.0                          ##  [61] ggplot2_3.3.5                            ##  [62] ellipsis_0.3.2                           ##  [63] kableExtra_1.3.4                         ##  [64] jquerylib_0.1.4                          ##  [65] Rcpp_1.0.8.3                             ##  [66] rrBLUP_4.6.1                             ##  [67] plyr_1.8.7                               ##  [68] progress_1.2.2                           ##  [69] zlibbioc_1.40.0                          ##  [70] purrr_0.3.4                              ##  [71] RCurl_1.98-1.6                           ##  [72] prettyunits_1.1.1                        ##  [73] cowplot_1.1.1                            ##  [74] zoo_1.8-10                               ##  [75] fs_1.5.2                                 ##  [76] crul_1.2.0                               ##  [77] magrittr_2.0.3                           ##  [78] data.table_1.14.2                        ##  [79] openxlsx_4.2.5                           ##  [80] mvtnorm_1.1-3                            ##  [81] survcomp_1.44.1                          ##  [82] hms_1.1.1                                ##  [83] evaluate_0.15                            ##  [84] XML_3.99-0.9                             ##  [85] RMTstat_0.3.1                            ##  [86] shape_1.4.6                              ##  [87] compiler_4.1.3                           ##  [88] biomaRt_2.50.3                           ##  [89] tibble_3.1.7                             ##  [90] KernSmooth_2.23-20                       ##  [91] crayon_1.5.1                             ##  [92] R.oo_1.24.0                              ##  [93] htmltools_0.5.2                          ##  [94] pcaPP_2.0-1                              ##  [95] tzdb_0.3.0                               ##  [96] rrcov_1.7-0                              ##  [97] DBI_1.1.2                                ##  [98] SuppDists_1.1-9.7                        ##  [99] dbplyr_2.1.1                             ## [100] MASS_7.3-56                              ## [101] rappdirs_0.3.3                           ## [102] PhenotypeSimulator_0.3.4                 ## [103] getopt_1.20.3                            ## [104] readr_2.1.2                              ## [105] rmeta_3.0                                ## [106] cli_3.3.0                                ## [107] quadprog_1.5-8                           ## [108] R.methodsS3_1.8.1                        ## [109] parallel_4.1.3                           ## [110] pkgconfig_2.0.3                          ## [111] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ## [112] pkgdown_2.0.3.9000                       ## [113] GenomicAlignments_1.30.0                 ## [114] signal_0.7-7                             ## [115] xml2_1.3.3                               ## [116] foreach_1.5.2                            ## [117] svglite_2.1.0                            ## [118] bslib_0.3.1                              ## [119] webshot_0.5.3                            ## [120] XVector_0.34.0                           ## [121] prodlim_2019.11.13                       ## [122] rvest_1.0.2                              ## [123] stringr_1.4.0                            ## [124] VariantAnnotation_1.40.0                 ## [125] digest_0.6.29                            ## [126] graph_1.72.0                             ## [127] httpcode_0.3.0                           ## [128] Biostrings_2.62.0                        ## [129] rmarkdown_2.14                           ## [130] harmonicmeanp_3.0                        ## [131] restfulr_0.0.13                          ## [132] curl_4.3.2                               ## [133] Rsamtools_2.10.0                         ## [134] rjson_0.2.21                             ## [135] tseries_0.10-51                          ## [136] lifecycle_1.0.1                          ## [137] jsonlite_1.8.0                           ## [138] survivalROC_1.0.3                        ## [139] desc_1.4.1                               ## [140] viridisLite_0.4.0                        ## [141] BSgenome_1.62.0                          ## [142] fansi_1.0.3                              ## [143] pillar_1.7.0                             ## [144] lattice_0.20-45                          ## [145] DEoptimR_1.0-11                          ## [146] KEGGREST_1.34.0                          ## [147] fastmap_1.1.0                            ## [148] httr_1.4.3                               ## [149] GO.db_3.14.0                             ## [150] xts_0.12.1                               ## [151] glue_1.6.2                               ## [152] zip_2.2.0                                ## [153] SNPlocs.Hsapiens.dbSNP151.GRCh38_0.99.20 ## [154] png_0.1-7                                ## [155] iterators_1.0.14                         ## [156] pander_0.6.5                             ## [157] glmnet_4.1-4                             ## [158] bit_4.0.4                                ## [159] stringi_1.7.6                            ## [160] sass_0.4.1                               ## [161] bootstrap_2019.6                         ## [162] blob_1.2.3                               ## [163] statgenGWAS_1.0.8                        ## [164] textshaping_0.3.6                        ## [165] org.Hs.eg.db_3.14.0                      ## [166] memoise_2.0.1                            ## [167] FMStable_0.1-2                           ## [168] dplyr_1.0.8                              ## [169] future.apply_1.9.0"},{"path":"/articles/04-inoutfilter.html","id":"reading-plink-files-to-gwasexperiment-objects","dir":"Articles","previous_headings":"","what":"Reading PLINK files to GWASExperiment objects","title":"Reading, writing and filtering files and objects","text":"PRISMA provides facilities create GWASExperiment objects directly PLINK bed/bim/fam triplets (PED files time ) usage read.plink function package snpStats along functionalities attach phenotypes, metadata etc. example: can also attach data frame file (text-tab delimited) phenotypes: functions importGWAS include selection subset SNPs import (selection argument), whether reverse alleles (alleleOrder argument, useful times although generally left default) whether GDS file written (generally yes, especially intend perform filtering PCA). example, intend previous know SNPs locations mapped hg19 human genome version:","code":"library(prisma)  fam <- system.file(\"extdata/sample.fam\",package=\"snpStats\") bim <- system.file(\"extdata/sample.bim\",package=\"snpStats\") bed <- system.file(\"extdata/sample.bed\",package=\"snpStats\") input <- list(fam=fam,bim=bim,bed=bed)  gwe <- importGWAS(input,backend=\"snpStats\") ## Reading PLINK files with snpStats framework ## Reading PLINK files with SNPRelate framework and storing output tp /tmp/RtmpzV4pNV/filed9b2ad9e144 ## Start file conversion from PLINK BED to SNP GDS ... ##     BED file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bed' ##         SNP-major mode (Sample X SNP), 603 bytes ##     FAM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.fam' ##     BIM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bim' ## Mon Jun  6 20:30:37 2022     (store sample id, snp id, position, and chromosome) ##     start writing: 120 samples, 20 SNPs ... ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:30:37 2022     Done. ## Optimize the access efficiency ... ## Clean up the fragments of GDS file: ##     open the file '/tmp/RtmpzV4pNV/filed9b2ad9e144' (5.1K) ##     # of fragments: 50 ##     save to '/tmp/RtmpzV4pNV/filed9b2ad9e144.tmp' ##     rename '/tmp/RtmpzV4pNV/filed9b2ad9e144.tmp' (4.8K, reduced: 312B) ##     # of fragments: 24 gwe ## class: GWASExperiment  ## dim: 20 120  ## metadata(5): genome backend filters gdsfile alleleOrder ## assays class: SnpMatrix with 20 rows (SNPs) and 120 columns (samples) ## assays(1): '' ## rownames(20): IGR1118a_1 IGR1119a_1 ... IGR2016a_1 IGR2020a_1 ## feature names(6): chromosome snp.name ... allele.1 allele.2 ## colnames(120): 430 412 ... 1991 17702 ## sample names(6): pedigree member ... sex affected ## phenotype names(0): ## performed tests(0): ## associated PRS(0): set.seed(42)  fam <- system.file(\"extdata/sample.fam\",package=\"snpStats\") bim <- system.file(\"extdata/sample.bim\",package=\"snpStats\") bed <- system.file(\"extdata/sample.bed\",package=\"snpStats\") input <- list(fam=fam,bim=bim,bed=bed) sample <- snpStats::read.plink(input$bed,input$bim,input$fam)  pseudopheno <- data.frame(     case_control=sample(c(0,1),nrow(sample$fam),replace=TRUE),     other_pheno=sample(c(\"drug\",\"nodrug\"),nrow(sample$fam),replace=TRUE),     cont=round(runif(nrow(sample$fam)),3),     row.names=rownames(sample$fam) )  gwe <- importGWAS(input,phenos=pseudopheno,backend=\"snpStats\") ## Reading PLINK files with snpStats framework ## Reading PLINK files with SNPRelate framework and storing output tp /tmp/RtmpzV4pNV/filed9b65b4b461 ## Start file conversion from PLINK BED to SNP GDS ... ##     BED file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bed' ##         SNP-major mode (Sample X SNP), 603 bytes ##     FAM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.fam' ##     BIM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bim' ## Mon Jun  6 20:30:37 2022     (store sample id, snp id, position, and chromosome) ##     start writing: 120 samples, 20 SNPs ... ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:30:37 2022     Done. ## Optimize the access efficiency ... ## Clean up the fragments of GDS file: ##     open the file '/tmp/RtmpzV4pNV/filed9b65b4b461' (5.1K) ##     # of fragments: 50 ##     save to '/tmp/RtmpzV4pNV/filed9b65b4b461.tmp' ##     rename '/tmp/RtmpzV4pNV/filed9b65b4b461.tmp' (4.8K, reduced: 312B) ##     # of fragments: 24  gwe ## class: GWASExperiment  ## dim: 20 120  ## metadata(5): genome backend filters gdsfile alleleOrder ## assays class: SnpMatrix with 20 rows (SNPs) and 120 columns (samples) ## assays(1): '' ## rownames(20): IGR1118a_1 IGR1119a_1 ... IGR2016a_1 IGR2020a_1 ## feature names(6): chromosome snp.name ... allele.1 allele.2 ## colnames(120): 430 412 ... 1991 17702 ## sample names(6): pedigree member ... sex affected ## phenotype names(3): case_control other_pheno cont ## performed tests(0): ## associated PRS(0): library(prisma)  fam <- system.file(\"extdata/sample.fam\",package=\"snpStats\") bim <- system.file(\"extdata/sample.bim\",package=\"snpStats\") bed <- system.file(\"extdata/sample.bed\",package=\"snpStats\") input <- list(fam=fam,bim=bim,bed=bed)  gwe <- importGWAS(input,backend=\"snpStats\",writeGds=FALSE,genome=\"hg19\") gwe"},{"path":"/articles/04-inoutfilter.html","id":"exporting-gwasexperiment-objects-to-plink-files","dir":"Articles","previous_headings":"","what":"Exporting GWASExperiment objects to PLINK files","title":"Reading, writing and filtering files and objects","text":"PRISMA also provides facilities export GWASExperiment objects PLINK bed/bim/fam triplets (PED files time ) usage write.plink function package snpStats along functionalities attach phenotypes, metadata etc. potentially split output per chromosome. example, following write one temporary PLINK binary triplet toy data included package, \"BMI\" included phenotype registered phenotype PLINK FAM file: following write binary PLINK files triplet, without registering phenotype splitting per chromosome: writePlink function also offers SNP \"salvation\" mode (using salvage=TRUE argument). Sometimes, PLINK files may imported PRISMA processing calculations. may occur SNPs files missing location/position data, result exclusion output files. mode, writePlink connects Ensembl R package biomaRt tries identify chromosomal coordinates SNPs.","code":"data(toy,package=\"prisma\")  out <- tempfile() writePlink(toy,pheno=\"BMI\",outBase=out) ## Preflight... ## Writing FAM file to /tmp/RtmpzV4pNV/filed9b496ac263.fam  ## Writing extended MAP file to /tmp/RtmpzV4pNV/filed9b496ac263.bim  ## Writing BED file to /tmp/RtmpzV4pNV/filed9b496ac263.bed (SNP-major mode) ## NULL data(toy,package=\"prisma\")  out <- tempfile() writePlink(toy,outBase=out,perChr=TRUE) ## Preflight... ## ===== Writing files for chromosome 18 ## Writing FAM file to /tmp/RtmpzV4pNV/filed9b540ccda8_chr18.fam  ## Writing extended MAP file to /tmp/RtmpzV4pNV/filed9b540ccda8_chr18.bim  ## Writing BED file to /tmp/RtmpzV4pNV/filed9b540ccda8_chr18.bed (SNP-major mode) ## ===== Writing files for chromosome 21 ## Writing FAM file to /tmp/RtmpzV4pNV/filed9b540ccda8_chr21.fam  ## Writing extended MAP file to /tmp/RtmpzV4pNV/filed9b540ccda8_chr21.bim  ## Writing BED file to /tmp/RtmpzV4pNV/filed9b540ccda8_chr21.bed (SNP-major mode) ## NULL"},{"path":"/articles/04-inoutfilter.html","id":"other-io-and-coversion-tools","dir":"Articles","previous_headings":"","what":"Other I/O and coversion tools","title":"Reading, writing and filtering files and objects","text":"PRISMA implements additional file conversion output functions. Specifically:","code":""},{"path":"/articles/04-inoutfilter.html","id":"write-gds-files","dir":"Articles","previous_headings":"Other I/O and coversion tools","what":"Write GDS files","title":"Reading, writing and filtering files and objects","text":"writeGdsFile function can used writing GDS files GWASExperiment objects: GWASExperiment2GDS function operates similarly uses gdsfile accessor get object's GDS file throws error defined.","code":"data(toy,package=\"prisma\")  gdsf <- tempfile() writeGdsFile(toy,gdsfile=gdsf) ## Writing FAM file to /tmp/RtmpzV4pNV/filed9b29e9f5c8.fam  ## Writing extended MAP file to /tmp/RtmpzV4pNV/filed9b29e9f5c8.bim  ## Writing BED file to /tmp/RtmpzV4pNV/filed9b29e9f5c8.bed (SNP-major mode) ## Start file conversion from PLINK BED to SNP GDS ... ##     BED file: '/tmp/RtmpzV4pNV/filed9b29e9f5c8.bed' ##         SNP-major mode (Sample X SNP), 24.4K ##     FAM file: '/tmp/RtmpzV4pNV/filed9b29e9f5c8.fam' ##     BIM file: '/tmp/RtmpzV4pNV/filed9b29e9f5c8.bim' ## Mon Jun  6 20:30:43 2022     (store sample id, snp id, position, and chromosome) ##     start writing: 100 samples, 1000 SNPs ... ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:30:43 2022     Done. ## Optimize the access efficiency ... ## Clean up the fragments of GDS file: ##     open the file '/tmp/RtmpzV4pNV/filed9bb485453' (34.6K) ##     # of fragments: 50 ##     save to '/tmp/RtmpzV4pNV/filed9bb485453.tmp' ##     rename '/tmp/RtmpzV4pNV/filed9bb485453.tmp' (34.3K, reduced: 312B) ##     # of fragments: 24 ## [1] \"/tmp/RtmpzV4pNV/filed9bb485453\""},{"path":"/articles/04-inoutfilter.html","id":"converters-and-utilities","dir":"Articles","previous_headings":"Other I/O and coversion tools","what":"Converters and utilities","title":"Reading, writing and filtering files and objects","text":"GWASExperiment2gData() function converts GWASExperiment object gData class used functions package statgenGWAS, making sure phenotypes covariates follow rules gData class: GWASExperimentLiftOver converts SNP positions human genome versions hg19 hg38. SNPs fail map dropped notification: human genome version known priori, guessHumanGenomeVersion() can used \"guess\" human genome version querying 5 random SNPs using ncbi_snp_query() function package rsnps. Please note overall data/experiment/study depends SNP locations, human hg19 hg38 versions currently supported PRISMA.","code":"data(toy,package=\"prisma\")  gd <- GWASExperiment2gData(toy) # Warnings may be produced if some covariates do not follow the rules of the # gData class. data(toy,package=\"prisma\")  toy38 <- GWASExperimentLiftOver(toy,from=\"hg19\",to=\"hg38\") ## Lifting over features ##   lifting chr18 ##   lifting chr21"},{"path":"/articles/04-inoutfilter.html","id":"filtering-gwasexperiment-objects","dir":"Articles","previous_headings":"","what":"Filtering GWASExperiment objects","title":"Reading, writing and filtering files and objects","text":"PRISMA intended one-stop shop PRS extraction, also includes basic (--basic) functionalities treating genotype data prior GWA testing. functionalities include genotype filtering based sample SNP properties well missing data imputation (topic another vignette). Therefore, PRISMA support several filters follow best practices according related literature. specifically, PRISMA filters follow losely publication also tutorial preprocessing genotype data R. function implements filters PRISMA filterGWAS() filters performed provided list filter parameters filters argument. following sections describe supported filters.","code":"filts <- getDefaults(\"filters\")"},{"path":"/articles/04-inoutfilter.html","id":"snp-filters","dir":"Articles","previous_headings":"Filtering GWASExperiment objects","what":"SNP filters","title":"Reading, writing and filtering files and objects","text":"following SNP filters supported (percentages provided fractions, .e. value 0 1): SNP Call Rate: call rate given SNP defined proportion samples corresponding genotype missing. typical value 95%, meaning SNPs less 5% missing data retained. smaller datasets fewer samples. default value PRISMA 0.98 (snpCallRate=0.98). Minor Allele Frequency (MAF): often especially studies small samples, genotypes many markers exhibit large degree homogeneity (extreme example isolated population). results inadequate power infer statistically significant relationship SNP trait study. translates low MAFs large majority samples two copies major allele. typical strategy remove SNPs MAF < 1%. smaller datasets, loser cutoff may applied (5%). default value PRISMA 0.05 (maf=0.05). Hardy-Weinberg equilibrium (HWE): Hardy-Weinberg equilibrium principle stating genetic variation population remain constant one generation next absence disturbing factors. Violations HWE can indication presence population substructure occurrence genotyping error. common strategy assume genotyping error remove SNPs HWE violated. Violations HWE generally measured given SNP using \\(\\chi^{2}\\) goodness--fit test observed expected genotypes. SNPs presenting p-value < 10−6 typically removed. value even smaller smaller datasets. default value PRISMA 1 x 10−6 (hwe=1e-6). Linkage Disequilibrium (LD): Linkage disequilibrium nonrandom association alleles different loci. words (although single explanation) LD represents strong correlation close distant loci genotypes, leading strong collinear genptype effects disturbing downstream GWA testing. PRISMA, LD applied directly (suggested related litarature), component filters analyses PCA. default cutoff value 0.2 (LD=0.2). SNPs presenting pairwise relation larger values filtered.","code":"filts$snpCallRate ## [1] 0.98 filts$maf ## [1] 0.05 filts$hwe ## [1] 1e-06 filts$LD ## [1] 0.2"},{"path":"/articles/04-inoutfilter.html","id":"sample-filters","dir":"Articles","previous_headings":"Filtering GWASExperiment objects","what":"Sample filters","title":"Reading, writing and filtering files and objects","text":"following sample filters supported (percentages provided fractions, .e. value 0 1): Sample Call Rate: Similar SNP Call Rate, samples missing genotypes across pre-defined percentage typed SNPs excluded. proportion missingness across SNPs referred sample call rate. typical threshold 95%. , individuals missing genotype data 5% typed SNPs removed. default value PRISMA 0.95 (sampleCallRate=0.95). Based hard cutoff filter (heteroHard). Samples heterozygosity value excluded. default value NA (used). Based distribution heterozygosity. heterozygosity values samples used create distibution. , heteroStat (mean median) distribution calculated along respective measure scale (standard deviation IQR) multiplied factor heteroFac. samples heterozygosity larger heteroStat + heteroFac*scale excluded. default heteroStat PRISMA \"median\" default heteroFac 3. Inbreed coefficient: heterozygosity, Inbreed Coefficient can expose problems deficient heterozygosity across samples. Inbreeding coefficients defined terms probability identity state different pairs genes. probability identity state simply probability two genes identical allelic type. words, inbreed coefficient F : \\[|F| = 1 - \\frac{O}{E} \\] O observed E expected counts heterozygous SNPs within individual. expected counts sample calculated based observed SNPs sample. default cutoff PRISMA 0.1 (inbreed=0.1). Samples values filtered . Identity Descent (IBD): IBD refers case two individuals/samples inherited common DNA segment (icluding also several common SNPs) common ancestor without recombination, , segment ancestral origin individuals. IBD kinship coefficient greater 0.1 may suggest relatedness, duplicates, sample mixture. default value PRISMA 0.1 (IBD=0.1). Samples values greater excluded. Principal Component Analysis (PCA): PCA can used visualize classify samples ancestry groups based observed genetic makeup. genetic ancestry group simple case/control design. PCA can used identify outliers within groups (either sample mixe-wrong self-reporting even problematic genotyped samples). PCA PRISMA performed LD-contolled SNPs, suggested related literature used identifying uderlying genetic statification used later downstream GWA PRS extraction, well identifying samples exluded analysis. Furthermore, PRISMA can automatically identify samples (experimental!) application robust PCA techniques (R package rrcov) automatically identify outliers. However, approaches probably applied large enough datasets. PRISMA filters outliers based pcaOut filters parameter (pcaOut=TRUE) done performing robust PCA (pcaRobust parameter). pcaRobust can one \"hubert\" Hubert method \"grid\" Grid-Seqrch algorith. Please see documentation rrcov package. Please also note robust PCA, especially \"grid\" method can take lot time, probably best apply GWASExperiment object continue analysis new object.","code":"filts$sampleCallRate ## [1] 0.95 filts$heteroHard ## [1] NA filts$heteroStat ## [1] \"median\" filts$heteroFac ## [1] 3 filts$inbreed ## [1] 0.1 filts$IBD ## [1] 0.1 filts$pcaOut ## [1] FALSE filts$pcaRobust ## [1] \"hubert\""},{"path":"/articles/04-inoutfilter.html","id":"examples","dir":"Articles","previous_headings":"Filtering GWASExperiment objects","what":"Examples","title":"Reading, writing and filtering files and objects","text":"Perorm basic lose filtering small toy dataset: Check filtering status using filterRecord() accessor: Add robust PCA filters enable inbreed coefficient: Inspect outcome:","code":"data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",     \"extdata\",\"toy.gds\")  # Lose filters for the toy dataset filts <- getDefaults(\"filters\") filts$IBD <- NA filts$hwe <- 1e-3 filts$pcaOut <- FALSE filts$inbreed <- NA  toyF <- filterGWAS(toy,filters=filts,imputeMissing=FALSE) ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 119 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ## filterRecord(toyF) ##                     parameter                       name value   type filtered ## snpCallRate       snpCallRate              SNP call rate 0.980    SNP        0 ## maf                       maf     Minor Allele Frequency 0.050    SNP      119 ## hwe                       hwe Hardy-Weinberg equilibrium 0.001    SNP        2 ## sampleCallRate sampleCallRate           Sample call rate 0.980 Sample        0 ## heteroHard         heteroHard             Heterozygosity    NA Sample        0 ## inbreed               inbreed                    Inbreed    NA Sample        0 filts <- getDefaults(\"filters\") filts$IBD <- NA filts$hwe <- 1e-3 filts$pcaOut <- TRUE filts$pcaRobust <- \"hubert\"  toyF <- filterGWAS(toy,filters=filts,imputeMissing=FALSE) ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##     Inbreeding coefficient ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## Performing robust PCA for automatic outlier detection ##   with Hubert method ##  ## Reperforming LD and PCA analysis after outlier sample removal ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 120 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 86 ##     # of SNPs: 880 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 20.40%, 134/657 ## Chromosome 21: 18.66%, 64/343 ## 198 markers are selected in total. ## LD pruning finished! 198 SNPs will be used for PCA. ##  ## Performing PCA... ##   with Hubert method ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 119 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 10 ##   Robust PCA                : 4 ## filterRecord(toyF) ##                     parameter                       name  value   type filtered ## snpCallRate       snpCallRate              SNP call rate   0.98    SNP        0 ## maf                       maf     Minor Allele Frequency   0.05    SNP      119 ## hwe                       hwe Hardy-Weinberg equilibrium  0.001    SNP        2 ## sampleCallRate sampleCallRate           Sample call rate   0.98 Sample        0 ## heteroHard         heteroHard             Heterozygosity   <NA> Sample        0 ## inbreed               inbreed                    Inbreed    0.1 Sample       10 ## pcaOut                 pcaOut                 Robust PCA hubert Sample        4"},{"path":"/articles/04-inoutfilter.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R session info","title":"Reading, writing and filtering files and objects","text":"","code":"sessionInfo() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 18.04.6 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] prisma_0.0.2                SNPRelate_1.28.0            ##  [3] gdsfmt_1.30.0               snpStats_1.44.0             ##  [5] Matrix_1.4-1                survival_3.3-1              ##  [7] SummarizedExperiment_1.24.0 Biobase_2.54.0              ##  [9] GenomicRanges_1.46.1        GenomeInfoDb_1.30.1         ## [11] IRanges_2.28.0              S4Vectors_0.32.4            ## [13] BiocGenerics_0.40.0         MatrixGenerics_1.6.0        ## [15] matrixStats_0.62.0          lassosum_0.4.5              ##  ## loaded via a namespace (and not attached): ##   [1] utf8_1.2.2                               ##   [2] R.utils_2.11.0                           ##   [3] tidyselect_1.1.2                         ##   [4] gwascat_2.26.0                           ##   [5] RSQLite_2.2.14                           ##   [6] AnnotationDbi_1.56.2                     ##   [7] grid_4.1.3                               ##   [8] BiocParallel_1.28.3                      ##   [9] munsell_0.5.0                            ##  [10] codetools_0.2-18                         ##  [11] ragg_1.2.2                               ##  [12] future_1.25.0                            ##  [13] quincunx_0.1.4                           ##  [14] islasso_1.4.3                            ##  [15] colorspace_2.0-3                         ##  [16] filelock_1.0.2                           ##  [17] OrganismDbi_1.36.0                       ##  [18] knitr_1.39                               ##  [19] rstudioapi_0.13                          ##  [20] robustbase_0.95-0                        ##  [21] TTR_0.24.3                               ##  [22] listenv_0.8.0                            ##  [23] optparse_1.7.1                           ##  [24] GenomeInfoDbData_1.2.7                   ##  [25] bit64_4.0.5                              ##  [26] rprojroot_2.0.3                          ##  [27] parallelly_1.31.1                        ##  [28] vctrs_0.4.1                              ##  [29] generics_0.1.2                           ##  [30] xfun_0.31                                ##  [31] BiocFileCache_2.2.1                      ##  [32] R6_2.5.1                                 ##  [33] rmdformats_1.0.3                         ##  [34] bitops_1.0-7                             ##  [35] cachem_1.0.6                             ##  [36] DelayedArray_0.20.0                      ##  [37] assertthat_0.2.1                         ##  [38] gwasrapidd_0.99.12                       ##  [39] BiocIO_1.4.0                             ##  [40] Homo.sapiens_1.3.1                       ##  [41] scales_1.2.0                             ##  [42] gtable_0.3.0                             ##  [43] globals_0.15.0                           ##  [44] rlang_1.0.2                              ##  [45] systemfonts_1.0.4                        ##  [46] splines_4.1.3                            ##  [47] rtracklayer_1.54.0                       ##  [48] rsnps_0.5.0.0                            ##  [49] sitadela_1.3.1                           ##  [50] BiocManager_1.30.16                      ##  [51] yaml_2.3.5                               ##  [52] reshape2_1.4.4                           ##  [53] GenomicFeatures_1.46.5                   ##  [54] quantmod_0.4.20                          ##  [55] RBGL_1.70.0                              ##  [56] tools_4.1.3                              ##  [57] lava_1.6.10                              ##  [58] bookdown_0.26                            ##  [59] liftOver_1.18.0                          ##  [60] ggplot2_3.3.5                            ##  [61] ellipsis_0.3.2                           ##  [62] kableExtra_1.3.4                         ##  [63] jquerylib_0.1.4                          ##  [64] Rcpp_1.0.8.3                             ##  [65] rrBLUP_4.6.1                             ##  [66] plyr_1.8.7                               ##  [67] progress_1.2.2                           ##  [68] zlibbioc_1.40.0                          ##  [69] purrr_0.3.4                              ##  [70] RCurl_1.98-1.6                           ##  [71] prettyunits_1.1.1                        ##  [72] cowplot_1.1.1                            ##  [73] zoo_1.8-10                               ##  [74] fs_1.5.2                                 ##  [75] crul_1.2.0                               ##  [76] magrittr_2.0.3                           ##  [77] data.table_1.14.2                        ##  [78] openxlsx_4.2.5                           ##  [79] mvtnorm_1.1-3                            ##  [80] survcomp_1.44.1                          ##  [81] hms_1.1.1                                ##  [82] evaluate_0.15                            ##  [83] XML_3.99-0.9                             ##  [84] RMTstat_0.3.1                            ##  [85] shape_1.4.6                              ##  [86] compiler_4.1.3                           ##  [87] biomaRt_2.50.3                           ##  [88] tibble_3.1.7                             ##  [89] KernSmooth_2.23-20                       ##  [90] crayon_1.5.1                             ##  [91] R.oo_1.24.0                              ##  [92] htmltools_0.5.2                          ##  [93] pcaPP_2.0-1                              ##  [94] tzdb_0.3.0                               ##  [95] rrcov_1.7-0                              ##  [96] DBI_1.1.2                                ##  [97] SuppDists_1.1-9.7                        ##  [98] dbplyr_2.1.1                             ##  [99] MASS_7.3-56                              ## [100] rappdirs_0.3.3                           ## [101] PhenotypeSimulator_0.3.4                 ## [102] getopt_1.20.3                            ## [103] readr_2.1.2                              ## [104] rmeta_3.0                                ## [105] cli_3.3.0                                ## [106] quadprog_1.5-8                           ## [107] R.methodsS3_1.8.1                        ## [108] parallel_4.1.3                           ## [109] pkgconfig_2.0.3                          ## [110] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ## [111] pkgdown_2.0.3.9000                       ## [112] GenomicAlignments_1.30.0                 ## [113] signal_0.7-7                             ## [114] xml2_1.3.3                               ## [115] foreach_1.5.2                            ## [116] svglite_2.1.0                            ## [117] bslib_0.3.1                              ## [118] webshot_0.5.3                            ## [119] XVector_0.34.0                           ## [120] prodlim_2019.11.13                       ## [121] rvest_1.0.2                              ## [122] stringr_1.4.0                            ## [123] VariantAnnotation_1.40.0                 ## [124] digest_0.6.29                            ## [125] graph_1.72.0                             ## [126] httpcode_0.3.0                           ## [127] Biostrings_2.62.0                        ## [128] rmarkdown_2.14                           ## [129] harmonicmeanp_3.0                        ## [130] restfulr_0.0.13                          ## [131] curl_4.3.2                               ## [132] Rsamtools_2.10.0                         ## [133] rjson_0.2.21                             ## [134] tseries_0.10-51                          ## [135] lifecycle_1.0.1                          ## [136] jsonlite_1.8.0                           ## [137] survivalROC_1.0.3                        ## [138] desc_1.4.1                               ## [139] viridisLite_0.4.0                        ## [140] BSgenome_1.62.0                          ## [141] fansi_1.0.3                              ## [142] pillar_1.7.0                             ## [143] lattice_0.20-45                          ## [144] DEoptimR_1.0-11                          ## [145] KEGGREST_1.34.0                          ## [146] fastmap_1.1.0                            ## [147] httr_1.4.3                               ## [148] GO.db_3.14.0                             ## [149] xts_0.12.1                               ## [150] glue_1.6.2                               ## [151] zip_2.2.0                                ## [152] SNPlocs.Hsapiens.dbSNP151.GRCh38_0.99.20 ## [153] png_0.1-7                                ## [154] iterators_1.0.14                         ## [155] pander_0.6.5                             ## [156] glmnet_4.1-4                             ## [157] bit_4.0.4                                ## [158] stringi_1.7.6                            ## [159] sass_0.4.1                               ## [160] bootstrap_2019.6                         ## [161] blob_1.2.3                               ## [162] statgenGWAS_1.0.8                        ## [163] textshaping_0.3.6                        ## [164] org.Hs.eg.db_3.14.0                      ## [165] memoise_2.0.1                            ## [166] FMStable_0.1-2                           ## [167] dplyr_1.0.8                              ## [168] future.apply_1.9.0"},{"path":"/articles/05-imputemerge.html","id":"snp-imputation-in-prisma","dir":"Articles","previous_headings":"","what":"SNP imputation in PRISMA","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"PRISMA offers functions perform SNP genotype imputation two levels. first level imputation missing genotypes, completeness dataset many GWA tests operate missing values. different SNP imputation based large reference panel population study (e.g. 1000 genomes project). refer imputation level internal imputation. second level imputation based external reference panel (mentioned ). case, genotypes imputed (case missing data) extended infer SNPs variants present initial dataset, based content initial dataset sophisticated regression algorothims use reference panel actual dataset content enrich initial dataset inferred SNPs usually good accuracy. refer level imputation external imputation extension. achieve two types imputation PRISMA utilizes: internal imputation, implements sequential imputation procedure based snp.impute function package snpStats, followed genotype imputation package scrime SNPs fail imputed. external imputation, wraps IMPUTE2 algorithm extends gfeatures slot initial GWASExperiment object INFO score returned IMPUTE2 can used assess quality extended genotypes filter accordingly.","code":""},{"path":"/articles/05-imputemerge.html","id":"internal-imputation","dir":"Articles","previous_headings":"SNP imputation in PRISMA","what":"Internal imputation","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"mentioned, internal imputation PRISMA performed implementing sequential imputation process using functions snpStats package. Therefore, imputation can performed two possible ways: Imputing imputation rules based total dataset without missing values (mode=\"single\"). Rules created based SNPs dataset even missing values (snpStats takes care ). Imputing spliting dataset part non-missing genotypes used create imputation rules (mode=\"split\"), applied dataset part missing values. Even though case (ii) may accurate, often non-applicable smaller datasets unlikely find samples missing values . Case (ii) also applied external reference panel add SNPs genotyped initial dataset (another external imputation process) implemented within PRISMA point. functionalities wrapped imputeGWAS() function operates GWASExperiment object. , using toy dataset included PRISMA artificially add missing values demostrate case () (mode=\"single\"): imputation process can parallelized rc argument passed imputeGWAS() function. fail argument controls genotypes failed imputed snpStats imputation rules. either remain missing (fail=\"none\") imputed k-Nearest Neighbor algorithm implemented package scrime (fail=\"scrime\"). noted form imputation must performed prior GWA tests PRS analysis many algorithms handle missing genotypes. Also, internal imputation part filtering process procude objects ready GWA testing. can turned setting imputeMissing=FALSE filterGWAS() function. case playing filters bring data acceptable form later analysis.","code":"data(toy,package=\"prisma\")  # Make some genotypes missing set.seed(42) toMiss <- lapply(seq_len(ncol(toy)),function(j) {     n <- sample(20,1)     miss <- logical(nrow(toy))     miss[sample(nrow(toy),n)] <- TRUE     return(miss) })  G <- as(genotypes(toy),\"numeric\") + 1 mode(G) <- \"integer\" for (j in seq_len(ncol(toy)))     G[toMiss[[j]],j] <- 0L G <- SnpMatrix(G) ## coercing object of mode  numeric  to SnpMatrix genotypes(toy) <- G  toyI <- imputeGWAS(toy,fail=\"none\") ##  ## Imputing missing values with snpStats rules ##  ## Starting imputation analysis in 2 chunks ##  ## ========== Imputing chromosome/part 18 ## -----> Imputation iteration 1 ## Creating imputation rules ## SNPs tagged by a single SNP: 45 ## SNPs tagged by multiple tag haplotypes (saturated model): 537 ## 97 samples have missing genotypes in 433 SNPs in total. ## Imputing... ## Applying imputations... ## -----> Imputation iteration 2 ## Creating imputation rules ## SNPs tagged by a single SNP: 44 ## SNPs tagged by multiple tag haplotypes (saturated model): 538 ## 52 samples have missing genotypes in 47 SNPs in total. ## Imputing... ## Applying imputations... ##  ## ========== Imputing chromosome/part 21 ## -----> Imputation iteration 1 ## Creating imputation rules ## SNPs tagged by a single SNP: 20 ## SNPs tagged by multiple tag haplotypes (saturated model): 301 ## 92 samples have missing genotypes in 221 SNPs in total. ## Imputing... ## Applying imputations... ## -----> Imputation iteration 2 ## Creating imputation rules ## SNPs tagged by a single SNP: 20 ## SNPs tagged by multiple tag haplotypes (saturated model): 301 ## 27 samples have missing genotypes in 17 SNPs in total. ## Imputing... ## Applying imputations... ##  ## Imputation finished, re-merging the output before <- length(which(is.na(genotypes(toy)))) after <- length(which(is.na(genotypes(toyI)))) before > after # TRUE ## [1] TRUE"},{"path":"/articles/05-imputemerge.html","id":"external-imputation","dir":"Articles","previous_headings":"SNP imputation in PRISMA","what":"External imputation","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"mentioned, external imputation PRISMA refers extension dataset (e.g. SNP microarray) content SNPs variants exist , based external larger reference population panel variants listed within 1000 Genomes Project. process called imputation related literature within PRISMA order distinguish missing genotype imputation, refer extension external imputation. perform external imputation PRISMA needs: IMPUTE2 software IMPUTE2 reference panel files GTOOL QCTOOL tools file conversion operations. IMPUTE2 default imputes SNPs shorter intervals chromosomes. Briefly, extendGWAS() function: Converts exports input GWASExperiment object files IMPUTE2 can understand Creates imputation intervals chromosomes present initial object Paralelly (possible) executes IMPUTE2 imputation intervals Merges produced files per chromosome converts PLINK format can read back GWASExperiment Creates merged extended GWASExperiment object imputed SNPs adds imputation INFO score (imputation accuracy) gfeatures object Cleans following perform imputation writing intermediate files temporaray folder without removing intermediate files: following perform imputation writing intermediate files . user specified folder, using QCTOOL conversion tool leaving intermediate files back: following perform imputation intervals 10Mbp (default 1Mbp): two conversion tools, GTOOL QCTOOL supported GTOOL may compatible later Linux versions (e.g. > Ubuntu 18.04). Generally, process may require many hours complete (especially complete datasets) better put command script run command background Rscript. following figure summarizes imputation modes PRISMA:","code":"data(toy,package=\"prisma\")  refSpace <- \"PATH/TO/IMPUTE2/REFERENCE/PANEL\" toyEx <- extendGWAS(toy,refSpace=refSpace) data(toy,package=\"prisma\")  refSpace <- \"PATH/TO/IMPUTE2/REFERENCE/PANEL\" wspace <- \"PATH/TO/WORKSPACE\"  toyEx <- extendGWAS(toy,wspace=wspace,refSpace=refSpace,convTool=\"qctool\",     cleanup=\"intemediate\") data(toy,package=\"prisma\")  refSpace <- \"PATH/TO/IMPUTE2/REFERENCE/PANEL\" toyEx <- extendGWAS(toy,intSize=1e+7,refSpace=refSpace)"},{"path":"/articles/05-imputemerge.html","id":"dataset-merging","dir":"Articles","previous_headings":"","what":"Dataset merging","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"PRISMA, possible merge two genotype datasets, example datasets derived different array platforms different versions platform different arrays provider. Merging straigh-forward process several factors - apart obvious non-common SNPs - reversed alleles, multiallelic SNPs sufficient representation mixes major minor alleles different datasets. Although software dedicated merging harmonization different datasets (example Genotype Harmonizer), PRISMA facilitates also process offering simple GWASExperiment merging function users use multiple packages complex /O operations. merging process explained .","code":""},{"path":"/articles/05-imputemerge.html","id":"prerequisites","dir":"Articles","previous_headings":"Dataset merging","what":"Prerequisites","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"Generally, prerequisites assumed prior merging: human genome versions two object merged must . Use guessHumanGenomeVersion() GWASExperimentLiftOver() functions check fix issues possible. SNP ids dataset must common reference format. Ideally, ids converted dbSNP ids prior processing, way merging process can use online resources resolve issues. ids also possible like Illumina GSA ids, online resolving resources used. SNP locations must available.","code":""},{"path":"/articles/05-imputemerge.html","id":"merging-process","dir":"Articles","previous_headings":"Dataset merging","what":"Merging process","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"process also described man page mergeGWAS() function. following figure summarizes imputation modes PRISMA:","code":""},{"path":"/articles/05-imputemerge.html","id":"common-snps","dir":"Articles","previous_headings":"Dataset merging > Merging process","what":"Common SNPs","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"two datasets compatible terms genome version coordinates, common SNPs identified two datasets. must point information (location, minor major alleles, strand), process checks attributes tries resolve discrepancies. first check whether non identical SNPs terms alleles can solved strand-fliping. resolved strand-fliping may point risk allele. resolved either using one dataset reference (mafResolve=1 mafResolve=2) even better, querying online resources (e.g. Ensembl dbSNP) identify true minor major alleles based summarized frequencies population studies (internet connection ). SNPs whose alleles resolved means (strand-flip, online MAF resolve) completely dropped. common SNPs two objects continue identical, probably means location/position mismatches potentially derived older annotations. can resolved online. remaining non-resolvable SNPs, dropped. , genotypes common SNPs merged. genotypes alleles flipped also switched. Finally, common annotation elements genotypes combined. output=\"common\" process stops. output=\"\", unique elements dataset also combined common. genotypes SNPs unique dataset set missing. respect online allele resolving common SNPs resolved strand-flipping: SNPs queried Ensembl biomaRt resolve allele frequencies. Genome version importantat point alleles used together SNP IDs. minor allele available Ensembl, flip decision based . (e.g. outdated/merged SNPs, dbSNP queried package rsnps completes Ensembl result. SNPs may removed dbSNP. Nothing can done . Flipping based majority rest. found SNPs may information MAF minor alleles. dbSNP requeried rsnps filling missing info retried. , resolved flipped according majority. Common SNPs fail resolved aforementioned ways dropped merged dataset.","code":""},{"path":"/articles/05-imputemerge.html","id":"non-common-snps","dir":"Articles","previous_headings":"Dataset merging > Merging process","what":"Non-common SNPs","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"non common SNPs process easier nothing resolve. Non-common samples, SNPs genotypes appended common ones form final dataset. genotypes SNP unique first dataset set missing samples second dataset vice-versa SNPs unique second dataset. normal process produces many missing values. Internal imputation can used salvage samples SNPs filtering. also option output common SNPs avoid extreme numbers missing values final dataset. decided user based nature datasets merged.","code":""},{"path":"/articles/05-imputemerge.html","id":"example","dir":"Articles","previous_headings":"Dataset merging > Merging process","what":"Example","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"simple example presented toy dataset, split two. However, realistic practice, two datasets merged end potential loses.","code":"data(toy,package=\"prisma\")      toy1 <- toy[1:800,1:50] toy2 <- toy[201:1000,51:100]  toym <- mergeGWAS(toy1,toy2) dim(toym) # 600 100  toym <- mergeGWAS(toy1,toy2,output=\"all\") dim(toym) # 1000 100"},{"path":"/articles/05-imputemerge.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R session info","title":"Imputation of missing genotypes, genotype extension and dataset merging","text":"","code":"sessionInfo() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 18.04.6 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] prisma_0.0.2                SNPRelate_1.28.0            ##  [3] gdsfmt_1.30.0               snpStats_1.44.0             ##  [5] Matrix_1.4-1                survival_3.3-1              ##  [7] SummarizedExperiment_1.24.0 Biobase_2.54.0              ##  [9] GenomicRanges_1.46.1        GenomeInfoDb_1.30.1         ## [11] IRanges_2.28.0              S4Vectors_0.32.4            ## [13] BiocGenerics_0.40.0         MatrixGenerics_1.6.0        ## [15] matrixStats_0.62.0          lassosum_0.4.5              ##  ## loaded via a namespace (and not attached): ##   [1] utf8_1.2.2                               ##   [2] R.utils_2.11.0                           ##   [3] tidyselect_1.1.2                         ##   [4] gwascat_2.26.0                           ##   [5] RSQLite_2.2.14                           ##   [6] AnnotationDbi_1.56.2                     ##   [7] grid_4.1.3                               ##   [8] BiocParallel_1.28.3                      ##   [9] munsell_0.5.0                            ##  [10] codetools_0.2-18                         ##  [11] ragg_1.2.2                               ##  [12] future_1.25.0                            ##  [13] quincunx_0.1.4                           ##  [14] islasso_1.4.3                            ##  [15] colorspace_2.0-3                         ##  [16] filelock_1.0.2                           ##  [17] OrganismDbi_1.36.0                       ##  [18] highr_0.9                                ##  [19] knitr_1.39                               ##  [20] rstudioapi_0.13                          ##  [21] robustbase_0.95-0                        ##  [22] TTR_0.24.3                               ##  [23] listenv_0.8.0                            ##  [24] optparse_1.7.1                           ##  [25] GenomeInfoDbData_1.2.7                   ##  [26] bit64_4.0.5                              ##  [27] rprojroot_2.0.3                          ##  [28] parallelly_1.31.1                        ##  [29] vctrs_0.4.1                              ##  [30] generics_0.1.2                           ##  [31] xfun_0.31                                ##  [32] BiocFileCache_2.2.1                      ##  [33] R6_2.5.1                                 ##  [34] rmdformats_1.0.3                         ##  [35] bitops_1.0-7                             ##  [36] cachem_1.0.6                             ##  [37] DelayedArray_0.20.0                      ##  [38] assertthat_0.2.1                         ##  [39] gwasrapidd_0.99.12                       ##  [40] BiocIO_1.4.0                             ##  [41] Homo.sapiens_1.3.1                       ##  [42] scales_1.2.0                             ##  [43] gtable_0.3.0                             ##  [44] globals_0.15.0                           ##  [45] rlang_1.0.2                              ##  [46] systemfonts_1.0.4                        ##  [47] splines_4.1.3                            ##  [48] rtracklayer_1.54.0                       ##  [49] rsnps_0.5.0.0                            ##  [50] sitadela_1.3.1                           ##  [51] BiocManager_1.30.16                      ##  [52] yaml_2.3.5                               ##  [53] reshape2_1.4.4                           ##  [54] GenomicFeatures_1.46.5                   ##  [55] quantmod_0.4.20                          ##  [56] RBGL_1.70.0                              ##  [57] tools_4.1.3                              ##  [58] lava_1.6.10                              ##  [59] bookdown_0.26                            ##  [60] liftOver_1.18.0                          ##  [61] ggplot2_3.3.5                            ##  [62] ellipsis_0.3.2                           ##  [63] kableExtra_1.3.4                         ##  [64] jquerylib_0.1.4                          ##  [65] Rcpp_1.0.8.3                             ##  [66] rrBLUP_4.6.1                             ##  [67] plyr_1.8.7                               ##  [68] progress_1.2.2                           ##  [69] zlibbioc_1.40.0                          ##  [70] purrr_0.3.4                              ##  [71] RCurl_1.98-1.6                           ##  [72] prettyunits_1.1.1                        ##  [73] cowplot_1.1.1                            ##  [74] zoo_1.8-10                               ##  [75] fs_1.5.2                                 ##  [76] crul_1.2.0                               ##  [77] magrittr_2.0.3                           ##  [78] data.table_1.14.2                        ##  [79] openxlsx_4.2.5                           ##  [80] mvtnorm_1.1-3                            ##  [81] survcomp_1.44.1                          ##  [82] hms_1.1.1                                ##  [83] evaluate_0.15                            ##  [84] XML_3.99-0.9                             ##  [85] RMTstat_0.3.1                            ##  [86] shape_1.4.6                              ##  [87] compiler_4.1.3                           ##  [88] biomaRt_2.50.3                           ##  [89] tibble_3.1.7                             ##  [90] KernSmooth_2.23-20                       ##  [91] crayon_1.5.1                             ##  [92] R.oo_1.24.0                              ##  [93] htmltools_0.5.2                          ##  [94] pcaPP_2.0-1                              ##  [95] tzdb_0.3.0                               ##  [96] rrcov_1.7-0                              ##  [97] DBI_1.1.2                                ##  [98] SuppDists_1.1-9.7                        ##  [99] dbplyr_2.1.1                             ## [100] MASS_7.3-56                              ## [101] rappdirs_0.3.3                           ## [102] PhenotypeSimulator_0.3.4                 ## [103] getopt_1.20.3                            ## [104] readr_2.1.2                              ## [105] rmeta_3.0                                ## [106] cli_3.3.0                                ## [107] quadprog_1.5-8                           ## [108] R.methodsS3_1.8.1                        ## [109] parallel_4.1.3                           ## [110] pkgconfig_2.0.3                          ## [111] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ## [112] pkgdown_2.0.3.9000                       ## [113] GenomicAlignments_1.30.0                 ## [114] signal_0.7-7                             ## [115] xml2_1.3.3                               ## [116] foreach_1.5.2                            ## [117] svglite_2.1.0                            ## [118] bslib_0.3.1                              ## [119] webshot_0.5.3                            ## [120] XVector_0.34.0                           ## [121] prodlim_2019.11.13                       ## [122] rvest_1.0.2                              ## [123] stringr_1.4.0                            ## [124] VariantAnnotation_1.40.0                 ## [125] digest_0.6.29                            ## [126] graph_1.72.0                             ## [127] httpcode_0.3.0                           ## [128] Biostrings_2.62.0                        ## [129] rmarkdown_2.14                           ## [130] harmonicmeanp_3.0                        ## [131] restfulr_0.0.13                          ## [132] curl_4.3.2                               ## [133] Rsamtools_2.10.0                         ## [134] rjson_0.2.21                             ## [135] tseries_0.10-51                          ## [136] lifecycle_1.0.1                          ## [137] jsonlite_1.8.0                           ## [138] survivalROC_1.0.3                        ## [139] desc_1.4.1                               ## [140] viridisLite_0.4.0                        ## [141] BSgenome_1.62.0                          ## [142] fansi_1.0.3                              ## [143] pillar_1.7.0                             ## [144] lattice_0.20-45                          ## [145] DEoptimR_1.0-11                          ## [146] KEGGREST_1.34.0                          ## [147] fastmap_1.1.0                            ## [148] httr_1.4.3                               ## [149] GO.db_3.14.0                             ## [150] xts_0.12.1                               ## [151] glue_1.6.2                               ## [152] zip_2.2.0                                ## [153] SNPlocs.Hsapiens.dbSNP151.GRCh38_0.99.20 ## [154] png_0.1-7                                ## [155] iterators_1.0.14                         ## [156] pander_0.6.5                             ## [157] glmnet_4.1-4                             ## [158] bit_4.0.4                                ## [159] stringi_1.7.6                            ## [160] sass_0.4.1                               ## [161] bootstrap_2019.6                         ## [162] blob_1.2.3                               ## [163] statgenGWAS_1.0.8                        ## [164] textshaping_0.3.6                        ## [165] org.Hs.eg.db_3.14.0                      ## [166] memoise_2.0.1                            ## [167] FMStable_0.1-2                           ## [168] dplyr_1.0.8                              ## [169] future.apply_1.9.0"},{"path":"/articles/06-gwasfuns.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Single trait association tests and summary statistics","text":"one-stop shop solution derivation stable PRSs, PRISMA offers several methods derive GWAS summary statistics. summary statistics used feed PRS extraction process evaluated reported end. user able select best PRS PRS combines relevant SNP content, reasonable number SNPs best evaluation metrics. p-values multiple tests can also combined using one available p-value combination methods. See also gwa() man page details p-value combination. PRISMA supports five methods estimating SNP effects single-trait associations. specifically: General Linear Models (GLM): SNP regressed phenotype selected covariates. additive SNP effect model assumed. Ridge regression R package rrBLUP. package deploys penalized regression shrinking effects less informative SNPs relation phenotype. Single-trait association tests statgenGWAS R package. association based linear regression incorporation internally calculated kinship matrix. Frequentist association tests SNPTEST (Oxford). SNP regressed phenotype selected covariates using additive model (SNPTEST options also supported). Association tests PLINK (linear regression covariates simple X2 association tests covariates present). SNP effects (regression coefficients /Odd Ratios) p-values reported end registered related slots input GWASExperiment object. GWASExperiment object can hold multiple results genotypic/phenotypic data living object, long models, .e. model 2 PCs covariates different model PC covariates. examples use toy dataset included PRISMA. reason perform additional prior filtering although typical situation, genotypes filtered prior GWA testing. main function GWA testing gwa() function attaches results GWASExperiment object. GWA function (e.g. gwaGlm) can used independently returns matrix summary statistics. following sections illustrate usage.","code":""},{"path":"/articles/06-gwasfuns.html","id":"summary-statistics-with-glm","dir":"Articles","previous_headings":"Introduction","what":"Summary statistics with GLM","title":"Single trait association tests and summary statistics","text":"test SNP toy dataset association main phenotype (BMI) given age, sex case/control status, along 1 PC. , run GLM independently just get summary statistics without attaching toy object. contents glmSumstat matrix: Now attach results toy object without PCs Change phenotype Case_Control. Now, GLM run binomial regression mode Case_Control phenotype binary. Now, use listGwa() function see test results attached toy object: following examples illustrate GWA methods, run smaller number command except section running one algorithm illustrated.","code":"data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Only 1 PC will be returned because of dataset size toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 962 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 23.44%, 154/657 ## Chromosome 21: 21.28%, 73/343 ## 227 markers are selected in total. ## LD pruning finished! 227 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 773 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 227 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 10268 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:32:06 2022    (internal increment: 13024) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:32:06 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:32:06 2022    Done. ## Selecting number of PCs to include ##   with Tracy-Widom test for significant eigenvalues ##     selected 1 PCs  glmSumstat <- gwaGlm(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),pcs=TRUE) ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs1009238 to rs2828316 ## Found 42 associations (uncorrected p-values). head(glmSumstat) ##             Estimate Std. Error    t value   Pr(>|t|) ## rs1009238 -0.6695782  0.6649037 -1.0070303 0.31647832 ## rs1940646  0.4810455  0.6722091  0.7156188 0.47598195 ## rs1940651 -1.4435680  0.6911187 -2.0887412 0.03940511 ## rs1940658 -0.9054984  0.6533306 -1.3859727 0.16900001 ## rs1940670  0.8641098  0.6855611  1.2604417 0.21059720 ## rs1954825  0.1746603  0.6480141  0.2695316 0.78810519 # With 1 PC toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),     pcs=TRUE,psig=0.05,methods=c(\"glm\")) ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs1009238 to rs1568327 ## Found 24 associations (uncorrected p-values). ##  ## Overall, found 24 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs2824974 to rs2828316 ## Found 18 associations (uncorrected p-values). ##  ## Overall, found 18 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 24 associations found out of 657 markers ##   Part 21: 18 associations found out of 343 markers ##  ## Overall, found 42 associations with (uncorrected) combined p-values).      # With no PCs toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),     pcs=FALSE,psig=0.05,methods=c(\"glm\")) ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 25 associations (uncorrected p-values). ##  ## Overall, found 25 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 16 associations (uncorrected p-values). ##  ## Overall, found 16 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 25 associations found out of 657 markers ##   Part 21: 16 associations found out of 343 markers ##  ## Overall, found 41 associations with (uncorrected) combined p-values).      # With 1 PCs and one more covariate toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\"),     pcs=FALSE,psig=0.05,methods=c(\"glm\")) ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 54 associations (uncorrected p-values). ##  ## Overall, found 54 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 20 associations (uncorrected p-values). ##  ## Overall, found 20 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 54 associations found out of 657 markers ##   Part 21: 20 associations found out of 343 markers ##  ## Overall, found 74 associations with (uncorrected) combined p-values). # With 1 PC toy <- gwa(toy,response=\"Case_Control\",covariates=c(\"Age\",\"Gender\",\"BMI\"),     pcs=TRUE,psig=0.05,methods=c(\"glm\")) ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Regression  : binomial (predicted) ## Use PCs     : Yes ##   testing SNPs from rs1009238 to rs1568327 ## Found 35 associations (uncorrected p-values). ##  ## Overall, found 35 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Regression  : binomial (predicted) ## Use PCs     : Yes ##   testing SNPs from rs2824974 to rs2828316 ## Found 19 associations (uncorrected p-values). ##  ## Overall, found 19 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 35 associations found out of 657 markers ##   Part 21: 19 associations found out of 343 markers ##  ## Overall, found 54 associations with (uncorrected) combined p-values).      # With no PCs toy <- gwa(toy,response=\"Case_Control\",covariates=c(\"Age\",\"Gender\",\"BMI\"),     pcs=FALSE,psig=0.05,methods=c(\"glm\")) ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Regression  : binomial (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 60 associations (uncorrected p-values). ##  ## Overall, found 60 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Regression  : binomial (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 28 associations (uncorrected p-values). ##  ## Overall, found 28 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 60 associations found out of 657 markers ##   Part 21: 28 associations found out of 343 markers ##  ## Overall, found 88 associations with (uncorrected) combined p-values). listGwa(toy) ## 1 -> Phenotype: BMI | Covariates: Age, Gender | PCs: 1 ##      Putative formula: BMI ~ Age + Gender + PC1 + [SNP] ## 2 -> Phenotype: BMI | Covariates: Age, Gender | PCs: - ##      Putative formula: BMI ~ Age + Gender + [SNP] ## 3 -> Phenotype: BMI | Covariates: Age, Case_Control, Gender | PCs: - ##      Putative formula: BMI ~ Age + Case_Control + Gender + [SNP] ## 4 -> Phenotype: Case_Control | Covariates: Age, BMI, Gender | PCs: 1 ##      Putative formula: Case_Control ~ Age + BMI + Gender + PC1 + [SNP] ## 5 -> Phenotype: Case_Control | Covariates: Age, BMI, Gender | PCs: - ##      Putative formula: Case_Control ~ Age + BMI + Gender + [SNP] ##  ## Note: The PC variables have putative names based on the number of PCs included in the model. ## For example, instead of PC1, PC2, PC3 the actual PCs may be PC1, PC3, PC4"},{"path":"/articles/06-gwasfuns.html","id":"summary-statistics-with-rrblup","dir":"Articles","previous_headings":"Introduction","what":"Summary statistics with rrBLUP","title":"Single trait association tests and summary statistics","text":"test SNP toy dataset association main phenotype (BMI) given age, sex case/control status, along 1 PC. , run rrBLUP independently just get summary statistics. Please note rrBLUP suitable binary categorical variables. works continuous variables. contents rrSumstat matrix: Also, rrBLUP without PCs:","code":"data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Only 1 PC will be returned because of dataset size toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 962 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 23.44%, 154/657 ## Chromosome 21: 21.28%, 73/343 ## 227 markers are selected in total. ## LD pruning finished! 227 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 773 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 227 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 10268 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:33:00 2022    (internal increment: 13024) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:33:00 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:33:00 2022    Done. ## Selecting number of PCs to include ##   with Tracy-Widom test for significant eigenvalues ##     selected 1 PCs  rrSumstat <- gwaBlup(toy,response=\"BMI\",     covariates=c(\"Age\",\"Gender\"),usepc=\"rrint\",npcs=1) ##  ## Preparing genotypes for rrBLUP... ## Performing GWAS with rrBLUP model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ## Found 55 associations (uncorrected p-values). head(rrSumstat) ##                 snp chrom bp        BMI        effect      pvalue ## rs1009238 rs1009238    NA NA 0.77883380 -3.734729e-08 0.166404936 ## rs1940646 rs1940646    NA NA 0.53061081  2.095420e-08 0.294706141 ## rs1940651 rs1940651    NA NA 2.57551170 -6.830224e-08 0.002657592 ## rs1940658 rs1940658    NA NA 1.31138453 -4.537714e-08 0.048821989 ## rs1940670 rs1940670    NA NA 1.33929350  5.995759e-08 0.045783237 ## rs1954825 rs1954825    NA NA 0.01160779 -1.675637e-08 0.973626111 rrSumstat <- gwaBlup(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),     usepc=\"none\") ##  ## Preparing genotypes for rrBLUP... ## Performing GWAS with rrBLUP model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : No ## Found 48 associations (uncorrected p-values)."},{"path":"/articles/06-gwasfuns.html","id":"summary-statistics-with-statgengwas","dir":"Articles","previous_headings":"Introduction","what":"Summary statistics with statgenGWAS","title":"Single trait association tests and summary statistics","text":"test SNP toy dataset association similar settings previous examples. contents sgSumstat matrix:","code":"data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Only 1 PC will be returned because of dataset size toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 962 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 23.44%, 154/657 ## Chromosome 21: 21.28%, 73/343 ## 227 markers are selected in total. ## LD pruning finished! 227 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 773 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 227 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 10268 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:33:05 2022    (internal increment: 13024) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:33:05 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:33:05 2022    Done. ## Selecting number of PCs to include ##   with Tracy-Widom test for significant eigenvalues ##     selected 1 PCs  sgSumstat <- gwaStatgen(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),     pcs=TRUE) ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ## Found 42 associations (uncorrected p-values). head(sgSumstat) ##               effect  effectSe     pValue ## rs1009238 -0.6695949 0.6649569 0.31646937 ## rs1940646  0.4810610 0.6705028 0.47597033 ## rs1940651 -1.4435833 0.7031226 0.03940392 ## rs1940658 -0.9055187 0.6564590 0.16899183 ## rs1940670  0.8641115 0.6876647 0.21059949 ## rs1954825  0.1746483 0.6448801 0.78812052"},{"path":"/articles/06-gwasfuns.html","id":"summary-statistics-with-snptest","dir":"Articles","previous_headings":"Introduction","what":"Summary statistics with SNPTEST","title":"Single trait association tests and summary statistics","text":"test SNP toy dataset association similar settings previous examples. contents snpSumstat matrix: SNPTEST dominant effect model adding Case_Control covariate: SNPTEST Case_Control phenotype. case must convert Case_Control values 1 2 0 1 SNPTEST complains...","code":"data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Only 1 PC will be returned because of dataset size toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 962 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 23.44%, 154/657 ## Chromosome 21: 21.28%, 73/343 ## 227 markers are selected in total. ## LD pruning finished! 227 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 773 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 227 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 10268 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:33:06 2022    (internal increment: 13024) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:33:06 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:33:06 2022    Done. ## Selecting number of PCs to include ##   with Tracy-Widom test for significant eigenvalues ##     selected 1 PCs  if (Sys.which(\"snptest\") != \"\") {     snpSumstat <- gwaSnptest(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),         pcs=TRUE) } else {     snpSumstat <- matrix() } ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_SLDQQ5898S ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_SLDQQ5898S ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_SLDQQ5898S ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_SLDQQ5898S ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_SLDQQ5898S/plink_snptest_RZAMU4649H.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_SLDQQ5898S/plink_snptest_RZAMU4649H.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_SLDQQ5898S/plink_snptest_RZAMU4649H.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_SLDQQ5898S/plink_snptest_RZAMU4649H.bed \\ ##     /tmp/RtmpPHwuf6/snptest_SLDQQ5898S/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_SLDQQ5898S/snptest.out ## Found 38 associations (uncorrected p-values). head(snpSumstat) ##               effect       se    pvalue ## rs1009238 -0.1357960 0.134422 0.3123870 ## rs1940646  0.1001220 0.137311 0.4659020 ## rs1940651 -0.2962890 0.142989 0.0382558 ## rs1940658 -0.1868070 0.133843 0.1627990 ## rs1940670  0.1679460 0.136085 0.2171560 ## rs1954825  0.0347602 0.129139 0.7877990 if (Sys.which(\"snptest\") != \"\") {     snpSumstat <- gwaSnptest(toy,response=\"BMI\",         covariates=c(\"Age\",\"Gender\",\"Case_Control\"),pcs=TRUE) } else {     snpSumstat <- matrix() } ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_BYLLO1875F ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_BYLLO1875F ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_BYLLO1875F ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_BYLLO1875F ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_BYLLO1875F/plink_snptest_ZPSCO2758C.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_BYLLO1875F/plink_snptest_ZPSCO2758C.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_BYLLO1875F/plink_snptest_ZPSCO2758C.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_BYLLO1875F/plink_snptest_ZPSCO2758C.bed \\ ##     /tmp/RtmpPHwuf6/snptest_BYLLO1875F/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_BYLLO1875F/snptest.out ## Found 36 associations (uncorrected p-values). p <- phenotypes(toy) p$Case_Control2 <- p$Case_Control p$Case_Control2[p$Case_Control==1] <- 0 p$Case_Control2[p$Case_Control==2] <- 1 phenotypes(toy) <- p  if (Sys.which(\"snptest\") != \"\") {     snpSumstat <- gwaSnptest(toy,response=\"Case_Control2\",         covariates=c(\"Age\",\"Gender\",\"BMI\"),pcs=TRUE) } else {     snpSumstat <- matrix() } ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_OGHNM0655C ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_OGHNM0655C ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_OGHNM0655C ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_OGHNM0655C ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_OGHNM0655C/plink_snptest_PTVGW6658Z.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_OGHNM0655C/plink_snptest_PTVGW6658Z.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_OGHNM0655C/plink_snptest_PTVGW6658Z.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : Case_Control2 ## Covariate(s): Age, Gender, BMI ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_OGHNM0655C/plink_snptest_PTVGW6658Z.bed \\ ##     /tmp/RtmpPHwuf6/snptest_OGHNM0655C/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno Case_Control2 \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_OGHNM0655C/snptest.out ## Found 63 associations (uncorrected p-values)."},{"path":"/articles/06-gwasfuns.html","id":"summary-statistics-with-plink","dir":"Articles","previous_headings":"Introduction","what":"Summary statistics with PLINK","title":"Single trait association tests and summary statistics","text":"test SNP toy dataset association similar settings previous examples. contents plSumstat matrix: PLINK Case_Control covariate:","code":"data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Only 1 PC will be returned because of dataset size toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 962 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 23.44%, 154/657 ## Chromosome 21: 21.28%, 73/343 ## 227 markers are selected in total. ## LD pruning finished! 227 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 773 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 227 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 10268 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:33:18 2022    (internal increment: 13024) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:33:18 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:33:18 2022    Done. ## Selecting number of PCs to include ##   with Tracy-Widom test for significant eigenvalues ##     selected 1 PCs  if (Sys.which(\"plink\") != \"\") {     plSumstat <- gwaPlink(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),         pcs=TRUE) } else {     plSumstat <- matrix() } ## plink operations will be executed at /tmp/RtmpPHwuf6/plink_VFMGY3290Q ## Preparing PLINK association run at workspace directory: /tmp/RtmpPHwuf6/plink_VFMGY3290Q ##   writing the PLINK phenotype file... ##   writing the covariates file... ##   writing PLINK genotype files in /tmp/RtmpPHwuf6/plink_VFMGY3290Q ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/plink_VFMGY3290Q/plink_plink_BIEPK7257V.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/plink_VFMGY3290Q/plink_plink_BIEPK7257V.bim  ## Writing BED file to /tmp/RtmpPHwuf6/plink_VFMGY3290Q/plink_plink_BIEPK7257V.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with PLINK ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/plink-1.90/plink \\ ##   --bfile /tmp/RtmpPHwuf6/plink_VFMGY3290Q/plink_plink_BIEPK7257V \\ ##   --pheno /tmp/RtmpPHwuf6/plink_VFMGY3290Q/pheno_BIEPK7257V \\ ##   --allow-no-sex \\ ##   --ci 0.95 \\ ##   --seed 42 \\ ##   --out /tmp/RtmpPHwuf6/plink_VFMGY3290Q/out_BIEPK7257V \\ ##   --covar /tmp/RtmpPHwuf6/plink_VFMGY3290Q/covar_BIEPK7257V \\ ##   --linear perm ## Found 43 associations (uncorrected p-values). head(plSumstat) ##            effect     se    stat pvalue ## rs1009238  0.6696 0.6649  1.0070 0.3390 ## rs1940646 -0.4810 0.6722 -0.7156 0.4474 ## rs1940651  1.4440 0.6911  2.0890 0.0559 ## rs1940658  0.9055 0.6533  1.3860 0.1488 ## rs1940670 -0.8641 0.6856 -1.2600 0.2212 ## rs1954825 -0.1747 0.6480 -0.2695 1.0000 if (Sys.which(\"plink\") != \"\") {     plSumstat <- gwaPlink(toy,response=\"Case_Control\",         covariates=c(\"Age\",\"Gender\",\"BMI\"),pcs=TRUE) } else {     plSumstat <- matrix() } ## plink operations will be executed at /tmp/RtmpPHwuf6/plink_GNDFN5486O ## Preparing PLINK association run at workspace directory: /tmp/RtmpPHwuf6/plink_GNDFN5486O ##   writing the PLINK phenotype file... ##   writing the covariates file... ##   writing PLINK genotype files in /tmp/RtmpPHwuf6/plink_GNDFN5486O ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/plink_GNDFN5486O/plink_plink_KKRFY4296S.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/plink_GNDFN5486O/plink_plink_KKRFY4296S.bim  ## Writing BED file to /tmp/RtmpPHwuf6/plink_GNDFN5486O/plink_plink_KKRFY4296S.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with PLINK ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/plink-1.90/plink \\ ##   --bfile /tmp/RtmpPHwuf6/plink_GNDFN5486O/plink_plink_KKRFY4296S \\ ##   --pheno /tmp/RtmpPHwuf6/plink_GNDFN5486O/pheno_KKRFY4296S \\ ##   --allow-no-sex \\ ##   --ci 0.95 \\ ##   --seed 42 \\ ##   --out /tmp/RtmpPHwuf6/plink_GNDFN5486O/out_KKRFY4296S \\ ##   --covar /tmp/RtmpPHwuf6/plink_GNDFN5486O/covar_KKRFY4296S \\ ##   --logistic beta perm ## Found 54 associations (uncorrected p-values)."},{"path":"/articles/06-gwasfuns.html","id":"summary-statistics-with-more-than-one-test","dir":"Articles","previous_headings":"Introduction","what":"Summary statistics with more than one test","title":"Single trait association tests and summary statistics","text":"demonstrate usage gwa() function wraps many tests summary statistic acquisition regsiters results respective GWASExperiment slots. test SNP toy dataset association main phenotype (BMI) given age, sex case/control status, along 1 PC. also try additional associations several tests register toy dataset. Additional models without PCs: add Case_Control covariates: Change phenotype Case_Control change SNPTEST PLINK. Now, use listGwa() function see test results attached toy object: see effects p-values attached models. start first one phenotype BMI covariates Age Gender along 1 PC: notice additional column named fisher matrix p-values. represents combined p-value three tests using Fisher's p-value combination method. e matrix provides regression coefficients method SNP. used later calculation weighted PRSs. Furthermore, access case phenotype BMI covariates Age, Gender Case_Control PCs: also access case phenotype BMI covariate Age PCs: Whops! never fit model... Finally, also see case phenotype Case_Control covariates Age, Gender, BMI 1 PC:","code":"data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Only 1 PC will be returned because of dataset size toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 962 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 23.44%, 154/657 ## Chromosome 21: 21.28%, 73/343 ## 227 markers are selected in total. ## LD pruning finished! 227 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 773 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 227 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 10268 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:33:54 2022    (internal increment: 13024) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:33:54 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:33:54 2022    Done. ## Selecting number of PCs to include ##   with Tracy-Widom test for significant eigenvalues ##     selected 1 PCs  if (Sys.which(\"snptest\") != \"\") {     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),pcs=TRUE,         psig=0.05,methods=c(\"glm\",\"statgen\",\"snptest\")) } else {     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),pcs=TRUE,         psig=0.05,methods=c(\"glm\",\"statgen\")) } ##  ## Starting GWA analysis in 2 chunks with 3 methods: glm, statgen, snptest ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs1009238 to rs1568327 ## Found 24 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ## Found 24 associations (uncorrected p-values). ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_COQKD2277R ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_COQKD2277R ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_COQKD2277R ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_COQKD2277R ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_COQKD2277R/plink_snptest_UFSHT8740V.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_COQKD2277R/plink_snptest_UFSHT8740V.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_COQKD2277R/plink_snptest_UFSHT8740V.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_COQKD2277R/plink_snptest_UFSHT8740V.bed \\ ##     /tmp/RtmpPHwuf6/snptest_COQKD2277R/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_COQKD2277R/snptest.out ## Found 22 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 72 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs2824974 to rs2828316 ## Found 18 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ## Found 18 associations (uncorrected p-values). ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_QPVCQ0883T ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_QPVCQ0883T ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_QPVCQ0883T ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_QPVCQ0883T ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_QPVCQ0883T/plink_snptest_EQHBW5154V.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_QPVCQ0883T/plink_snptest_EQHBW5154V.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_QPVCQ0883T/plink_snptest_EQHBW5154V.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_QPVCQ0883T/plink_snptest_EQHBW5154V.bed \\ ##     /tmp/RtmpPHwuf6/snptest_QPVCQ0883T/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_QPVCQ0883T/snptest.out ## Found 16 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 42 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 72 associations found out of 657 markers ##   Part 21: 42 associations found out of 343 markers ##  ## Overall, found 114 associations with (uncorrected) combined p-values). if (Sys.which(\"snptest\") != \"\") {     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),pcs=FALSE,         psig=0.05,methods=c(\"glm\",\"statgen\",\"snptest\")) } else {     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),pcs=FALSE,         psig=0.05,methods=c(\"glm\",\"statgen\")) } ##  ## Starting GWA analysis in 2 chunks with 3 methods: glm, statgen, snptest ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 25 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : No ## Found 25 associations (uncorrected p-values). ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_FGJRT6809P ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_FGJRT6809P ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_FGJRT6809P ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_FGJRT6809P ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_FGJRT6809P/plink_snptest_XAHDO5210E.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_FGJRT6809P/plink_snptest_XAHDO5210E.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_FGJRT6809P/plink_snptest_XAHDO5210E.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : No ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_FGJRT6809P/plink_snptest_XAHDO5210E.bed \\ ##     /tmp/RtmpPHwuf6/snptest_FGJRT6809P/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_FGJRT6809P/snptest.out ## Found 28 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 71 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 16 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : No ## Found 16 associations (uncorrected p-values). ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_ODLGM4531L ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_ODLGM4531L ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_ODLGM4531L ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_ODLGM4531L ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_ODLGM4531L/plink_snptest_QFZPA8763Z.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_ODLGM4531L/plink_snptest_QFZPA8763Z.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_ODLGM4531L/plink_snptest_QFZPA8763Z.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : No ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_ODLGM4531L/plink_snptest_QFZPA8763Z.bed \\ ##     /tmp/RtmpPHwuf6/snptest_ODLGM4531L/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_ODLGM4531L/snptest.out ## Found 17 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 40 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 71 associations found out of 657 markers ##   Part 21: 40 associations found out of 343 markers ##  ## Overall, found 111 associations with (uncorrected) combined p-values). # With 1 PC if (Sys.which(\"snptest\") != \"\") {     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\"),         pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\",\"snptest\")) } else {     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\"),         pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\")) } ##  ## Starting GWA analysis in 2 chunks with 3 methods: glm, statgen, snptest ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs1009238 to rs1568327 ## Found 22 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ## Found 53 associations (uncorrected p-values). ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_EPPXW5838M ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_EPPXW5838M ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_EPPXW5838M ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_EPPXW5838M ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_EPPXW5838M/plink_snptest_FVSNY4040A.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_EPPXW5838M/plink_snptest_FVSNY4040A.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_EPPXW5838M/plink_snptest_FVSNY4040A.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_EPPXW5838M/plink_snptest_FVSNY4040A.bed \\ ##     /tmp/RtmpPHwuf6/snptest_EPPXW5838M/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_EPPXW5838M/snptest.out ## Found 22 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 71 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs2824974 to rs2828316 ## Found 16 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ## Found 16 associations (uncorrected p-values). ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_WRGTO6972S ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_WRGTO6972S ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_WRGTO6972S ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_WRGTO6972S ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_WRGTO6972S/plink_snptest_LTIDH4684E.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_WRGTO6972S/plink_snptest_LTIDH4684E.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_WRGTO6972S/plink_snptest_LTIDH4684E.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_WRGTO6972S/plink_snptest_LTIDH4684E.bed \\ ##     /tmp/RtmpPHwuf6/snptest_WRGTO6972S/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_WRGTO6972S/snptest.out ## Found 14 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 36 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 71 associations found out of 657 markers ##   Part 21: 36 associations found out of 343 markers ##  ## Overall, found 107 associations with (uncorrected) combined p-values).  # With no PCs if (Sys.which(\"snptest\") != \"\") {     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\"),         pcs=FALSE,psig=0.05,methods=c(\"glm\",\"statgen\",\"snptest\")) } else {     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\"),         pcs=FALSE,psig=0.05,methods=c(\"glm\",\"statgen\")) } ##  ## Starting GWA analysis in 2 chunks with 3 methods: glm, statgen, snptest ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 54 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : No ## Found 23 associations (uncorrected p-values). ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_PRMMF1810Y ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_PRMMF1810Y ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_PRMMF1810Y ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_PRMMF1810Y ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_PRMMF1810Y/plink_snptest_DKVSR3365R.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_PRMMF1810Y/plink_snptest_DKVSR3365R.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_PRMMF1810Y/plink_snptest_DKVSR3365R.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : No ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_PRMMF1810Y/plink_snptest_DKVSR3365R.bed \\ ##     /tmp/RtmpPHwuf6/snptest_PRMMF1810Y/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_PRMMF1810Y/snptest.out ## Found 22 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 103 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 20 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : No ## Found 13 associations (uncorrected p-values). ## snptest operations will be executed at /tmp/RtmpPHwuf6/snptest_IFMWK3677M ## Preparing SNPTEST association run at workspace directory: /tmp/RtmpPHwuf6/snptest_IFMWK3677M ##  writing SNPTEST sample file in /tmp/RtmpPHwuf6/snptest_IFMWK3677M ##   writing PLINK files in /tmp/RtmpPHwuf6/snptest_IFMWK3677M ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/snptest_IFMWK3677M/plink_snptest_JNNHN6437Z.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/snptest_IFMWK3677M/plink_snptest_JNNHN6437Z.bim  ## Writing BED file to /tmp/RtmpPHwuf6/snptest_IFMWK3677M/plink_snptest_JNNHN6437Z.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with SNPTEST ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : No ##  ## Executing: ## /home/panos/.local/share/R/snptest-2.5.4/snptest \\ ##   -data /tmp/RtmpPHwuf6/snptest_IFMWK3677M/plink_snptest_JNNHN6437Z.bed \\ ##     /tmp/RtmpPHwuf6/snptest_IFMWK3677M/pheno.sample \\ ##   -frequentist 1 \\ ##   -method score \\ ##   -pheno BMI \\ ##   -cov_all \\ ##   -o /tmp/RtmpPHwuf6/snptest_IFMWK3677M/snptest.out ## Found 13 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 44 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 103 associations found out of 657 markers ##   Part 21: 44 associations found out of 343 markers ##  ## Overall, found 147 associations with (uncorrected) combined p-values). # With 1 PC if (Sys.which(\"plink\") != \"\") {     toy <- gwa(toy,response=\"Case_Control\",covariates=c(\"Age\",\"Gender\",\"BMI\"),         pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\",\"plink\")) } else {     toy <- gwa(toy,response=\"Case_Control\",covariates=c(\"Age\",\"Gender\",\"BMI\"),         pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\")) } ##  ## Starting GWA analysis in 2 chunks with 3 methods: glm, statgen, plink ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Regression  : binomial (predicted) ## Use PCs     : Yes ##   testing SNPs from rs1009238 to rs1568327 ## Found 35 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : Yes ## Found 33 associations (uncorrected p-values). ## plink operations will be executed at /tmp/RtmpPHwuf6/plink_CRUVJ8812F ## Preparing PLINK association run at workspace directory: /tmp/RtmpPHwuf6/plink_CRUVJ8812F ##   writing the PLINK phenotype file... ##   writing the covariates file... ##   writing PLINK genotype files in /tmp/RtmpPHwuf6/plink_CRUVJ8812F ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/plink_CRUVJ8812F/plink_plink_QBLSL8132T.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/plink_CRUVJ8812F/plink_plink_QBLSL8132T.bim  ## Writing BED file to /tmp/RtmpPHwuf6/plink_CRUVJ8812F/plink_plink_QBLSL8132T.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with PLINK ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/plink-1.90/plink \\ ##   --bfile /tmp/RtmpPHwuf6/plink_CRUVJ8812F/plink_plink_QBLSL8132T \\ ##   --pheno /tmp/RtmpPHwuf6/plink_CRUVJ8812F/pheno_QBLSL8132T \\ ##   --allow-no-sex \\ ##   --ci 0.95 \\ ##   --seed 42 \\ ##   --out /tmp/RtmpPHwuf6/plink_CRUVJ8812F/out_QBLSL8132T \\ ##   --covar /tmp/RtmpPHwuf6/plink_CRUVJ8812F/covar_QBLSL8132T \\ ##   --logistic beta perm ## Found 36 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 79 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Regression  : binomial (predicted) ## Use PCs     : Yes ##   testing SNPs from rs2824974 to rs2828316 ## Found 19 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : Yes ## Found 22 associations (uncorrected p-values). ## plink operations will be executed at /tmp/RtmpPHwuf6/plink_YFGBR5935O ## Preparing PLINK association run at workspace directory: /tmp/RtmpPHwuf6/plink_YFGBR5935O ##   writing the PLINK phenotype file... ##   writing the covariates file... ##   writing PLINK genotype files in /tmp/RtmpPHwuf6/plink_YFGBR5935O ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/plink_YFGBR5935O/plink_plink_ZWXDN2389E.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/plink_YFGBR5935O/plink_plink_ZWXDN2389E.bim  ## Writing BED file to /tmp/RtmpPHwuf6/plink_YFGBR5935O/plink_plink_ZWXDN2389E.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with PLINK ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : Yes ##  ## Executing: ## /home/panos/.local/share/R/plink-1.90/plink \\ ##   --bfile /tmp/RtmpPHwuf6/plink_YFGBR5935O/plink_plink_ZWXDN2389E \\ ##   --pheno /tmp/RtmpPHwuf6/plink_YFGBR5935O/pheno_ZWXDN2389E \\ ##   --allow-no-sex \\ ##   --ci 0.95 \\ ##   --seed 42 \\ ##   --out /tmp/RtmpPHwuf6/plink_YFGBR5935O/out_ZWXDN2389E \\ ##   --covar /tmp/RtmpPHwuf6/plink_YFGBR5935O/covar_ZWXDN2389E \\ ##   --logistic beta perm ## Found 18 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 41 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 79 associations found out of 657 markers ##   Part 21: 41 associations found out of 343 markers ##  ## Overall, found 120 associations with (uncorrected) combined p-values).  # With no PCs if (Sys.which(\"plink\") != \"\") {     toy <- gwa(toy,response=\"Case_Control\",covariates=c(\"Age\",\"Gender\",\"BMI\"),         pcs=FALSE,psig=0.05,methods=c(\"glm\",\"statgen\",\"plink\")) } else {     toy <- gwa(toy,response=\"Case_Control\",covariates=c(\"Age\",\"Gender\",\"BMI\"),         pcs=FALSE,psig=0.05,methods=c(\"glm\",\"statgen\")) } ##  ## Starting GWA analysis in 2 chunks with 3 methods: glm, statgen, plink ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Regression  : binomial (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 60 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : No ## Found 31 associations (uncorrected p-values). ## plink operations will be executed at /tmp/RtmpPHwuf6/plink_SNTJN9609W ## Preparing PLINK association run at workspace directory: /tmp/RtmpPHwuf6/plink_SNTJN9609W ##   writing the PLINK phenotype file... ##   writing the covariates file... ##   writing PLINK genotype files in /tmp/RtmpPHwuf6/plink_SNTJN9609W ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/plink_SNTJN9609W/plink_plink_ILQRX2634W.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/plink_SNTJN9609W/plink_plink_ILQRX2634W.bim  ## Writing BED file to /tmp/RtmpPHwuf6/plink_SNTJN9609W/plink_plink_ILQRX2634W.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with PLINK ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : No ##  ## Executing: ## /home/panos/.local/share/R/plink-1.90/plink \\ ##   --bfile /tmp/RtmpPHwuf6/plink_SNTJN9609W/plink_plink_ILQRX2634W \\ ##   --pheno /tmp/RtmpPHwuf6/plink_SNTJN9609W/pheno_ILQRX2634W \\ ##   --allow-no-sex \\ ##   --ci 0.95 \\ ##   --seed 42 \\ ##   --out /tmp/RtmpPHwuf6/plink_SNTJN9609W/out_ILQRX2634W \\ ##   --covar /tmp/RtmpPHwuf6/plink_SNTJN9609W/covar_ILQRX2634W \\ ##   --logistic beta perm ## Found 32 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 103 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Regression  : binomial (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 28 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : No ## Found 20 associations (uncorrected p-values). ## plink operations will be executed at /tmp/RtmpPHwuf6/plink_CZNMI1328N ## Preparing PLINK association run at workspace directory: /tmp/RtmpPHwuf6/plink_CZNMI1328N ##   writing the PLINK phenotype file... ##   writing the covariates file... ##   writing PLINK genotype files in /tmp/RtmpPHwuf6/plink_CZNMI1328N ## Preflight... ## Writing FAM file to /tmp/RtmpPHwuf6/plink_CZNMI1328N/plink_plink_PZZQS2762N.fam  ## Writing extended MAP file to /tmp/RtmpPHwuf6/plink_CZNMI1328N/plink_plink_PZZQS2762N.bim  ## Writing BED file to /tmp/RtmpPHwuf6/plink_CZNMI1328N/plink_plink_PZZQS2762N.bed (SNP-major mode) ## Preparation done! ##  ## Performing GWAS with PLINK ## Trait(s)    : Case_Control ## Covariate(s): Age, Gender, BMI ## Use PCs     : No ##  ## Executing: ## /home/panos/.local/share/R/plink-1.90/plink \\ ##   --bfile /tmp/RtmpPHwuf6/plink_CZNMI1328N/plink_plink_PZZQS2762N \\ ##   --pheno /tmp/RtmpPHwuf6/plink_CZNMI1328N/pheno_PZZQS2762N \\ ##   --allow-no-sex \\ ##   --ci 0.95 \\ ##   --seed 42 \\ ##   --out /tmp/RtmpPHwuf6/plink_CZNMI1328N/out_PZZQS2762N \\ ##   --covar /tmp/RtmpPHwuf6/plink_CZNMI1328N/covar_PZZQS2762N \\ ##   --logistic beta perm ## Found 19 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 49 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 103 associations found out of 657 markers ##   Part 21: 49 associations found out of 343 markers ##  ## Overall, found 152 associations with (uncorrected) combined p-values). listGwa(toy) ## 1 -> Phenotype: BMI | Covariates: Age, Gender | PCs: 1 ##      Putative formula: BMI ~ Age + Gender + PC1 + [SNP] ## 2 -> Phenotype: BMI | Covariates: Age, Gender | PCs: - ##      Putative formula: BMI ~ Age + Gender + [SNP] ## 3 -> Phenotype: BMI | Covariates: Age, Case_Control, Gender | PCs: 1 ##      Putative formula: BMI ~ Age + Case_Control + Gender + PC1 + [SNP] ## 4 -> Phenotype: BMI | Covariates: Age, Case_Control, Gender | PCs: - ##      Putative formula: BMI ~ Age + Case_Control + Gender + [SNP] ## 5 -> Phenotype: Case_Control | Covariates: Age, BMI, Gender | PCs: 1 ##      Putative formula: Case_Control ~ Age + BMI + Gender + PC1 + [SNP] ## 6 -> Phenotype: Case_Control | Covariates: Age, BMI, Gender | PCs: - ##      Putative formula: Case_Control ~ Age + BMI + Gender + [SNP] ##  ## Note: The PC variables have putative names based on the number of PCs included in the model. ## For example, instead of PC1, PC2, PC3 the actual PCs may be PC1, PC3, PC4 p <- pvalues(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),npcs=1) head(p) ##                  glm    statgen   snptest      fisher ## rs1009238 0.31647832 0.31646353 0.3123870 0.327451895 ## rs1940646 0.47598195 0.47596004 0.4659020 0.609719029 ## rs1940651 0.03940511 0.03940241 0.0382558 0.003449833 ## rs1940658 0.16900001 0.16898846 0.1627990 0.096683730 ## rs1940670 0.21059720 0.21060807 0.2171560 0.158151740 ## rs1954825 0.78810519 0.78809447 0.7877990 0.964036429  e <- effects(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),npcs=1) head(e) ##                  glm    statgen    snptest ## rs1009238 -0.6695782 -0.6696046 -0.1357960 ## rs1940646  0.4810455  0.4810737  0.1001220 ## rs1940651 -1.4435680 -1.4435983 -0.2962890 ## rs1940658 -0.9054984 -0.9055274 -0.1868070 ## rs1940670  0.8641098  0.8640962  0.1679460 ## rs1954825  0.1746603  0.1746709  0.0347602 p <- pvalues(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\")) head(p) ##                  glm    statgen   snptest       fisher ## rs1009238 0.14212106 0.14211747 0.1395850 0.0679656741 ## rs1940646 0.08739586 0.08738919 0.0844680 0.0227911189 ## rs1940651 0.01375438 0.01375287 0.0136554 0.0002496301 ## rs1940658 0.18657047 0.18656332 0.1805250 0.1188935709 ## rs1940670 0.40166435 0.40168686 0.4052340 0.4869093573 ## rs1954825 0.77932398 0.77934969 0.7769420 0.9593598078  e <- effects(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\")) head(e) ##                  glm    statgen    snptest ## rs1009238 -0.7981357 -0.7981498 -0.1621830 ## rs1940646  0.9427230  0.9427508  0.1934790 ## rs1940651 -1.4033121 -1.4033440 -0.2879970 ## rs1940658 -0.7112943 -0.7113093 -0.1463780 ## rs1940670  0.4717259  0.4717071  0.0925017 ## rs1954825 -0.1472900 -0.1472737 -0.0298792 p <- pvalues(toy,response=\"BMI\",covariates=\"Age\") head(p) ## NULL # NULL p <- pvalues(toy,response=\"Case_Control\",covariates=c(\"Age\",\"Gender\",\"BMI\"),     npcs=1) head(p) ##                 glm    statgen  plink     fisher ## rs1009238 0.5049708 0.26931142 0.5385 0.51489328 ## rs1940646 0.1200773 0.05172862 0.1295 0.02695589 ## rs1940651 0.2967032 0.16564973 0.3519 0.22982557 ## rs1940658 0.9764899 0.75390414 0.7778 0.98086897 ## rs1940670 0.8260349 0.70498567 0.8571 0.96647635 ## rs1954825 0.3453345 0.43659563 0.3393 0.42929793  e <- effects(toy,response=\"Case_Control\",covariates=c(\"Age\",\"Gender\",\"BMI\"),     npcs=1) head(e) ##                   glm     statgen    plink ## rs1009238  0.33192525  0.05973733 -0.33190 ## rs1940646 -0.86898631 -0.10506731  0.86900 ## rs1940651  0.59339897  0.08035293 -0.59340 ## rs1940658 -0.01394122  0.01677897  0.01394 ## rs1940670  0.11419298  0.02124142 -0.11420 ## rs1954825  0.46707205  0.04064121 -0.46710"},{"path":"/articles/06-gwasfuns.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R session info","title":"Single trait association tests and summary statistics","text":"","code":"sessionInfo() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 18.04.6 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] prisma_0.0.2                SNPRelate_1.28.0            ##  [3] gdsfmt_1.30.0               snpStats_1.44.0             ##  [5] Matrix_1.4-1                survival_3.3-1              ##  [7] SummarizedExperiment_1.24.0 Biobase_2.54.0              ##  [9] GenomicRanges_1.46.1        GenomeInfoDb_1.30.1         ## [11] IRanges_2.28.0              S4Vectors_0.32.4            ## [13] BiocGenerics_0.40.0         MatrixGenerics_1.6.0        ## [15] matrixStats_0.62.0          lassosum_0.4.5              ##  ## loaded via a namespace (and not attached): ##   [1] utf8_1.2.2                               ##   [2] R.utils_2.11.0                           ##   [3] tidyselect_1.1.2                         ##   [4] gwascat_2.26.0                           ##   [5] RSQLite_2.2.14                           ##   [6] AnnotationDbi_1.56.2                     ##   [7] grid_4.1.3                               ##   [8] BiocParallel_1.28.3                      ##   [9] munsell_0.5.0                            ##  [10] codetools_0.2-18                         ##  [11] ragg_1.2.2                               ##  [12] future_1.25.0                            ##  [13] quincunx_0.1.4                           ##  [14] islasso_1.4.3                            ##  [15] colorspace_2.0-3                         ##  [16] filelock_1.0.2                           ##  [17] OrganismDbi_1.36.0                       ##  [18] knitr_1.39                               ##  [19] rstudioapi_0.13                          ##  [20] robustbase_0.95-0                        ##  [21] TTR_0.24.3                               ##  [22] listenv_0.8.0                            ##  [23] optparse_1.7.1                           ##  [24] GenomeInfoDbData_1.2.7                   ##  [25] bit64_4.0.5                              ##  [26] rprojroot_2.0.3                          ##  [27] parallelly_1.31.1                        ##  [28] vctrs_0.4.1                              ##  [29] generics_0.1.2                           ##  [30] xfun_0.31                                ##  [31] BiocFileCache_2.2.1                      ##  [32] R6_2.5.1                                 ##  [33] rmdformats_1.0.3                         ##  [34] bitops_1.0-7                             ##  [35] cachem_1.0.6                             ##  [36] DelayedArray_0.20.0                      ##  [37] assertthat_0.2.1                         ##  [38] gwasrapidd_0.99.12                       ##  [39] BiocIO_1.4.0                             ##  [40] Homo.sapiens_1.3.1                       ##  [41] scales_1.2.0                             ##  [42] gtable_0.3.0                             ##  [43] globals_0.15.0                           ##  [44] rlang_1.0.2                              ##  [45] systemfonts_1.0.4                        ##  [46] splines_4.1.3                            ##  [47] rtracklayer_1.54.0                       ##  [48] rsnps_0.5.0.0                            ##  [49] sitadela_1.3.1                           ##  [50] BiocManager_1.30.16                      ##  [51] yaml_2.3.5                               ##  [52] reshape2_1.4.4                           ##  [53] GenomicFeatures_1.46.5                   ##  [54] quantmod_0.4.20                          ##  [55] RBGL_1.70.0                              ##  [56] tools_4.1.3                              ##  [57] lava_1.6.10                              ##  [58] bookdown_0.26                            ##  [59] liftOver_1.18.0                          ##  [60] ggplot2_3.3.5                            ##  [61] ellipsis_0.3.2                           ##  [62] kableExtra_1.3.4                         ##  [63] jquerylib_0.1.4                          ##  [64] Rcpp_1.0.8.3                             ##  [65] rrBLUP_4.6.1                             ##  [66] plyr_1.8.7                               ##  [67] progress_1.2.2                           ##  [68] zlibbioc_1.40.0                          ##  [69] purrr_0.3.4                              ##  [70] RCurl_1.98-1.6                           ##  [71] prettyunits_1.1.1                        ##  [72] cowplot_1.1.1                            ##  [73] zoo_1.8-10                               ##  [74] fs_1.5.2                                 ##  [75] crul_1.2.0                               ##  [76] magrittr_2.0.3                           ##  [77] data.table_1.14.2                        ##  [78] openxlsx_4.2.5                           ##  [79] mvtnorm_1.1-3                            ##  [80] survcomp_1.44.1                          ##  [81] hms_1.1.1                                ##  [82] evaluate_0.15                            ##  [83] XML_3.99-0.9                             ##  [84] RMTstat_0.3.1                            ##  [85] shape_1.4.6                              ##  [86] compiler_4.1.3                           ##  [87] biomaRt_2.50.3                           ##  [88] tibble_3.1.7                             ##  [89] KernSmooth_2.23-20                       ##  [90] crayon_1.5.1                             ##  [91] R.oo_1.24.0                              ##  [92] htmltools_0.5.2                          ##  [93] pcaPP_2.0-1                              ##  [94] tzdb_0.3.0                               ##  [95] rrcov_1.7-0                              ##  [96] DBI_1.1.2                                ##  [97] SuppDists_1.1-9.7                        ##  [98] dbplyr_2.1.1                             ##  [99] MASS_7.3-56                              ## [100] rappdirs_0.3.3                           ## [101] PhenotypeSimulator_0.3.4                 ## [102] getopt_1.20.3                            ## [103] readr_2.1.2                              ## [104] rmeta_3.0                                ## [105] cli_3.3.0                                ## [106] quadprog_1.5-8                           ## [107] R.methodsS3_1.8.1                        ## [108] parallel_4.1.3                           ## [109] pkgconfig_2.0.3                          ## [110] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ## [111] pkgdown_2.0.3.9000                       ## [112] GenomicAlignments_1.30.0                 ## [113] signal_0.7-7                             ## [114] xml2_1.3.3                               ## [115] foreach_1.5.2                            ## [116] svglite_2.1.0                            ## [117] bslib_0.3.1                              ## [118] webshot_0.5.3                            ## [119] XVector_0.34.0                           ## [120] prodlim_2019.11.13                       ## [121] rvest_1.0.2                              ## [122] stringr_1.4.0                            ## [123] VariantAnnotation_1.40.0                 ## [124] digest_0.6.29                            ## [125] graph_1.72.0                             ## [126] httpcode_0.3.0                           ## [127] Biostrings_2.62.0                        ## [128] rmarkdown_2.14                           ## [129] harmonicmeanp_3.0                        ## [130] restfulr_0.0.13                          ## [131] curl_4.3.2                               ## [132] Rsamtools_2.10.0                         ## [133] rjson_0.2.21                             ## [134] tseries_0.10-51                          ## [135] lifecycle_1.0.1                          ## [136] jsonlite_1.8.0                           ## [137] survivalROC_1.0.3                        ## [138] desc_1.4.1                               ## [139] viridisLite_0.4.0                        ## [140] BSgenome_1.62.0                          ## [141] fansi_1.0.3                              ## [142] pillar_1.7.0                             ## [143] lattice_0.20-45                          ## [144] DEoptimR_1.0-11                          ## [145] KEGGREST_1.34.0                          ## [146] fastmap_1.1.0                            ## [147] httr_1.4.3                               ## [148] GO.db_3.14.0                             ## [149] xts_0.12.1                               ## [150] glue_1.6.2                               ## [151] zip_2.2.0                                ## [152] SNPlocs.Hsapiens.dbSNP151.GRCh38_0.99.20 ## [153] png_0.1-7                                ## [154] iterators_1.0.14                         ## [155] pander_0.6.5                             ## [156] glmnet_4.1-4                             ## [157] bit_4.0.4                                ## [158] stringi_1.7.6                            ## [159] sass_0.4.1                               ## [160] bootstrap_2019.6                         ## [161] blob_1.2.3                               ## [162] statgenGWAS_1.0.8                        ## [163] textshaping_0.3.6                        ## [164] org.Hs.eg.db_3.14.0                      ## [165] memoise_2.0.1                            ## [166] FMStable_0.1-2                           ## [167] dplyr_1.0.8                              ## [168] future.apply_1.9.0"},{"path":"/articles/07-prsfuns.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Derivation of PRS candidates and evaluation","text":"main purpose PRISMA development provide efficient wrapper integrate several steps required derivation PRSs, derivation summary statistics iterative fashion smaller datsets, actual extraction evaluation PRS, iterative stabilizing way. derivation summary statistics, step concerns actual PRS extraction genotypes summary statistics, queried phenotype covariates. user can perform PRS analysis available algorithms supported PRISMA gather output data easily interpretable formats, can used PRS evaluation. PRISMA currently supports two methods extracting PRSs. specifically: PRSice2, operates based PLINK framework automates PRS extraction process based clumping thresholding followed weighted PRS construction evaluation linear regression. lassosum, utilizes penalized (LASSO) regression shrink effects less informative variants without completely removing PRS. examples use toy dataset included PRISMA. reason perform additional prior filtering although typical situation, genotypes filtered prior GWA testing subsequent PRS analysis. main function PRS extraction testing runPRS() function attaches results GWASExperiment object. PRS extraction function (e.g. prsicePRS()) can used independently returns data frame SNPs PRS single run. following sections illustrate usage.","code":""},{"path":"/articles/07-prsfuns.html","id":"prs-analysis-with-lassosum","dir":"Articles","previous_headings":"Introduction","what":"PRS analysis with lassosum","title":"Derivation of PRS candidates and evaluation","text":"toy dataset split two parts, one training, derivation summary statistics, one testing, extraction PRS. using 80% samples training (base) 20% testing (target). Theoretically, one can use whole dataset training testing lead extreme overfitting PRSs poor predictive value. test SNP toy dataset association main phenotype (BMI) given age, sex case/control status, along 1 PC using GLM statgenGWAS. PRS extraction analysis follows. output summary statistics outcome PRS analysis registered GWASExperiment object. load data partition dataset perform PCA. training test sets number PCs indicating underlying population stratification datasets: Now, summary statistics Verify three different models: Derivation lassosum PRS three models: Peak contents lassosum PRS:","code":"data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  tt <- partitionGWAS(toy,by=\"BMI\",out=\"ttboth\") ## Partitioning dataset into 1 partitions by BMI base <- tt$train target <- tt$test base <- suppressWarnings(calcPcaCovar(base,method=\"snprel\")) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 58 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 50 ##     # of SNPs: 942 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 16.44%, 108/657 ## Chromosome 21: 16.33%, 56/343 ## 164 markers are selected in total. ## LD pruning finished! 164 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 836 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 50 ##     # of SNPs: 164 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 3695 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:36:55 2022    (internal increment: 26048) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:36:55 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:36:55 2022    Done. ## Selecting number of PCs to include ##   with Tracy-Widom test for significant eigenvalues ##     selected 1 PCs target <- suppressWarnings(calcPcaCovar(target,method=\"snprel\",npc=1)) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 54 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 50 ##     # of SNPs: 946 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 16.13%, 106/657 ## Chromosome 21: 16.62%, 57/343 ## 163 markers are selected in total. ## LD pruning finished! 163 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 837 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 50 ##     # of SNPs: 163 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 4148 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:36:55 2022    (internal increment: 26048) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:36:55 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:36:55 2022    Done. ## Selecting number of PCs to include ##   with hard-cutoff at 1 PCs # With 1 PC base <- gwa(base,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),     pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\")) ##  ## Starting GWA analysis in 2 chunks with 2 methods: glm, statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs1009238 to rs1568327 ## Found 27 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ## Found 29 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 50 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs2824974 to rs2828316 ## Found 11 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : Yes ## Found 11 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 27 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 50 associations found out of 657 markers ##   Part 21: 27 associations found out of 343 markers ##  ## Overall, found 77 associations with (uncorrected) combined p-values).  # With no PCs base <- gwa(base,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),     pcs=FALSE,psig=0.05,methods=c(\"glm\",\"statgen\")) ##  ## Starting GWA analysis in 2 chunks with 2 methods: glm, statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 25 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : No ## Found 26 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 49 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 13 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender ## Use PCs     : No ## Found 13 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 25 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 49 associations found out of 657 markers ##   Part 21: 25 associations found out of 343 markers ##  ## Overall, found 74 associations with (uncorrected) combined p-values).      # With 1 PCs and one more covariate base <- gwa(base,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\"),     pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\")) ##  ## Starting GWA analysis in 2 chunks with 2 methods: glm, statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs1009238 to rs1568327 ## Found 40 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ## Found 23 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 64 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Regression  : gaussian (predicted) ## Use PCs     : Yes ##   testing SNPs from rs2824974 to rs2828316 ## Found 10 associations (uncorrected p-values). ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ## Found 10 associations (uncorrected p-values). ##  ## Combining p-values from multi-GWAS using fisher method ##  ## Overall, found 21 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 64 associations found out of 657 markers ##   Part 21: 21 associations found out of 343 markers ##  ## Overall, found 85 associations with (uncorrected) combined p-values). listGwa(base) ## 1 -> Phenotype: BMI | Covariates: Age, Gender | PCs: 1 ##      Putative formula: BMI ~ Age + Gender + PC1 + [SNP] ## 2 -> Phenotype: BMI | Covariates: Age, Gender | PCs: - ##      Putative formula: BMI ~ Age + Gender + [SNP] ## 3 -> Phenotype: BMI | Covariates: Age, Case_Control, Gender | PCs: 1 ##      Putative formula: BMI ~ Age + Case_Control + Gender + PC1 + [SNP] ##  ## Note: The PC variables have putative names based on the number of PCs included in the model. ## For example, instead of PC1, PC2, PC3 the actual PCs may be PC1, PC3, PC4 lassoPrs1 <- lassosumPRS(base=base,target=target,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),pcs=TRUE) ## lassosum operations will be executed at /tmp/RtmpaxQu3z/lassosum_TYBRI8059C ## Preparing lassosum run at workspace directory: /tmp/RtmpaxQu3z/lassosum_TYBRI8059C ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/lassosum_TYBRI8059C/plink_lassosum_target_JOOKT3267U.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/lassosum_TYBRI8059C/plink_lassosum_target_JOOKT3267U.bim  ## Writing BED file to /tmp/RtmpaxQu3z/lassosum_TYBRI8059C/plink_lassosum_target_JOOKT3267U.bed (SNP-major mode) ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Coordinating summary stats with reference panel... ## Coordinating summary stats with test data... ## Coordinating summary stats, reference panel, and test data... ## Splitting genome by LD blocks ... ## Running lassosum ... ## s =  0.2  ## s =  0.5  ## s =  0.9  ## Running lassosum with s=1... ## Calculating polygenic scores ... ## Running lassosum validation and PRS calculation ## 50 out of 50 samples kept in pheno. ## 50 out of 50 samples kept in covar. ## Done! R^2 is: 0.0097569064977603  lassoPrs2 <- lassosumPRS(base=base,target=target,response=\"BMI\",     covariates=c(\"Age\",\"Gender\"),pcs=FALSE) ## lassosum operations will be executed at /tmp/RtmpaxQu3z/lassosum_ZZTCA3632F ## Preparing lassosum run at workspace directory: /tmp/RtmpaxQu3z/lassosum_ZZTCA3632F ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/lassosum_ZZTCA3632F/plink_lassosum_target_NXZCZ1838B.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/lassosum_ZZTCA3632F/plink_lassosum_target_NXZCZ1838B.bim  ## Writing BED file to /tmp/RtmpaxQu3z/lassosum_ZZTCA3632F/plink_lassosum_target_NXZCZ1838B.bed (SNP-major mode) ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Coordinating summary stats with reference panel... ## Coordinating summary stats with test data... ## Coordinating summary stats, reference panel, and test data... ## Splitting genome by LD blocks ... ## Running lassosum ... ## s =  0.2  ## s =  0.5  ## s =  0.9  ## Running lassosum with s=1... ## Calculating polygenic scores ... ## Running lassosum validation and PRS calculation ## 50 out of 50 samples kept in pheno. ## 50 out of 50 samples kept in covar. ## Done! R^2 is: 0.00673532592199985          lassoPrs3 <- lassosumPRS(base=base,target=target,response=\"BMI\",     covariates=c(\"Age\",\"Gender\",\"Case_Control\"),pcs=TRUE) ## lassosum operations will be executed at /tmp/RtmpaxQu3z/lassosum_YUXVY2261D ## Preparing lassosum run at workspace directory: /tmp/RtmpaxQu3z/lassosum_YUXVY2261D ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/lassosum_YUXVY2261D/plink_lassosum_target_KDTOB4328E.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/lassosum_YUXVY2261D/plink_lassosum_target_KDTOB4328E.bim  ## Writing BED file to /tmp/RtmpaxQu3z/lassosum_YUXVY2261D/plink_lassosum_target_KDTOB4328E.bed (SNP-major mode) ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Coordinating summary stats with reference panel... ## Coordinating summary stats with test data... ## Coordinating summary stats, reference panel, and test data... ## Splitting genome by LD blocks ... ## Running lassosum ... ## s =  0.2  ## s =  0.5  ## s =  0.9  ## Running lassosum with s=1... ## Calculating polygenic scores ... ## Running lassosum validation and PRS calculation ## 50 out of 50 samples kept in pheno. ## 50 out of 50 samples kept in covar. ## Done! R^2 is: 0.0062491480825485 head(lassoPrs1) ##           chromosome position variant_id risk_allele reference_allele ## rs1009238         18  2000079  rs1009238           G                A ## rs1940646         18  2002665  rs1940646           A                G ## rs1940651         18  2006123  rs1940651           G                A ## rs1940658         18  2029280  rs1940658           A                G ## rs1940670         18  2042445  rs1940670           A                G ## rs1954825         18  2068872  rs1954825           A                G ##           locus_name effect_weight        OR  asm ## rs1009238         NA  -0.247913478 0.7804275 hg19 ## rs1940646         NA   0.130474846 1.1393693 hg19 ## rs1940651         NA  -0.309550457 0.7337767 hg19 ## rs1940658         NA  -0.174989920 0.8394655 hg19 ## rs1940670         NA   0.209654564 1.2332520 hg19 ## rs1954825         NA  -0.009394257 0.9906497 hg19  head(lassoPrs3) ##           chromosome position variant_id risk_allele reference_allele ## rs1009238         18  2000079  rs1009238           G                A ## rs1940646         18  2002665  rs1940646           A                G ## rs1940651         18  2006123  rs1940651           G                A ## rs1940658         18  2029280  rs1940658           A                G ## rs1940670         18  2042445  rs1940670           A                G ## rs1954825         18  2068872  rs1954825           A                G ##           locus_name effect_weight        OR  asm ## rs1009238         NA  -0.143099565 0.8666678 hg19 ## rs1940646         NA   0.272987989 1.3138845 hg19 ## rs1940651         NA  -0.230740685 0.7939453 hg19 ## rs1940658         NA  -0.010749823 0.9893078 hg19 ## rs1940670         NA   0.160116411 1.1736475 hg19 ## rs1954825         NA  -0.007496655 0.9925314 hg19"},{"path":"/articles/07-prsfuns.html","id":"prs-analysis-with-prsice2","dir":"Articles","previous_headings":"Introduction","what":"PRS analysis with PRSice2","title":"Derivation of PRS candidates and evaluation","text":"assume dataset split summary statistics, calculated : Peak contents lassosum PRS:","code":"if (.Platform$OS.type == \"unix\" && !grepl(\"^darwin\",R.version$os)      && Sys.which(\"PRSice_linux\") != \"\") {     prsicePrs1 <- prsicePRS(base=base,target=target,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),pcs=TRUE,perm=100)      prsicePrs2 <- prsicePRS(base=base,target=target,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),pcs=FALSE,perm=100)                  prsicePrs3 <- prsicePRS(base=base,target=target,response=\"BMI\",         covariates=c(\"Age\",\"Gender\",\"Case_Control\"),pcs=TRUE,perm=100) } ## prsice operations will be executed at /tmp/RtmpaxQu3z/prsice_DVLME6409V ## Preparing PRSice run at workspace directory: /tmp/RtmpaxQu3z/prsice_DVLME6409V ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/prsice_DVLME6409V/plink_prsice_EBIFZ2906D.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/prsice_DVLME6409V/plink_prsice_EBIFZ2906D.bim  ## Writing BED file to /tmp/RtmpaxQu3z/prsice_DVLME6409V/plink_prsice_EBIFZ2906D.bed (SNP-major mode) ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpaxQu3z/prsice_DVLME6409V/base_EBIFZ2906D \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpaxQu3z/prsice_DVLME6409V/pheno_EBIFZ2906D \\ ##   --target /tmp/RtmpaxQu3z/prsice_DVLME6409V/plink_prsice_EBIFZ2906D \\ ##   --cov /tmp/RtmpaxQu3z/prsice_DVLME6409V/covar_EBIFZ2906D \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 1 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_EBIFZ2906D \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0539102 ## Full model R^2 is: 0.316611 ## Null model R^2 is: 0.262701 ## prsice operations will be executed at /tmp/RtmpaxQu3z/prsice_ZVBNY2949S ## Preparing PRSice run at workspace directory: /tmp/RtmpaxQu3z/prsice_ZVBNY2949S ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/prsice_ZVBNY2949S/plink_prsice_YPSLL9846T.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/prsice_ZVBNY2949S/plink_prsice_YPSLL9846T.bim  ## Writing BED file to /tmp/RtmpaxQu3z/prsice_ZVBNY2949S/plink_prsice_YPSLL9846T.bed (SNP-major mode) ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpaxQu3z/prsice_ZVBNY2949S/base_YPSLL9846T \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpaxQu3z/prsice_ZVBNY2949S/pheno_YPSLL9846T \\ ##   --target /tmp/RtmpaxQu3z/prsice_ZVBNY2949S/plink_prsice_YPSLL9846T \\ ##   --cov /tmp/RtmpaxQu3z/prsice_ZVBNY2949S/covar_YPSLL9846T \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 1 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_YPSLL9846T \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0601267 ## Full model R^2 is: 0.321912 ## Null model R^2 is: 0.261785 ## prsice operations will be executed at /tmp/RtmpaxQu3z/prsice_XLKVF4743C ## Preparing PRSice run at workspace directory: /tmp/RtmpaxQu3z/prsice_XLKVF4743C ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/prsice_XLKVF4743C/plink_prsice_ETJRV5338B.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/prsice_XLKVF4743C/plink_prsice_ETJRV5338B.bim  ## Writing BED file to /tmp/RtmpaxQu3z/prsice_XLKVF4743C/plink_prsice_ETJRV5338B.bed (SNP-major mode) ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpaxQu3z/prsice_XLKVF4743C/base_ETJRV5338B \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpaxQu3z/prsice_XLKVF4743C/pheno_ETJRV5338B \\ ##   --target /tmp/RtmpaxQu3z/prsice_XLKVF4743C/plink_prsice_ETJRV5338B \\ ##   --cov /tmp/RtmpaxQu3z/prsice_XLKVF4743C/covar_ETJRV5338B \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 1 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_ETJRV5338B \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0533969 ## Full model R^2 is: 0.514054 ## Null model R^2 is: 0.460657 head(prsicePrs1) ##            chromosome position variant_id risk_allele reference_allele ## rs292367           18  5096936   rs292367           C                A ## rs11661323         18 24286162 rs11661323           G                A ## rs11876399         18  3615943 rs11876399           G                A ## rs2825678          21 20986798  rs2825678           G                A ## rs1025366          18 24414687  rs1025366           A                G ## rs1116852          21 22237121  rs1116852           G                A ##            locus_name effect_weight           OR  asm ## rs292367           NA     -4.606073  0.009990977 hg19 ## rs11661323         NA     -3.192376  0.041074182 hg19 ## rs11876399         NA     -2.544476  0.078514167 hg19 ## rs2825678          NA      2.895029 18.084025962 hg19 ## rs1025366          NA      3.740726 42.128558194 hg19 ## rs1116852          NA     -2.733084  0.065018462 hg19  head(prsicePrs3) ##           chromosome position variant_id risk_allele reference_allele ## rs1565082         18 21692286  rs1565082           G                A ## rs6506156         18  4040429  rs6506156           G                A ## rs979916          21 23607112   rs979916           A                G ## rs1740090         21 23258743  rs1740090           G                A ## rs2827694         21 24094938  rs2827694           G                A ## rs4800708         18 23595985  rs4800708           G                A ##           locus_name effect_weight           OR  asm ## rs1565082         NA      2.715768 15.116217068 hg19 ## rs6506156         NA     -2.582677  0.075571456 hg19 ## rs979916          NA     -2.491635  0.082774514 hg19 ## rs1740090         NA      2.323451 10.210849861 hg19 ## rs2827694         NA     -4.638936  0.009667979 hg19 ## rs4800708         NA     -5.555143  0.003867516 hg19"},{"path":"/articles/07-prsfuns.html","id":"prs-analysis-with-more-than-one-algorithm","dir":"Articles","previous_headings":"Introduction","what":"PRS analysis with more than one algorithm","title":"Derivation of PRS candidates and evaluation","text":"demonstrate usage runPRS() function wraps one PRS extraction algorithm regsiters results (SNPs participate effects) respective GWASExperiment slot (prsbetas). Now, use listPrs() function see PRS extraction results attached target object: see prsbetas p-values extracted PRSs. start first one phenotype BMI covariates Age Gender along 1 PC: another model: possible course use total dataset PRS analysis lot overfit: notice larger R2 values outputs.","code":"if (.Platform$OS.type == \"unix\" && !grepl(\"^darwin\",R.version$os)      && Sys.which(\"PRSice_linux\") != \"\") {     prsiceOpts <- getDefaults(\"prsice\")     prsiceOpts$perm <- 100          target <- runPRS(base=base,target=target,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),pcs=TRUE,prsiceOpts=prsiceOpts)          target <- runPRS(base=base,target=target,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),pcs=FALSE,prsiceOpts=prsiceOpts)              target <- runPRS(base=base,target=target,response=\"BMI\",         covariates=c(\"Age\",\"Gender\",\"Case_Control\"),pcs=TRUE,         prsiceOpts=prsiceOpts) } ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpaxQu3z/lassosum_KHVOY7223J ## Preparing lassosum run at workspace directory: /tmp/RtmpaxQu3z/lassosum_KHVOY7223J ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/lassosum_KHVOY7223J/plink_lassosum_target_NVLSL1478Q.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/lassosum_KHVOY7223J/plink_lassosum_target_NVLSL1478Q.bim  ## Writing BED file to /tmp/RtmpaxQu3z/lassosum_KHVOY7223J/plink_lassosum_target_NVLSL1478Q.bed (SNP-major mode) ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Coordinating summary stats with reference panel... ## Coordinating summary stats with test data... ## Coordinating summary stats, reference panel, and test data... ## Splitting genome by LD blocks ... ## Running lassosum ... ## s =  0.2  ## s =  0.5  ## s =  0.9  ## Running lassosum with s=1... ## Calculating polygenic scores ... ## Running lassosum validation and PRS calculation ## 50 out of 50 samples kept in pheno. ## 50 out of 50 samples kept in covar. ## Done! R^2 is: 0.0097569064977603 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpaxQu3z/prsice_IOIVT8138Z ## Preparing PRSice run at workspace directory: /tmp/RtmpaxQu3z/prsice_IOIVT8138Z ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/prsice_IOIVT8138Z/plink_prsice_RWNCK7354U.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/prsice_IOIVT8138Z/plink_prsice_RWNCK7354U.bim  ## Writing BED file to /tmp/RtmpaxQu3z/prsice_IOIVT8138Z/plink_prsice_RWNCK7354U.bed (SNP-major mode) ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpaxQu3z/prsice_IOIVT8138Z/base_RWNCK7354U \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpaxQu3z/prsice_IOIVT8138Z/pheno_RWNCK7354U \\ ##   --target /tmp/RtmpaxQu3z/prsice_IOIVT8138Z/plink_prsice_RWNCK7354U \\ ##   --cov /tmp/RtmpaxQu3z/prsice_IOIVT8138Z/covar_RWNCK7354U \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 1 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_RWNCK7354U \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0539102 ## Full model R^2 is: 0.316611 ## Null model R^2 is: 0.262701 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpaxQu3z/lassosum_LPOUD9139B ## Preparing lassosum run at workspace directory: /tmp/RtmpaxQu3z/lassosum_LPOUD9139B ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/lassosum_LPOUD9139B/plink_lassosum_target_RYRSE8634F.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/lassosum_LPOUD9139B/plink_lassosum_target_RYRSE8634F.bim  ## Writing BED file to /tmp/RtmpaxQu3z/lassosum_LPOUD9139B/plink_lassosum_target_RYRSE8634F.bed (SNP-major mode) ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Coordinating summary stats with reference panel... ## Coordinating summary stats with test data... ## Coordinating summary stats, reference panel, and test data... ## Splitting genome by LD blocks ... ## Running lassosum ... ## s =  0.2  ## s =  0.5  ## s =  0.9  ## Running lassosum with s=1... ## Calculating polygenic scores ... ## Running lassosum validation and PRS calculation ## 50 out of 50 samples kept in pheno. ## 50 out of 50 samples kept in covar. ## Done! R^2 is: 0.00673532592199985 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpaxQu3z/prsice_XFTYC0318P ## Preparing PRSice run at workspace directory: /tmp/RtmpaxQu3z/prsice_XFTYC0318P ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/prsice_XFTYC0318P/plink_prsice_LAEFA5392R.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/prsice_XFTYC0318P/plink_prsice_LAEFA5392R.bim  ## Writing BED file to /tmp/RtmpaxQu3z/prsice_XFTYC0318P/plink_prsice_LAEFA5392R.bed (SNP-major mode) ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpaxQu3z/prsice_XFTYC0318P/base_LAEFA5392R \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpaxQu3z/prsice_XFTYC0318P/pheno_LAEFA5392R \\ ##   --target /tmp/RtmpaxQu3z/prsice_XFTYC0318P/plink_prsice_LAEFA5392R \\ ##   --cov /tmp/RtmpaxQu3z/prsice_XFTYC0318P/covar_LAEFA5392R \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 1 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_LAEFA5392R \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0601267 ## Full model R^2 is: 0.321912 ## Null model R^2 is: 0.261785 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpaxQu3z/lassosum_XBBKS2871F ## Preparing lassosum run at workspace directory: /tmp/RtmpaxQu3z/lassosum_XBBKS2871F ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/lassosum_XBBKS2871F/plink_lassosum_target_ZSCHW1126I.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/lassosum_XBBKS2871F/plink_lassosum_target_ZSCHW1126I.bim  ## Writing BED file to /tmp/RtmpaxQu3z/lassosum_XBBKS2871F/plink_lassosum_target_ZSCHW1126I.bed (SNP-major mode) ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Coordinating summary stats with reference panel... ## Coordinating summary stats with test data... ## Coordinating summary stats, reference panel, and test data... ## Splitting genome by LD blocks ... ## Running lassosum ... ## s =  0.2  ## s =  0.5  ## s =  0.9  ## Running lassosum with s=1... ## Calculating polygenic scores ... ## Running lassosum validation and PRS calculation ## 50 out of 50 samples kept in pheno. ## 50 out of 50 samples kept in covar. ## Done! R^2 is: 0.0062491480825485 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpaxQu3z/prsice_CBPCN7260O ## Preparing PRSice run at workspace directory: /tmp/RtmpaxQu3z/prsice_CBPCN7260O ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/prsice_CBPCN7260O/plink_prsice_BZIZN9108F.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/prsice_CBPCN7260O/plink_prsice_BZIZN9108F.bim  ## Writing BED file to /tmp/RtmpaxQu3z/prsice_CBPCN7260O/plink_prsice_BZIZN9108F.bed (SNP-major mode) ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpaxQu3z/prsice_CBPCN7260O/base_BZIZN9108F \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpaxQu3z/prsice_CBPCN7260O/pheno_BZIZN9108F \\ ##   --target /tmp/RtmpaxQu3z/prsice_CBPCN7260O/plink_prsice_BZIZN9108F \\ ##   --cov /tmp/RtmpaxQu3z/prsice_CBPCN7260O/covar_BZIZN9108F \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 1 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_BZIZN9108F \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0533969 ## Full model R^2 is: 0.514054 ## Null model R^2 is: 0.460657 ##  ## Running PRS algorithms finished! Processing the results... ## Done! listPrs(target) ## 1 -> Phenotype: BMI | Covariates: Age, Gender | PCs: 1 ##      Putative formula: BMI ~ Age + Gender + PC1 + [PRS] ## 2 -> Phenotype: BMI | Covariates: Age, Gender | PCs: - ##      Putative formula: BMI ~ Age + Gender + [PRS] ## 3 -> Phenotype: BMI | Covariates: Age, Case_Control, Gender | PCs: 1 ##      Putative formula: BMI ~ Age + Case_Control + Gender + PC1 + [PRS] ##  ## Note: The PC variables have putative names based on the number of PCs included in the model. ## For example, instead of PC1, PC2, PC3 the actual PCs may be PC1, PC3, PC4 p <- prsbetas(target,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),npcs=1) head(p) ##               lassosum    prsice ## rs1009238 -0.247913478  0.000000 ## rs1940646  0.130474846  0.000000 ## rs1940651 -0.309550457 -2.103724 ## rs1940658 -0.174989920  0.000000 ## rs1940670  0.209654564  0.000000 ## rs1954825 -0.009394257  0.000000 p <- prsbetas(target,response=\"BMI\",covariates=c(\"Age\",\"Gender\",     \"Case_Control\"),npcs=1) head(p) ##               lassosum   prsice ## rs1009238 -0.143099565 0.000000 ## rs1940646  0.272987989 1.856082 ## rs1940651 -0.230740685 0.000000 ## rs1940658 -0.010749823 0.000000 ## rs1940670  0.160116411 1.417651 ## rs1954825 -0.007496655 0.000000 data(toy,package=\"prisma\")  gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\") toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) ## Performing PCA to select covariates to include in associations ## Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... ## Performing LD pruning... ## SNP pruning based on LD: ## Excluding 0 SNP (non-autosomes or non-selection) ## Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 962 ##     using 1 thread ##     sliding window: 500,000 basepairs, Inf SNPs ##     |LD| threshold: 0.2 ##     method: composite ## Chromosome 18: 23.44%, 154/657 ## Chromosome 21: 21.28%, 73/343 ## 227 markers are selected in total. ## LD pruning finished! 227 SNPs will be used for PCA. ##  ## Performing PCA... ## Principal Component Analysis (PCA) on genotypes: ## Excluding 773 SNPs (non-autosomes or non-selection) ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ##     # of samples: 100 ##     # of SNPs: 227 ##     using 1 thread ##     # of principal components: 32 ## PCA:    the sum of all selected genotypes (0,1,2) = 10268 ## CPU capabilities: Double-Precision SSE2 ## Mon Jun  6 20:38:32 2022    (internal increment: 13024) ##  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s ## Mon Jun  6 20:38:32 2022    Begin (eigenvalues and eigenvectors) ## Mon Jun  6 20:38:32 2022    Done. ## Selecting number of PCs to include ##   with Tracy-Widom test for significant eigenvalues ##     selected 1 PCs  toy <- gwa(base,response=\"BMI\",covariates=c(\"Age\",\"Gender\",\"Case_Control\"),     pcs=TRUE,psig=0.05,methods=\"statgen\") ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ## Found 23 associations (uncorrected p-values). ##  ## Overall, found 23 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Age, Gender, Case_Control ## Use PCs     : Yes ## Found 10 associations (uncorrected p-values). ##  ## Overall, found 10 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 23 associations found out of 657 markers ##   Part 21: 10 associations found out of 343 markers ##  ## Overall, found 33 associations with (uncorrected) combined p-values).  if (.Platform$OS.type == \"unix\" && !grepl(\"^darwin\",R.version$os)      && Sys.which(\"PRSice_linux\") != \"\") {     prsiceOpts <- getDefaults(\"prsice\")     prsiceOpts$perm <- 100          toy <- runPRS(base=toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\",         \"Case_Control\"),pcs=TRUE,prsiceOpts=prsiceOpts)  } ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpaxQu3z/lassosum_HMLHQ4605N ## Preparing lassosum run at workspace directory: /tmp/RtmpaxQu3z/lassosum_HMLHQ4605N ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/lassosum_HMLHQ4605N/plink_lassosum_target_WCAKQ5564T.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/lassosum_HMLHQ4605N/plink_lassosum_target_WCAKQ5564T.bim  ## Writing BED file to /tmp/RtmpaxQu3z/lassosum_HMLHQ4605N/plink_lassosum_target_WCAKQ5564T.bed (SNP-major mode) ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Coordinating summary stats with reference panel... ## Coordinating summary stats with test data... ## Coordinating summary stats, reference panel, and test data... ## Splitting genome by LD blocks ... ## Running lassosum ... ## s =  0.2  ## s =  0.5  ## s =  0.9  ## Running lassosum with s=1... ## Calculating polygenic scores ... ## Running lassosum validation and PRS calculation ## 50 out of 50 samples kept in pheno. ## 50 out of 50 samples kept in covar. ## Done! R^2 is: 0.932107366549915 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpaxQu3z/prsice_ZDGCW9541C ## Preparing PRSice run at workspace directory: /tmp/RtmpaxQu3z/prsice_ZDGCW9541C ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Writing FAM file to /tmp/RtmpaxQu3z/prsice_ZDGCW9541C/plink_prsice_YYMDC6768L.fam  ## Writing extended MAP file to /tmp/RtmpaxQu3z/prsice_ZDGCW9541C/plink_prsice_YYMDC6768L.bim  ## Writing BED file to /tmp/RtmpaxQu3z/prsice_ZDGCW9541C/plink_prsice_YYMDC6768L.bed (SNP-major mode) ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpaxQu3z/prsice_ZDGCW9541C/base_YYMDC6768L \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpaxQu3z/prsice_ZDGCW9541C/pheno_YYMDC6768L \\ ##   --target /tmp/RtmpaxQu3z/prsice_ZDGCW9541C/plink_prsice_YYMDC6768L \\ ##   --cov /tmp/RtmpaxQu3z/prsice_ZDGCW9541C/covar_YYMDC6768L \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 1 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_YYMDC6768L \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.504299 ## Full model R^2 is: 0.975283 ## Null model R^2 is: 0.470984 ##  ## Running PRS algorithms finished! Processing the results... ## Done!"},{"path":"/articles/07-prsfuns.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R session info","title":"Derivation of PRS candidates and evaluation","text":"","code":"sessionInfo() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 18.04.6 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] prisma_0.0.2                SNPRelate_1.28.0            ##  [3] gdsfmt_1.30.0               snpStats_1.44.0             ##  [5] Matrix_1.4-1                survival_3.3-1              ##  [7] SummarizedExperiment_1.24.0 Biobase_2.54.0              ##  [9] GenomicRanges_1.46.1        GenomeInfoDb_1.30.1         ## [11] IRanges_2.28.0              S4Vectors_0.32.4            ## [13] BiocGenerics_0.40.0         MatrixGenerics_1.6.0        ## [15] matrixStats_0.62.0          lassosum_0.4.5              ##  ## loaded via a namespace (and not attached): ##   [1] utf8_1.2.2                               ##   [2] R.utils_2.11.0                           ##   [3] tidyselect_1.1.2                         ##   [4] gwascat_2.26.0                           ##   [5] RSQLite_2.2.14                           ##   [6] AnnotationDbi_1.56.2                     ##   [7] grid_4.1.3                               ##   [8] BiocParallel_1.28.3                      ##   [9] munsell_0.5.0                            ##  [10] codetools_0.2-18                         ##  [11] ragg_1.2.2                               ##  [12] future_1.25.0                            ##  [13] quincunx_0.1.4                           ##  [14] islasso_1.4.3                            ##  [15] colorspace_2.0-3                         ##  [16] filelock_1.0.2                           ##  [17] OrganismDbi_1.36.0                       ##  [18] knitr_1.39                               ##  [19] rstudioapi_0.13                          ##  [20] robustbase_0.95-0                        ##  [21] TTR_0.24.3                               ##  [22] listenv_0.8.0                            ##  [23] optparse_1.7.1                           ##  [24] GenomeInfoDbData_1.2.7                   ##  [25] bit64_4.0.5                              ##  [26] rprojroot_2.0.3                          ##  [27] parallelly_1.31.1                        ##  [28] vctrs_0.4.1                              ##  [29] generics_0.1.2                           ##  [30] xfun_0.31                                ##  [31] BiocFileCache_2.2.1                      ##  [32] R6_2.5.1                                 ##  [33] rmdformats_1.0.3                         ##  [34] bitops_1.0-7                             ##  [35] cachem_1.0.6                             ##  [36] DelayedArray_0.20.0                      ##  [37] assertthat_0.2.1                         ##  [38] gwasrapidd_0.99.12                       ##  [39] BiocIO_1.4.0                             ##  [40] Homo.sapiens_1.3.1                       ##  [41] scales_1.2.0                             ##  [42] gtable_0.3.0                             ##  [43] globals_0.15.0                           ##  [44] rlang_1.0.2                              ##  [45] systemfonts_1.0.4                        ##  [46] splines_4.1.3                            ##  [47] rtracklayer_1.54.0                       ##  [48] rsnps_0.5.0.0                            ##  [49] sitadela_1.3.1                           ##  [50] BiocManager_1.30.16                      ##  [51] yaml_2.3.5                               ##  [52] reshape2_1.4.4                           ##  [53] GenomicFeatures_1.46.5                   ##  [54] quantmod_0.4.20                          ##  [55] RBGL_1.70.0                              ##  [56] tools_4.1.3                              ##  [57] lava_1.6.10                              ##  [58] bookdown_0.26                            ##  [59] liftOver_1.18.0                          ##  [60] ggplot2_3.3.5                            ##  [61] ellipsis_0.3.2                           ##  [62] kableExtra_1.3.4                         ##  [63] jquerylib_0.1.4                          ##  [64] Rcpp_1.0.8.3                             ##  [65] rrBLUP_4.6.1                             ##  [66] plyr_1.8.7                               ##  [67] progress_1.2.2                           ##  [68] zlibbioc_1.40.0                          ##  [69] purrr_0.3.4                              ##  [70] RCurl_1.98-1.6                           ##  [71] prettyunits_1.1.1                        ##  [72] cowplot_1.1.1                            ##  [73] zoo_1.8-10                               ##  [74] fs_1.5.2                                 ##  [75] crul_1.2.0                               ##  [76] magrittr_2.0.3                           ##  [77] data.table_1.14.2                        ##  [78] openxlsx_4.2.5                           ##  [79] mvtnorm_1.1-3                            ##  [80] survcomp_1.44.1                          ##  [81] hms_1.1.1                                ##  [82] evaluate_0.15                            ##  [83] XML_3.99-0.9                             ##  [84] RMTstat_0.3.1                            ##  [85] shape_1.4.6                              ##  [86] compiler_4.1.3                           ##  [87] biomaRt_2.50.3                           ##  [88] tibble_3.1.7                             ##  [89] KernSmooth_2.23-20                       ##  [90] crayon_1.5.1                             ##  [91] R.oo_1.24.0                              ##  [92] htmltools_0.5.2                          ##  [93] pcaPP_2.0-1                              ##  [94] tzdb_0.3.0                               ##  [95] rrcov_1.7-0                              ##  [96] DBI_1.1.2                                ##  [97] SuppDists_1.1-9.7                        ##  [98] dbplyr_2.1.1                             ##  [99] MASS_7.3-56                              ## [100] rappdirs_0.3.3                           ## [101] PhenotypeSimulator_0.3.4                 ## [102] getopt_1.20.3                            ## [103] readr_2.1.2                              ## [104] rmeta_3.0                                ## [105] cli_3.3.0                                ## [106] quadprog_1.5-8                           ## [107] R.methodsS3_1.8.1                        ## [108] parallel_4.1.3                           ## [109] pkgconfig_2.0.3                          ## [110] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ## [111] pkgdown_2.0.3.9000                       ## [112] GenomicAlignments_1.30.0                 ## [113] signal_0.7-7                             ## [114] xml2_1.3.3                               ## [115] foreach_1.5.2                            ## [116] svglite_2.1.0                            ## [117] bslib_0.3.1                              ## [118] webshot_0.5.3                            ## [119] XVector_0.34.0                           ## [120] prodlim_2019.11.13                       ## [121] rvest_1.0.2                              ## [122] stringr_1.4.0                            ## [123] VariantAnnotation_1.40.0                 ## [124] digest_0.6.29                            ## [125] graph_1.72.0                             ## [126] httpcode_0.3.0                           ## [127] Biostrings_2.62.0                        ## [128] rmarkdown_2.14                           ## [129] harmonicmeanp_3.0                        ## [130] restfulr_0.0.13                          ## [131] curl_4.3.2                               ## [132] Rsamtools_2.10.0                         ## [133] rjson_0.2.21                             ## [134] tseries_0.10-51                          ## [135] lifecycle_1.0.1                          ## [136] jsonlite_1.8.0                           ## [137] survivalROC_1.0.3                        ## [138] desc_1.4.1                               ## [139] viridisLite_0.4.0                        ## [140] BSgenome_1.62.0                          ## [141] fansi_1.0.3                              ## [142] pillar_1.7.0                             ## [143] lattice_0.20-45                          ## [144] DEoptimR_1.0-11                          ## [145] KEGGREST_1.34.0                          ## [146] fastmap_1.1.0                            ## [147] httr_1.4.3                               ## [148] GO.db_3.14.0                             ## [149] xts_0.12.1                               ## [150] glue_1.6.2                               ## [151] zip_2.2.0                                ## [152] SNPlocs.Hsapiens.dbSNP151.GRCh38_0.99.20 ## [153] png_0.1-7                                ## [154] iterators_1.0.14                         ## [155] pander_0.6.5                             ## [156] glmnet_4.1-4                             ## [157] bit_4.0.4                                ## [158] stringi_1.7.6                            ## [159] sass_0.4.1                               ## [160] bootstrap_2019.6                         ## [161] blob_1.2.3                               ## [162] statgenGWAS_1.0.8                        ## [163] textshaping_0.3.6                        ## [164] org.Hs.eg.db_3.14.0                      ## [165] memoise_2.0.1                            ## [166] FMStable_0.1-2                           ## [167] dplyr_1.0.8                              ## [168] future.apply_1.9.0"},{"path":"/articles/08-pipelines.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Complete PRISMA pipelines","text":"Although individual steps PRS extraction process can performed stepwise manner, PRISMA designed offer complete RPS extraction pipelines evaulation related visualizations. results iterative PRS extraction well evaluation metrics reports registered object alltogether facilitates reporting. easily possible using individual steps. addition, whole process involves many complex steps inclusion external software, may prone crashes. pipelines implement several checkpoints can used restart pipeline crash point (). Furthermore, pipeline wrapper iteratively executes selected pipeline finished. main steps implemented PRISMA pipelines offer end--end PRS extraction pipeline : Preparation main total dataset consisting basic quaility control filtering missing genotype imputation. Optionally, holding-completely independent object used evaluation. Splitting main GWASExperiment base (training) object used summary statistics target (test) object used PRS extraction evaluation. Quality control base object, essentially filtering SNPs small MAF possibly violating HWE dataset splitting. sample filtering also possible. PCA optionally performed base target objects. Calculation summary statistics many available methods using base object. Derivation PRS using summary statistics (2c) target object, one available methods. Aggregation SNPs suggested iterative PRS extraction process summarization SNP effects, followed semi-automatic selection best PRS candidates. Evaluation PRS candidates using total dataset /optionally independent testing samples held-. step, externally retrieved PRS (e.g. PGS Catalog) can plugged evaluation. Lookup SNPs included final PRS candidates annotate online resources known traits (GWAS Catalog) followed reporting selection final PRS. main PRISMA pipeline depicted following figure:","code":""},{"path":"/articles/08-pipelines.html","id":"prisma-pipelines","dir":"Articles","previous_headings":"","what":"PRISMA pipelines","title":"Complete PRISMA pipelines","text":"heart PRISMA pipelines main prisma() wrapper, along functions implement steps prsPipeline(), prsSelection(), selectPrs() validation functions prismaCrossValidate(). Parallelization implemented wherever possible. following subsections present different PRISMA pipelines implement PRS extraction evaluation steps outlined .","code":""},{"path":"/articles/08-pipelines.html","id":"de-novo-prs-derivation-pipeline","dir":"Articles","previous_headings":"PRISMA pipelines","what":"De novo PRS derivation pipeline","title":"Complete PRISMA pipelines","text":"main PRS candidate extraction pipeline performs following steps: 1. Split input data object usually larger training set smaller independent test set. 2. De novo quality control training test sets well optional PCA training set capture local population structure used covariates subsequent GWA tests. 3. Execution GWA tests phenotype using one supported methods extract summary statistics (SNP effects p-values). 4. Execution one PRS extraction algorithms derive PRS candidate SNPs. Steps (1) – (4) executed N times different training test sets capture much variation selection process possible. Subsequently: candidate SNPs PRSs extracted iteration aggregated frequency appearance recorded. time, new effects calculated either averaging SNP effects iteration, statistically valid process generally corrects overfitting, weighted averaging effects based performance PRSs constructed iteration (measured adjusted PRS R2 returned PRSice2). , prsPipeline() produces list either GWASExperiment objects prsbetas effects summary lists, holding genotypic data saving memory space. list practically hold derived PRSs iteration, prsbetas slot. Now, aggregate outcome pool SNPs evaluated PRS candidates:","code":"library(prisma)  data(toy,package=\"prisma\") gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Lose filters for the toy dataset filts <- getDefaults(\"filters\") filts$IBD <- NA filts$hwe <- 1e-3 filts$pcaOut <- FALSE filts$inbreed <- NA  # Traits response <- \"BMI\" covariates <- c(\"Case_Control\",\"Gender\",\"Age\")  d1 <- tempfile() wspace1 <- file.path(tempdir(),d1) if (Sys.which(\"PRSice_linux\") != \"\") {     dnList <- prsPipeline(         gwe=toy,         phenotype=response,         covariates=covariates,         pcs=FALSE,         trainSize=0.8,         niter=4,         filters=filts,         pcaMethod=\"snprel\",         imputeMissing=FALSE,         gwaMethods=\"statgen\",         prsiceOpts=list(clump_p=0.75,perm=100),         prsWorkspace=wspace1,         cleanup=\"intermediate\",         logging=\"file\",         rc=0.25     ) } ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb ##  ## Input ## -------------------------------------------------------------------- ## Input pipeline list (dnList) : a list of PRS pipeline summaries ## Input dataset object (gwe)   : a GWASExperiment object with 1000 markers (SNPs) and 100 samples ##  ## Regression parameters ## -------------------------------------------------------------------- ## Phenotypic response (phenotype)          : BMI ## Regression covariates (covariates)       : Case_Control, Gender, Age ## Principal Components in covariates (pcs) : No ## Number of Principal Components (npcs)    : - ##  ## Preprocessing options ## -------------------------------------------------------------------- ## Sample and genotype filtering options (filters)     : ##   snpCallRate    : 0.98 ##   sampleCallRate : 0.95 ##   maf            : 0.05 ##   hwe            : 0.001 ##   heteroStat     : median ##   heteroFac      : 3 ##   heteroHard     : NA ##   pcaOut         : No ##   pcaRobust      : hubert ##   nPC            : NA ##   LD             : 0.2 ##   IBD            : NA ##   inbreed        : NA ## Principal Components calculation method (pcaMethod) : snprel ## Impute missing genotypes (imputeMissing)            : No ## Missing genotype imputation method (imputeMethod)   : single ##  ## GWA analysis options ## -------------------------------------------------------------------- ## Genome-Wide Association tests (gwaMethods)        : statgen ## Association tests combination method (gwaCombine) : fisher ## Association tests options                         : ##   statgen : ##     kinship : astle ##     reml    : EMMA ##     gls     : single ##  ## PRS candidate extraction options ## -------------------------------------------------------------------- ## PRS extraction algorithms (prsMethods) : lassosum, prsice ## PRS algorithms options (prsMethods)    : ##   lassosum : ##     anc   : eur ##     valid : auto ##   prsice : ##     clump_kb : 250 ##     clump_r2 : 0.1 ##     clump_p  : 0.75 ##     score    : avg ##     perm     : 100 ##     seed     : 42 ##  ## PRS construction and evaluation options ## -------------------------------------------------------------------- ## Training set size (trainSize)              : 80% ## Number of PRS selection iterations (niter) : 4 ## PRS evaluation framework (evalWith)        : vanilla ##  ## Miscellaneous options ## -------------------------------------------------------------------- ## Local workspace directory (prsWorkspace) : /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb ## Cleanup level (cleanup)                  : intermediate ## Output type (output)                     : gwaslist ## Run ID (runId)                           : BMZTOMTPDRR1884P ## Available cores fraction (rc)            : single core ##  ## Executing denovo pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_iter_1.log ## ================================================================ ## -----> Denovo pipeline iteration 1 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 115 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 140 ##   Hardy-Weinberg equilibrium: 0 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 26 associations (uncorrected p-values). ##  ## Overall, found 26 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 16 associations (uncorrected p-values). ##  ## Overall, found 16 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 26 associations found out of 568 markers ##   Part 21: 16 associations found out of 317 markers ##  ## Overall, found 42 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0989753394761947 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1/base_UCAKX1570P \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1/pheno_UCAKX1570P \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1/plink_prsice_UCAKX1570P \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1/covar_UCAKX1570P \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_UCAKX1570P \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.146245 ## Full model R^2 is: 0.536041 ## Null model R^2 is: 0.389796 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_1/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_iter_2.log ## ================================================================ ## -----> Denovo pipeline iteration 2 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 120 ##   Hardy-Weinberg equilibrium: 4 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 126 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 20 associations (uncorrected p-values). ##  ## Overall, found 20 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 14 associations (uncorrected p-values). ##  ## Overall, found 14 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 20 associations found out of 561 markers ##   Part 21: 14 associations found out of 316 markers ##  ## Overall, found 34 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0134963836336277 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2/base_OJFLA5770B \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2/pheno_OJFLA5770B \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2/plink_prsice_OJFLA5770B \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2/covar_OJFLA5770B \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_OJFLA5770B \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0757643 ## Full model R^2 is: 0.522307 ## Null model R^2 is: 0.446543 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_2/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_iter_3.log ## ================================================================ ## -----> Denovo pipeline iteration 3 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 117 ##   Hardy-Weinberg equilibrium: 3 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 128 ##   Hardy-Weinberg equilibrium: 0 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 24 associations (uncorrected p-values). ##  ## Overall, found 24 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 8 associations (uncorrected p-values). ##  ## Overall, found 8 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 24 associations found out of 565 markers ##   Part 21: 8 associations found out of 316 markers ##  ## Overall, found 32 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.239639787479868 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3/base_NMTHE3239D \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3/pheno_NMTHE3239D \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3/plink_prsice_NMTHE3239D \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3/covar_NMTHE3239D \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_NMTHE3239D \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.211827 ## Full model R^2 is: 0.725906 ## Null model R^2 is: 0.514079 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_3/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_iter_4.log ## ================================================================ ## -----> Denovo pipeline iteration 4 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 116 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 131 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 25 associations (uncorrected p-values). ##  ## Overall, found 25 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 18 associations (uncorrected p-values). ##  ## Overall, found 18 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 25 associations found out of 568 markers ##   Part 21: 18 associations found out of 315 markers ##  ## Overall, found 43 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.051497824912531 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4/base_OIUUN3119V \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4/pheno_OIUUN3119V \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4/plink_prsice_OIUUN3119V \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4/covar_OIUUN3119V \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_OIUUN3119V \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.112167 ## Full model R^2 is: 0.402024 ## Null model R^2 is: 0.289857 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb/BMZTOMTPDRR1884P_denovo_4/denovo_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712629005eb snpSummary <- aggregatePrsMarkers(dnList,mode=\"intersect\",qcut=0) ## Aggregation mode: intersect ##   iteration 1 yields 5 markers ##   iteration 2 yields 12 markers ##   iteration 3 yields 4 markers ##   iteration 4 yields 1 markers ## Calculating frequencies ## Averaging effects with mean ## Constructing output ## Done!  head(snpSummary) ##                   snp freq    effect ## rs7280065   rs7280065    3  2.244304 ## rs1740090   rs1740090    2 -1.722034 ## rs508857     rs508857    2  1.848556 ## rs8093690   rs8093690    2 -1.584823 ## rs1116852   rs1116852    1  1.309206 ## rs11876399 rs11876399    1  1.257282"},{"path":"/articles/08-pipelines.html","id":"prs-evaluation-pipeline-based-on-the-original-traintest-split-with-prsice2","dir":"Articles","previous_headings":"PRISMA pipelines","what":"PRS evaluation pipeline based on the original train/test split with PRSice2","title":"Complete PRISMA pipelines","text":"pipeline similar de novo PRS evaluation pipeline uses initial train/test split described PRS evaluation. steps similar described evaluation performed PRSice2 framework, limiting somehow available model evaluation metrics. Also, averaged SNP effects used. example , provide PRS candidate (snpSelection argument) based previous example, SNPs appearing 1 time. also request evaluation performed split set (useDenovoWorkspace argument). argument list data frames containing elegant format SNPs snpSelection. Since requested evaluation PRSice2, data frame list attributes attached , summarizing evaluation: PR2 attribute contains PRsice2 evalutation metrics identical two outputs refer different dataset splits training testing. metrics properly gathered returned prsSelection() function.","code":"snpSelection <- snpSummary[snpSummary$freq>1,]  d2 <- tempfile() wspace2 <- file.path(tempdir(),d2) if (Sys.which(\"PRSice_linux\") != \"\") {     out <- prsPipeline(         gwe=toy,         phenotype=response,         covariates=covariates,         pcs=FALSE,         trainSize=0.8,         niter=4,         filters=filts,         pcaMethod=\"snprel\",         imputeMissing=FALSE,         snpSelection=snpSelection,         gwaMethods=\"statgen\",         prsiceOpts=list(clump_p=0.75,perm=100),         prsWorkspace=wspace2,         cleanup=\"intermediate\",         logging=\"file\",         evalWith=\"prsice\",         useDenovoWorkspace=dnList,         rc=0.25     ) } ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b ##  ## Input ## -------------------------------------------------------------------- ## Input pipeline list (dnList) : a list of PRS pipeline summaries ## Input dataset object (gwe)   : a GWASExperiment object with 1000 markers (SNPs) and 100 samples ##  ## Regression parameters ## -------------------------------------------------------------------- ## Phenotypic response (phenotype)          : BMI ## Regression covariates (covariates)       : Case_Control, Gender, Age ## Principal Components in covariates (pcs) : No ## Number of Principal Components (npcs)    : - ##  ## Preprocessing options ## -------------------------------------------------------------------- ## Sample and genotype filtering options (filters)     : ##   snpCallRate    : 0.98 ##   sampleCallRate : 0.95 ##   maf            : 0.05 ##   hwe            : 0.001 ##   heteroStat     : median ##   heteroFac      : 3 ##   heteroHard     : NA ##   pcaOut         : No ##   pcaRobust      : hubert ##   nPC            : NA ##   LD             : 0.2 ##   IBD            : NA ##   inbreed        : NA ## Principal Components calculation method (pcaMethod) : snprel ## Impute missing genotypes (imputeMissing)            : No ## Missing genotype imputation method (imputeMethod)   : single ##  ## GWA analysis options ## -------------------------------------------------------------------- ## Genome-Wide Association tests (gwaMethods)        : statgen ## Association tests combination method (gwaCombine) : fisher ## Association tests options                         : ##   statgen : ##     kinship : astle ##     reml    : EMMA ##     gls     : single ##  ## PRS candidate extraction options ## -------------------------------------------------------------------- ## PRS extraction algorithms (prsMethods) : lassosum, prsice ## PRS algorithms options (prsMethods)    : ##   lassosum : ##     anc   : eur ##     valid : auto ##   prsice : ##     clump_kb : 250 ##     clump_r2 : 0.1 ##     clump_p  : 0.75 ##     score    : avg ##     perm     : 100 ##     seed     : 42 ##  ## PRS construction and evaluation options ## -------------------------------------------------------------------- ## Training set size (trainSize)              : 80% ## Number of PRS selection iterations (niter) : 4 ## PRS evaluation framework (evalWith)        : prsice ## Provided candidate SNPs for PRS            : 4 SNPs ##  ## Miscellaneous options ## -------------------------------------------------------------------- ## Local workspace directory (prsWorkspace) : /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b ## Cleanup level (cleanup)                  : intermediate ## Output type (output)                     : summaries ## Run ID (runId)                           : KWNGRQNTOIR3907S ## Available cores fraction (rc)            : single core ## ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## ----- PRS analysis with base and target ----- ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_1 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_1 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in apply mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_1/base_UCCPR7941Y \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_1/pheno_UCCPR7941Y \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_1/plink_prsice_UCCPR7941Y \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_1/covar_UCCPR7941Y \\ ##   --no-clump \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_UCCPR7941Y \\ ##   --print-snp \\ ##   --bar-levels 1 \\ ##   --fastscore ## Done! ## Adjusted PRSice R^2 is: 0.149273 ## Full model R^2 is: 0.539069 ## Null model R^2 is: 0.389796 ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## ----- PRS analysis with base and target ----- ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_2 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_2 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in apply mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_2/base_IDHPX7552J \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_2/pheno_IDHPX7552J \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_2/plink_prsice_IDHPX7552J \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_2/covar_IDHPX7552J \\ ##   --no-clump \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_IDHPX7552J \\ ##   --print-snp \\ ##   --bar-levels 1 \\ ##   --fastscore ## Done! ## Adjusted PRSice R^2 is: 0.0521869 ## Full model R^2 is: 0.49873 ## Null model R^2 is: 0.446543 ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## ----- PRS analysis with base and target ----- ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_3 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_3 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in apply mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_3/base_LRION8013G \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_3/pheno_LRION8013G \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_3/plink_prsice_LRION8013G \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_3/covar_LRION8013G \\ ##   --no-clump \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_LRION8013G \\ ##   --print-snp \\ ##   --bar-levels 1 \\ ##   --fastscore ## Done! ## Adjusted PRSice R^2 is: 0.163701 ## Full model R^2 is: 0.677779 ## Null model R^2 is: 0.514079 ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## ----- PRS analysis with base and target ----- ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_4 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_4 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in apply mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_4/base_GHFAQ7306Z \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_4/pheno_GHFAQ7306Z \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_4/plink_prsice_GHFAQ7306Z \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_4/covar_GHFAQ7306Z \\ ##   --no-clump \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_GHFAQ7306Z \\ ##   --print-snp \\ ##   --bar-levels 1 \\ ##   --fastscore ## Done! ## Adjusted PRSice R^2 is: 0.229789 ## Full model R^2 is: 0.519645 ## Null model R^2 is: 0.289857 ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b attributes(out[[1]]) ## $names ## [1] \"chromosome\"       \"position\"         \"variant_id\"       \"risk_allele\"      ## [5] \"reference_allele\" \"locus_name\"       \"effect_weight\"    \"OR\"               ## [9] \"asm\"              ##  ## $row.names ## [1] \"rs7280065\" \"rs1740090\" \"rs508857\"  \"rs8093690\" ##  ## $class ## [1] \"data.frame\" ##  ## $workspace ## [1] \"/tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571246c3a62b/KWNGRQNTOIR3907S_evaluate_1\" ##  ## $PR2 ##       r2m       r2n       r2p         p      nsnp  ## 0.5390690 0.3897960 0.1492730 0.0394029 4.0000000  ##  ## $nsnp ## [1] 4 identical(attr(out[[1]],\"PR2\"),attr(out[[2]],\"PR2\")) ## [1] FALSE"},{"path":"/articles/08-pipelines.html","id":"prs-evaluation-pipeline-based-on-the-original-traintest-split-with-r","dir":"Articles","previous_headings":"PRISMA pipelines","what":"PRS evaluation pipeline based on the original train/test split with R","title":"Complete PRISMA pipelines","text":", pipeline similar one described time evaluation done native R functions (manual PRS construction outside PRSice2 followed GLM regressions). fastest evaluation pipeline allows collection many additional metrics. change evalWith argument \"vanilla\" also default. time list data frames collected evaluation metrics. described detail respective man pages. metrics properly gathered returned prsSelection() function.","code":"snpSelection <- snpSummary[snpSummary$freq>1,]  d3 <- tempfile() wspace3 <- file.path(tempdir(),d3)  out <- prsPipeline(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     snpSelection=snpSelection,     gwaMethods=\"statgen\",     prsWorkspace=wspace3,     cleanup=\"intermediate\",     logging=\"file\",     evalWith=\"vanilla\",     useDenovoWorkspace=dnList,     rc=0.25 ) ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab ##  ## Input ## -------------------------------------------------------------------- ## Input pipeline list (dnList) : a list of PRS pipeline summaries ## Input dataset object (gwe)   : a GWASExperiment object with 1000 markers (SNPs) and 100 samples ##  ## Regression parameters ## -------------------------------------------------------------------- ## Phenotypic response (phenotype)          : BMI ## Regression covariates (covariates)       : Case_Control, Gender, Age ## Principal Components in covariates (pcs) : No ## Number of Principal Components (npcs)    : - ##  ## Preprocessing options ## -------------------------------------------------------------------- ## Sample and genotype filtering options (filters)     : ##   snpCallRate    : 0.98 ##   sampleCallRate : 0.95 ##   maf            : 0.05 ##   hwe            : 0.001 ##   heteroStat     : median ##   heteroFac      : 3 ##   heteroHard     : NA ##   pcaOut         : No ##   pcaRobust      : hubert ##   nPC            : NA ##   LD             : 0.2 ##   IBD            : NA ##   inbreed        : NA ## Principal Components calculation method (pcaMethod) : snprel ## Impute missing genotypes (imputeMissing)            : No ## Missing genotype imputation method (imputeMethod)   : single ##  ## GWA analysis options ## -------------------------------------------------------------------- ## Genome-Wide Association tests (gwaMethods)        : statgen ## Association tests combination method (gwaCombine) : fisher ## Association tests options                         : ##   statgen : ##     kinship : astle ##     reml    : EMMA ##     gls     : single ##  ## PRS candidate extraction options ## -------------------------------------------------------------------- ## PRS extraction algorithms (prsMethods) : lassosum, prsice ## PRS algorithms options (prsMethods)    : ##   lassosum : ##     anc   : eur ##     valid : auto ##   prsice : ##     clump_kb : 250 ##     clump_r2 : 0.1 ##     clump_p  : 1 ##     score    : avg ##     perm     : 10000 ##     seed     : 42 ##  ## PRS construction and evaluation options ## -------------------------------------------------------------------- ## Training set size (trainSize)              : 80% ## Number of PRS selection iterations (niter) : 4 ## PRS evaluation framework (evalWith)        : vanilla ## Provided candidate SNPs for PRS            : 4 SNPs ##  ## Miscellaneous options ## -------------------------------------------------------------------- ## Local workspace directory (prsWorkspace) : /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab ## Cleanup level (cleanup)                  : intermediate ## Output type (output)                     : summaries ## Run ID (runId)                           : BUDJZRQKMQY4983I ## Available cores fraction (rc)            : single core ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/BUDJZRQKMQY4983I_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs7280065 to rs8093690 ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/BUDJZRQKMQY4983I_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/BUDJZRQKMQY4983I_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs7280065 to rs8093690 ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/BUDJZRQKMQY4983I_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/BUDJZRQKMQY4983I_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs7280065 to rs8093690 ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/BUDJZRQKMQY4983I_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/BUDJZRQKMQY4983I_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs7280065 to rs8093690 ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/BUDJZRQKMQY4983I_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab m <- do.call(\"rbind\",out)  m ##   n_snp freq   full_r2  full_pvalue   prs_pvalue full_aic reduced_r2    prs_r2 ## 1     4    2 0.7795969 8.121402e-05 0.0001184494 101.8917  0.3897956 0.3898013 ## 2     4    2 0.6055933 5.167073e-03 0.0265428497 111.5929  0.4465427 0.1590506 ## 3     4    2 0.6752463 1.316556e-03 0.0155469286 114.8252  0.5140786 0.1611677 ## 4     4    2 0.5074255 2.372987e-02 0.0211656825 108.6812  0.2898568 0.2175687 ##   reduced_pvalue reduced_aic    prs_aic ## 1    0.043321664    120.2584 -18.366719 ## 2    0.020920437    116.3690  -4.776040 ## 3    0.007814546    120.8848  -6.059599 ## 4    0.130580986    113.9976  -5.316418"},{"path":"/articles/08-pipelines.html","id":"de-novo-prs-evaluation-pipeline","dir":"Articles","previous_headings":"PRISMA pipelines","what":"De novo PRS evaluation pipeline","title":"Complete PRISMA pipelines","text":"evaluation pipeline differs two creates new dataset split related preprocessing thus taking much time two. See also Introduction vignette details process. controlled lack useDenovoWorkspace argument useDenovoWorkspace=NULL. Evaluation done PRSice2 resulting list data frames attributes . evaluation metrics properly gathered returned prsSelection() function.","code":"snpSelection <- snpSummary[snpSummary$freq>1,]  d4 <- tempfile() wspace4 <- file.path(tempdir(),d4)  if (Sys.which(\"PRSice_linux\") != \"\") {     out <- prsPipeline(         gwe=toy,         phenotype=response,         covariates=covariates,         pcs=FALSE,         trainSize=0.8,         niter=4,         filters=filts,         pcaMethod=\"snprel\",         imputeMissing=FALSE,         snpSelection=snpSelection,         gwaMethods=\"statgen\",         prsiceOpts=list(clump_p=0.75,perm=100),         prsWorkspace=wspace3,         cleanup=\"intermediate\",         logging=\"file\",         rc=0.25     ) } ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab ##  ## Input ## -------------------------------------------------------------------- ## Input pipeline list (dnList) : a list of PRS pipeline summaries ## Input dataset object (gwe)   : a GWASExperiment object with 1000 markers (SNPs) and 100 samples ##  ## Regression parameters ## -------------------------------------------------------------------- ## Phenotypic response (phenotype)          : BMI ## Regression covariates (covariates)       : Case_Control, Gender, Age ## Principal Components in covariates (pcs) : No ## Number of Principal Components (npcs)    : - ##  ## Preprocessing options ## -------------------------------------------------------------------- ## Sample and genotype filtering options (filters)     : ##   snpCallRate    : 0.98 ##   sampleCallRate : 0.95 ##   maf            : 0.05 ##   hwe            : 0.001 ##   heteroStat     : median ##   heteroFac      : 3 ##   heteroHard     : NA ##   pcaOut         : No ##   pcaRobust      : hubert ##   nPC            : NA ##   LD             : 0.2 ##   IBD            : NA ##   inbreed        : NA ## Principal Components calculation method (pcaMethod) : snprel ## Impute missing genotypes (imputeMissing)            : No ## Missing genotype imputation method (imputeMethod)   : single ##  ## GWA analysis options ## -------------------------------------------------------------------- ## Genome-Wide Association tests (gwaMethods)        : statgen ## Association tests combination method (gwaCombine) : fisher ## Association tests options                         : ##   statgen : ##     kinship : astle ##     reml    : EMMA ##     gls     : single ##  ## PRS candidate extraction options ## -------------------------------------------------------------------- ## PRS extraction algorithms (prsMethods) : lassosum, prsice ## PRS algorithms options (prsMethods)    : ##   lassosum : ##     anc   : eur ##     valid : auto ##   prsice : ##     clump_kb : 250 ##     clump_r2 : 0.1 ##     clump_p  : 0.75 ##     score    : avg ##     perm     : 100 ##     seed     : 42 ##  ## PRS construction and evaluation options ## -------------------------------------------------------------------- ## Training set size (trainSize)              : 80% ## Number of PRS selection iterations (niter) : 4 ## PRS evaluation framework (evalWith)        : vanilla ## Provided candidate SNPs for PRS            : 4 SNPs ##  ## Miscellaneous options ## -------------------------------------------------------------------- ## Local workspace directory (prsWorkspace) : /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab ## Cleanup level (cleanup)                  : intermediate ## Output type (output)                     : summaries ## Run ID (runId)                           : YEPDKJOVJQV5989C ## Available cores fraction (rc)            : single core ##  ## Executing external pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_iter_1.log ## ================================================================ ## -----> External pipeline iteration 1 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 124 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 121 ##   Hardy-Weinberg equilibrium: 4 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Base GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 15 associations (uncorrected p-values). ##  ## Overall, found 15 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 11 associations (uncorrected p-values). ##  ## Overall, found 11 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 15 associations found out of 563 markers ##   Part 21: 11 associations found out of 313 markers ##  ## Overall, found 26 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_1 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_1 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in apply mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_1/base_AUSMM3508D \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_1/pheno_AUSMM3508D \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_1/plink_prsice_AUSMM3508D \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_1/covar_AUSMM3508D \\ ##   --no-clump \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_AUSMM3508D \\ ##   --print-snp \\ ##   --bar-levels 1 \\ ##   --fastscore ## Done! ## Adjusted PRSice R^2 is: 0.0423798 ## Full model R^2 is: 0.62272 ## Null model R^2 is: 0.58034 ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_1/external_result.RData----- ## ================================================================ ## Executing external pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_iter_2.log ## ================================================================ ## -----> External pipeline iteration 2 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 120 ##   Hardy-Weinberg equilibrium: 3 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 116 ##   Hardy-Weinberg equilibrium: 5 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Base GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 18 associations (uncorrected p-values). ##  ## Overall, found 18 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 13 associations (uncorrected p-values). ##  ## Overall, found 13 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 18 associations found out of 565 markers ##   Part 21: 13 associations found out of 314 markers ##  ## Overall, found 31 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_2 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_2 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in apply mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_2/base_GPKGU3211V \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_2/pheno_GPKGU3211V \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_2/plink_prsice_GPKGU3211V \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_2/covar_GPKGU3211V \\ ##   --no-clump \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_GPKGU3211V \\ ##   --print-snp \\ ##   --bar-levels 1 \\ ##   --fastscore ## Done! ## Adjusted PRSice R^2 is: 0.248489 ## Full model R^2 is: 0.49637 ## Null model R^2 is: 0.24788 ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_2/external_result.RData----- ## ================================================================ ## Executing external pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_iter_3.log ## ================================================================ ## -----> External pipeline iteration 3 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 121 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 128 ##   Hardy-Weinberg equilibrium: 3 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 1 ##   Inbreed                   : 0 ##  ##  ## ----- Base GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 23 associations (uncorrected p-values). ##  ## Overall, found 23 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 12 associations (uncorrected p-values). ##  ## Overall, found 12 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 23 associations found out of 563 markers ##   Part 21: 12 associations found out of 315 markers ##  ## Overall, found 35 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_3 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_3 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in apply mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_3/base_VVTVP6399D \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_3/pheno_VVTVP6399D \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_3/plink_prsice_VVTVP6399D \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_3/covar_VVTVP6399D \\ ##   --no-clump \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_VVTVP6399D \\ ##   --print-snp \\ ##   --bar-levels 1 \\ ##   --fastscore ## Done! ## Adjusted PRSice R^2 is: 0.323309 ## Full model R^2 is: 0.632643 ## Null model R^2 is: 0.309334 ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_3/external_result.RData----- ## ================================================================ ## Executing external pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_iter_4.log ## ================================================================ ## -----> External pipeline iteration 4 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 124 ##   Hardy-Weinberg equilibrium: 0 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 122 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Base GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 18 associations (uncorrected p-values). ##  ## Overall, found 18 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 15 associations (uncorrected p-values). ##  ## Overall, found 15 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 18 associations found out of 565 markers ##   Part 21: 15 associations found out of 311 markers ##  ## Overall, found 33 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_4 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_4 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in apply mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_4/base_ARZEX5366S \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_4/pheno_ARZEX5366S \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_4/plink_prsice_ARZEX5366S \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_4/covar_ARZEX5366S \\ ##   --no-clump \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_ARZEX5366S \\ ##   --print-snp \\ ##   --bar-levels 1 \\ ##   --fastscore ## Done! ## Adjusted PRSice R^2 is: 0.0514528 ## Full model R^2 is: 0.606365 ## Null model R^2 is: 0.554913 ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab/YEPDKJOVJQV5989C_external_4/external_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712675d11ab"},{"path":"/articles/08-pipelines.html","id":"wrapping-the-evaluation-process-with-prsselection","dir":"Articles","previous_headings":"PRISMA pipelines","what":"Wrapping the evaluation process with prsSelection()","title":"Complete PRISMA pipelines","text":"mentioned, PRISMA tries select best PRS candidates subsetting aggregated SNPs iteratively evaluating. precisely prsSelection() function responsible following: Fixed quantiles frequency distribution (e.g. 10%, 20%, 30%, 40%, 50%, 60%, 75%, 80%, 90%, 95%, 99%). stepwise set creation process based frequency appearance, .e. set contains SNPs appear 5, 6, … maximum number appearances. set created (1), run evaluation pipeline collect evaluation metrics format proper downstream analysis. evalMetrics list contents used subsequent selectPrs() function: candidates variable list candidate PRSs.","code":"d5 <- tempfile() wspace5 <- file.path(tempdir(),d5)  evalMetrics <- prsSelection(     dnList=dnList,     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=\"statgen\",     prsWorkspace=wspace5,     cleanup=\"intermediate\",     logging=\"file\",     output=\"summary\",     useDenovoWorkspace=dnList,     rc=0.25 ) ## Aggregation mode: intersect ##   iteration 1 yields 5 markers ##   iteration 2 yields 12 markers ##   iteration 3 yields 4 markers ##   iteration 4 yields 1 markers ## Calculating frequencies ## Averaging effects with mean ## Constructing output ## Done! ##  ## Input ## -------------------------------------------------------------------- ## Input object (gwe) : a GWASExperiment object with 1000 markers (SNPs) and 100 samples ##  ## Regression parameters ## -------------------------------------------------------------------- ## Phenotypic response (phenotype)          : BMI ## Regression covariates (covariates)       : Case_Control, Gender, Age ## Principal Components in covariates (pcs) : No ## Number of Principal Components (npcs)    : - ##  ## Preprocessing options ## -------------------------------------------------------------------- ## Sample and genotype filtering options (filters)     : ##   snpCallRate    : 0.98 ##   sampleCallRate : 0.95 ##   maf            : 0.05 ##   hwe            : 0.001 ##   heteroStat     : median ##   heteroFac      : 3 ##   heteroHard     : NA ##   pcaOut         : No ##   pcaRobust      : hubert ##   nPC            : NA ##   LD             : 0.2 ##   IBD            : NA ##   inbreed        : NA ## Principal Components calculation method (pcaMethod) : snprel ## Impute missing genotypes (imputeMissing)            : No ## Missing genotype imputation method (imputeMethod)   : single ##  ## GWA analysis options ## -------------------------------------------------------------------- ## Genome-Wide Association tests (gwaMethods)        : statgen ## Association tests combination method (gwaCombine) : simes ## Association tests options                         : ##   statgen : ##     kinship : astle ##     reml    : EMMA ##     gls     : single ##  ## PRS candidate extraction options ## -------------------------------------------------------------------- ## PRS extraction algorithms (prsMethods) : lassosum, prsice ## PRS algorithms options (prsMethods)    : ##   lassosum : ##     anc   : eur ##     valid : auto ##   prsice : ##     clump_kb : 250 ##     clump_r2 : 0.1 ##     clump_p  : 1 ##     score    : avg ##     perm     : 10000 ##     seed     : 42 ##  ## PRS construction and evaluation options ## -------------------------------------------------------------------- ## Training set size (trainSize)                               : 80% ## Number of PRS selection iterations (niter)                  : 4 ## PRS selection resolution method (resolution)                : frequency ## PRS selection resolution step (step)                        : 1 ## Minimum SNP frequency in PRS (minFreq)                      : 2 ## Minimum number of SNPs in PRS (minSnps)                     : 2 ## Drop quantiles with same number of SNPs (dropSameQuantiles) : Yes ## PRS aggregation method (aggregation)                        : intersection ## SNP effect summarization method (effectWeight)              : mean ## PRS evaluation framework (evalWith)                         : vanilla ##  ## Miscellaneous options ## -------------------------------------------------------------------- ## Local workspace directory (prsWorkspace) : /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f ## Cleanup level (cleanup)                  : intermediate ## Output type (output)                     : summary ## Run ID (runId)                           : auto ## Available cores fraction (rc)            : 25% ##  ## ================================================================ ## -----> Frequency 2 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2/2_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs7280065 to rs8093690 ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2/2_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2/2_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs7280065 to rs8093690 ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2/2_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2/2_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs7280065 to rs8093690 ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2/2_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2/2_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs7280065 to rs8093690 ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2/2_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file5712484ac70f/2 candidates <- selectPrs(     metrics=evalMetrics$metrics,     snpSelection=evalMetrics$pgs,     gwe=toy,     base=evalMetrics$baseline ) ## The optimal number of markers for PRS based on prs_r2 is 4 at prs_r2=0.2319 head(candidates[[1]]) ##           chromosome position variant_id risk_allele reference_allele ## rs7280065         21 24827764  rs7280065           G                A ## rs1740090         21 23258743  rs1740090           G                A ## rs508857          18  2101958   rs508857           A                G ## rs8093690         18  5852696  rs8093690           A                G ##           locus_name effect_weight        OR  asm freq ## rs7280065         NA      2.244304 9.4338448 hg19    3 ## rs1740090         NA     -1.722034 0.1787023 hg19    2 ## rs508857          NA      1.848556 6.3506429 hg19    2 ## rs8093690         NA     -1.584823 0.2049842 hg19    2"},{"path":"/articles/08-pipelines.html","id":"wrapping-the-whole-process-with-the-prisma-function","dir":"Articles","previous_headings":"PRISMA pipelines","what":"Wrapping the whole process with the prisma() function","title":"Complete PRISMA pipelines","text":"aforementioned processes can executed prisma() function. output list object PRS candidates evaluatiom metrics fed cross-validation, lookup reporting procedures.","code":"# Workspace d6 <- tempfile() wspace6 <- file.path(tempdir(),d6)  # Complete 4-iteration PRS pipeline - ~1 min to run with 4 cores - no PCA if (Sys.which(\"PRSice_linux\") != \"\") {     prismaOut <- prisma(         gwe=toy,         phenotype=response,         covariates=covariates,         pcs=FALSE,         trainSize=0.8,         niter=4,         resolution=\"frequency\",         minSnps=2,         filters=filts,         pcaMethod=\"snprel\",         imputeMissing=FALSE,         gwaMethods=c(\"glm\",\"statgen\"),         prsiceOpts=list(clump_p=0.75,perm=100),         prsWorkspace=wspace6,         cleanup=\"intermediate\",         logging=\"file\",         output=\"normal\",         rc=0.25     ) } ##  ## 2022-06-06 20:42:01: Data processing started... ##  ## Input ## -------------------------------------------------------------------- ## Input object (gwe) : a GWASExperiment object with 1000 markers (SNPs) and 100 samples ##  ## Regression parameters ## -------------------------------------------------------------------- ## Phenotypic response (phenotype)          : BMI ## Regression covariates (covariates)       : Case_Control, Gender, Age ## Principal Components in covariates (pcs) : No ## Number of Principal Components (npcs)    : - ##  ## Preprocessing options ## -------------------------------------------------------------------- ## Sample and genotype filtering options (filters)     : ##   snpCallRate    : 0.98 ##   sampleCallRate : 0.95 ##   maf            : 0.05 ##   hwe            : 0.001 ##   heteroStat     : median ##   heteroFac      : 3 ##   heteroHard     : NA ##   pcaOut         : No ##   pcaRobust      : hubert ##   nPC            : NA ##   LD             : 0.2 ##   IBD            : NA ##   inbreed        : NA ## Principal Components calculation method (pcaMethod) : snprel ## Impute missing genotypes (imputeMissing)            : No ## Missing genotype imputation method (imputeMethod)   : singlesplit ##  ## GWA analysis options ## -------------------------------------------------------------------- ## Genome-Wide Association tests (gwaMethods)        : glm, statgen ## Association tests combination method (gwaCombine) : fishersimesmaxminharmonicwhitlockpandora ## Association tests options                         : ##   glm : ##     family : - ##     size   : 1 ##   statgen : ##     kinship : astle ##     reml    : EMMA ##     gls     : single ##  ## PRS candidate extraction options ## -------------------------------------------------------------------- ## PRS extraction algorithms (prsMethods) : lassosum, prsice ## PRS algorithms options (prsMethods)    : ##   lassosum : ##     anc   : eur ##     valid : auto ##   prsice : ##     clump_kb : 250 ##     clump_r2 : 0.1 ##     clump_p  : 0.75 ##     score    : avg ##     perm     : 100 ##     seed     : 42 ##  ## PRS construction and evaluation options ## -------------------------------------------------------------------- ## Training set size (trainSize)                               : 80% ## Number of PRS selection iterations (niter)                  : 4 ## PRS selection resolution method (resolution)                : frequency ## PRS selection resolution step (step)                        : 1 ## Minimum SNP frequency in PRS (minFreq)                      : 2 ## Minimum number of SNPs in PRS (minSnps)                     : 2 ## Drop quantiles with same number of SNPs (dropSameQuantiles) : Yes ## PRS aggregation method (aggregation)                        : intersectionunion ## SNP effect summarization method (effectWeight)              : meanmedianweight ## PRS evaluation framework (evalWith)                         : vanillaprscice ##  ## PRS selection options ## -------------------------------------------------------------------- ## PRS selection method (prsSelectMethod)           : maxima ## PRS selection criterion (prsSelectCrit)          : prs_r2 ## PRS criterion summarization (prsSelectStat)      : mean ## R^2 type if criterion includes R^2 (prsSelectR2) : adjusted ##  ## Miscellaneous options ## -------------------------------------------------------------------- ## Local workspace directory (prsWorkspace) : /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732 ## Cleanup level (cleanup)                  : intermediate ## PRS pipeline output type (dnOutput)      : normal ## Output level (output)                    : normal ## Run ID (runId)                           : auto ## Available cores fraction (rc)            : 25% ##  ## **************************************************************** ## Executing PRISMA pipeline with glm ## **************************************************************** ##  ## ################################################################ ## 1. Discovery of de novo PRS candidates ## ################################################################ ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline ##  ## Executing denovo pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_iter_1.log ## ================================================================ ## -----> Denovo pipeline iteration 1 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 118 ##   Hardy-Weinberg equilibrium: 7 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 123 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 22 associations (uncorrected p-values). ##  ## Overall, found 22 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 13 associations (uncorrected p-values). ##  ## Overall, found 13 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 22 associations found out of 562 markers ##   Part 21: 13 associations found out of 314 markers ##  ## Overall, found 35 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0918205401195086 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1/base_OUBBZ9922I \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1/pheno_OUBBZ9922I \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1/plink_prsice_OUBBZ9922I \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1/covar_OUBBZ9922I \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_OUBBZ9922I \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0227931 ## Full model R^2 is: 0.564344 ## Null model R^2 is: 0.541551 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_1/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_iter_2.log ## ================================================================ ## -----> Denovo pipeline iteration 2 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 121 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 129 ##   Hardy-Weinberg equilibrium: 4 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 21 associations (uncorrected p-values). ##  ## Overall, found 21 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 16 associations (uncorrected p-values). ##  ## Overall, found 16 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 21 associations found out of 565 markers ##   Part 21: 16 associations found out of 313 markers ##  ## Overall, found 37 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.00550588962775787 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2/base_EZEYE5111F \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2/pheno_EZEYE5111F \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2/plink_prsice_EZEYE5111F \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2/covar_EZEYE5111F \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_EZEYE5111F \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0335479 ## Full model R^2 is: 0.616724 ## Null model R^2 is: 0.583176 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_2/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_iter_3.log ## ================================================================ ## -----> Denovo pipeline iteration 3 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 123 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 129 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 31 associations (uncorrected p-values). ##  ## Overall, found 31 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 16 associations (uncorrected p-values). ##  ## Overall, found 16 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 31 associations found out of 561 markers ##   Part 21: 16 associations found out of 316 markers ##  ## Overall, found 47 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.091381660876217 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3/base_BZFQC4344E \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3/pheno_BZFQC4344E \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3/plink_prsice_BZFQC4344E \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3/covar_BZFQC4344E \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_BZFQC4344E \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.202402 ## Full model R^2 is: 0.71097 ## Null model R^2 is: 0.508567 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_3/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_iter_4.log ## ================================================================ ## -----> Denovo pipeline iteration 4 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 123 ##   Hardy-Weinberg equilibrium: 5 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 116 ##   Hardy-Weinberg equilibrium: 0 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 1 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: glm ##  ## ========== Analyzing chromosome/part 18 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs1009238 to rs1568327 ## Found 17 associations (uncorrected p-values). ##  ## Overall, found 17 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Performing GWAS with GLM over 1 chunks ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ##   testing SNPs from rs2824974 to rs2828316 ## Found 7 associations (uncorrected p-values). ##  ## Overall, found 7 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 17 associations found out of 563 markers ##   Part 21: 7 associations found out of 311 markers ##  ## Overall, found 24 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 19 out of 19 samples kept in pheno. ## 19 out of 19 samples kept in covar. ## Done! R^2 is: 0.0093590547949031 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4/base_EPPPB6188A \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4/pheno_EPPPB6188A \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4/plink_prsice_EPPPB6188A \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4/covar_EPPPB6188A \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_EPPPB6188A \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0760881 ## Full model R^2 is: 0.374845 ## Null model R^2 is: 0.298757 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline/HFQWUJUTWNU7200S_denovo_4/denovo_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/baseline ##  ## ################################################################ ## 2. Calculation of PRS evaluation metrics ## ################################################################ ## Aggregation mode: intersect ##   iteration 1 yields 30 markers ##   iteration 2 yields 1 markers ##   iteration 3 yields 25 markers ##   iteration 4 yields 10 markers ## Calculating frequencies ## Averaging effects with mean ## Constructing output ## Done! ##  ## ================================================================ ## -----> Frequency 2 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2/2_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1116852 to rs9977668 ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2/2_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2/2_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1116852 to rs9977668 ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2/2_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2/2_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1116852 to rs9977668 ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2/2_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2/2_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1116852 to rs9977668 ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2/2_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/2 ##  ## ================================================================ ## -----> Frequency 3 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3/3_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1116852 to rs7280065 ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3/3_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3/3_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1116852 to rs7280065 ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3/3_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3/3_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1116852 to rs7280065 ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3/3_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3/3_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1116852 to rs7280065 ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3/3_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/glm/selection/3 ##  ## ################################################################ ## 3. Selection of best PRS candidate markers ## ################################################################ ## The optimal number of markers for PRS based on prs_r2 is 4 at prs_r2=0.1204 ##  ## ################################################################ ## 4. Wrap-up and graphics ## ################################################################ ## sitadela database found at /home/panos/.local/share/R/sitadela directory ## Getting latest annotation on the fly for hg19 from refseq ## Retrieving genome information for hg19 from refseq ## Retrieving latest gene annotation for hg19 from refseq ## Loading required namespace: RMySQL ## Converting annotation to GenomicRanges object... ##  ## Attaching package: 'Biostrings' ## The following object is masked from 'package:base': ##  ##     strsplit ## Getting DNA sequences... ## Getting GC content... ##  ## **************************************************************** ## Executing PRISMA pipeline with statgen ## **************************************************************** ##  ## ################################################################ ## 1. Discovery of de novo PRS candidates ## ################################################################ ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline ##  ## Executing denovo pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_iter_1.log ## ================================================================ ## -----> Denovo pipeline iteration 1 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 122 ##   Hardy-Weinberg equilibrium: 3 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 109 ##   Hardy-Weinberg equilibrium: 2 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 23 associations (uncorrected p-values). ##  ## Overall, found 23 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 14 associations (uncorrected p-values). ##  ## Overall, found 14 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 23 associations found out of 563 markers ##   Part 21: 14 associations found out of 313 markers ##  ## Overall, found 37 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0473243548283736 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1/base_OURFO6909Y \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1/pheno_OURFO6909Y \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1/plink_prsice_OURFO6909Y \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1/covar_OURFO6909Y \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_OURFO6909Y \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.108815 ## Full model R^2 is: 0.817692 ## Null model R^2 is: 0.708877 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_1/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_iter_2.log ## ================================================================ ## -----> Denovo pipeline iteration 2 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 122 ##   Hardy-Weinberg equilibrium: 3 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 116 ##   Hardy-Weinberg equilibrium: 4 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 19 associations (uncorrected p-values). ##  ## Overall, found 19 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 11 associations (uncorrected p-values). ##  ## Overall, found 11 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 19 associations found out of 565 markers ##   Part 21: 11 associations found out of 311 markers ##  ## Overall, found 30 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.0502333326782181 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2/base_WUACL8542P \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2/pheno_WUACL8542P \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2/plink_prsice_WUACL8542P \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2/covar_WUACL8542P \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_WUACL8542P \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.0432059 ## Full model R^2 is: 0.679831 ## Null model R^2 is: 0.636625 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_2/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_iter_3.log ## ================================================================ ## -----> Denovo pipeline iteration 3 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 123 ##   Hardy-Weinberg equilibrium: 0 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 122 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 27 associations (uncorrected p-values). ##  ## Overall, found 27 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 14 associations (uncorrected p-values). ##  ## Overall, found 14 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 27 associations found out of 564 markers ##   Part 21: 14 associations found out of 313 markers ##  ## Overall, found 41 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.247746157407782 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3/base_RRTVO4593J \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3/pheno_RRTVO4593J \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3/plink_prsice_RRTVO4593J \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3/covar_RRTVO4593J \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_RRTVO4593J \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.143875 ## Full model R^2 is: 0.545646 ## Null model R^2 is: 0.401771 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_3/denovo_result.RData----- ## ================================================================ ## Executing denovo pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_iter_4.log ## ================================================================ ## -----> Denovo pipeline iteration 4 ## ================================================================ ## ----- Dataset partitioning ----- ## Partitioning dataset into 1 partitions by BMI ##  ## ----- Training (base) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 118 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Test (target) QC ----- ##  ## Performing basic filtering ##   Calculating SNP summaries for filtering ##   SNP filters ##     Call rate ##     Minor Allele Frequency ##     Hardy-Weinberg equilibrium ##   Sample filters ##     Call rate ##     Heterozygosity ##   Summarizing SNP filter results ##   Summarizing sample filter results ##  ## ----- Filtering report: ----- ## Filtered SNPs: ##   SNP call rate             : 0 ##   Minor Allele Frequency    : 126 ##   Hardy-Weinberg equilibrium: 1 ##  ## Filtered samples: ##   Sample call rate          : 0 ##   Heterozygosity            : 0 ##   Inbreed                   : 0 ##  ##  ## ----- Training (base) GWAS ----- ##  ## Starting GWA analysis in 2 chunks with 1 methods: statgen ##  ## ========== Analyzing chromosome/part 18 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 31 associations (uncorrected p-values). ##  ## Overall, found 31 associations with (uncorrected) combined p-values). ##  ## ========== Analyzing chromosome/part 21 ##  ## Preparing data for statgenGWAS... ## Performing GWAS with statgenGWAS model ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Use PCs     : No ## Found 16 associations (uncorrected p-values). ##  ## Overall, found 16 associations with (uncorrected) combined p-values). ##  ## Finished, the following putative associations were found per part: ##   Part 18: 31 associations found out of 567 markers ##   Part 21: 16 associations found out of 315 markers ##  ## Overall, found 47 associations with (uncorrected) combined p-values). ##  ## ----- PRS analysis with base and target ----- ##  ## Starting PRS analysis with lassosum, prsice ##  ## ========== Running PRS analysis with lassosum ## lassosum operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4 ## Preparing lassosum run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4 ##   preparing summary statistics... ##   preparing PLINK temporary files for target... ## Preflight... ##   copying linkage disequilibrium block files... ## Preparation done! ## Running lassosum PRS algorithm ## Running lassosum validation and PRS calculation ## 20 out of 20 samples kept in pheno. ## 20 out of 20 samples kept in covar. ## Done! R^2 is: 0.00201921294122433 ##  ## ========== Running PRS analysis with prsice ## prsice operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4 ## Preparing PRSice run at workspace directory: /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4 ##   preparing summary statistics for the base file... ##   preparing the covariates file... ##   preparing the phenotype file... ##   preparing PLINK temporary files - target... ## Preflight... ## Preparation done! ## Running PRSice PRS algorithm in calculate mode ##  ## Executing: ## Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ ##   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ ##   --base /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4/base_VFINF9498B \\ ##   --beta \\ ##   --binary-target F \\ ##   --pheno /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4/pheno_VFINF9498B \\ ##   --target /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4/plink_prsice_VFINF9498B \\ ##   --cov /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4/covar_VFINF9498B \\ ##   --clump-kb 250 \\ ##   --clump-r2 0.1 \\ ##   --clump-p 0.75 \\ ##   --score avg \\ ##   --seed 42 \\ ##   --out prsice_out_VFINF9498B \\ ##   --print-snp \\ ##   --perm 100 ## Done! ## Adjusted PRSice R^2 is: 0.234035 ## Full model R^2 is: 0.70313 ## Null model R^2 is: 0.469095 ##  ## Running PRS algorithms finished! Processing the results... ## Done! ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline/HFQWUJUTWNU7200S_denovo_4/denovo_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/baseline ##  ## ################################################################ ## 2. Calculation of PRS evaluation metrics ## ################################################################ ## Aggregation mode: intersect ##   iteration 1 yields 30 markers ##   iteration 2 yields 1 markers ##   iteration 3 yields 5 markers ##   iteration 4 yields 8 markers ## Calculating frequencies ## Averaging effects with mean ## Constructing output ## Done! ##  ## ================================================================ ## -----> Frequency 2 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2/2_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs8093690 ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2/2_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2/2_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs8093690 ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2/2_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2/2_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs8093690 ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2/2_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2/2_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs8093690 ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2/2_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/2 ##  ## ================================================================ ## -----> Frequency 3 <----- ## ================================================================ ## prisma operations will be executed at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3 ##  ## Executing evaluation pipeline iteration 1, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3/3_iter_1.log ## ================================================================ ## -----> Evaluation pipeline iteration 1 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs7280065 ##  ## ----- Saving iteration 1 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3/3_evaluate_1/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 2, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3/3_iter_2.log ## ================================================================ ## -----> Evaluation pipeline iteration 2 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs7280065 ##  ## ----- Saving iteration 2 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3/3_evaluate_2/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 3, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3/3_iter_3.log ## ================================================================ ## -----> Evaluation pipeline iteration 3 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs7280065 ##  ## ----- Saving iteration 3 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3/3_evaluate_3/evaluate_result.RData----- ## ================================================================ ## Executing evaluation pipeline iteration 4, log is at /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3/3_iter_4.log ## ================================================================ ## -----> Evaluation pipeline iteration 4 ## ================================================================ ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the null model ## Testing full models ##   testing PRS with SNPs from rs1740090 to rs7280065 ##  ## ----- Saving iteration 4 result to /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3/3_evaluate_4/evaluate_result.RData----- ## ================================================================ ## Cleaning up temporary program-specific intermediate files from /tmp/RtmpzNcOCa//tmp/RtmpzNcOCa/file571275878732/statgen/selection/3 ##  ## ################################################################ ## 3. Selection of best PRS candidate markers ## ################################################################ ## The optimal number of markers for PRS based on prs_r2 is 3 at prs_r2=0.16557 ##  ## ################################################################ ## 4. Wrap-up and graphics ## ################################################################ ## sitadela database found at /home/panos/.local/share/R/sitadela directory ## Getting latest annotation on the fly for hg19 from refseq ## Retrieving genome information for hg19 from refseq ## Retrieving latest gene annotation for hg19 from refseq ## Converting annotation to GenomicRanges object... ## Getting DNA sequences... ## Getting GC content... ##  ## 2022-06-06 20:45:57: Data processing finished! ## Total processing time: 03 minutes 56 seconds"},{"path":"/articles/08-pipelines.html","id":"prs-candidate-evaluation-lookup-and-reporting","dir":"Articles","previous_headings":"","what":"PRS candidate evaluation, lookup and reporting","title":"Complete PRISMA pipelines","text":"completion PRISMA pipeline, using total dataset evaluate candidates. also lookup SNP content GWAS Catalog finally report results HTML report. cvMetrics list validation metrics used reporting function. may inspect great meaning outside report. Similarly, lookup list findings GWAS Catalog, regarding SNP content PRS candidates potential associated traits. Finally, create report:","code":"cvMetrics <- prismaCrossValidate(     prismaOut=prismaOut,     gwe=toy,     response=response,     covariates=covariates,     pcs=FALSE,     leaveOut=c(0.1,0.25,0.5),     rc=0.25 ) ##  ## ################################################################ ## Running cross-validations for glm with 3 leave-out cases across 1 PRS candidates ## ################################################################ ##  ## ================================================================ ## -----> Cross-validating PRS candidate with 4 markers ## ================================================================ ##  ## ----- Leave-out percentage 10% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 25% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 50% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ################################################################ ## Running cross-validations for statgen with 3 leave-out cases across 1 PRS candidates ## ################################################################ ##  ## ================================================================ ## -----> Cross-validating PRS candidate with 3 markers ## ================================================================ ##  ## ----- Leave-out percentage 10% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 25% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ----- Leave-out percentage 50% ----- ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Running cross-validation iteration 1 ## Running cross-validation iteration 2 ## Running cross-validation iteration 3 ## Running cross-validation iteration 4 ## Running cross-validation iteration 5 ## Running cross-validation iteration 6 ## Running cross-validation iteration 7 ## Running cross-validation iteration 8 ## Running cross-validation iteration 9 ## Running cross-validation iteration 10 ##  ## ################################################################ ## Done! Use summarizeCvMetrics() and plotCvMetrics() to summarize and inspect the results. ## ################################################################ lookup <- prismaLookup(prismaOut) ## -----> Querying for glm ## Querying GWAS Catalog with the largest PRS ## -----> Querying for statgen ## Querying GWAS Catalog with the largest PRS prismaReport(toy,prismaOut,cvMetrics,lookup)"},{"path":"/articles/08-pipelines.html","id":"wrapping-the-whole-process-with-the-prismapipeline-function","dir":"Articles","previous_headings":"PRS candidate evaluation, lookup and reporting","what":"Wrapping the whole process with the prismaPipeline() function","title":"Complete PRISMA pipelines","text":"difference prisma() function prismaPipeline() function wraps prisma() call, calculation evaluation cross-validation metrics, lookup report. report written outPath. output report case shown embedded . Plese note realistic report. normal one richer PRS candidates evaluate.","code":"outPath <- file.path(tempdir(),tempfile()) d7 <- tempfile() wspace7 <- file.path(outPath,d7)  prismaPipeline(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=c(\"glm\",\"statgen\"),     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace4,     cleanup=\"intermediate\",     logging=\"file\",     output=\"normal\",     rc=0.25,     outPath=outPath ) browseURL(paste0(\"file://\",outPath,\"index.html\"))"},{"path":"/articles/08-pipelines.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R session info","title":"Complete PRISMA pipelines","text":"","code":"sessionInfo() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 18.04.6 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] BSgenome.Hsapiens.UCSC.hg19_1.4.3 BSgenome_1.62.0                   ##  [3] rtracklayer_1.54.0                Biostrings_2.62.0                 ##  [5] XVector_0.34.0                    prisma_0.0.2                      ##  [7] SNPRelate_1.28.0                  gdsfmt_1.30.0                     ##  [9] snpStats_1.44.0                   Matrix_1.4-1                      ## [11] survival_3.3-1                    SummarizedExperiment_1.24.0       ## [13] Biobase_2.54.0                    GenomicRanges_1.46.1              ## [15] GenomeInfoDb_1.30.1               IRanges_2.28.0                    ## [17] S4Vectors_0.32.4                  BiocGenerics_0.40.0               ## [19] MatrixGenerics_1.6.0              matrixStats_0.62.0                ## [21] lassosum_0.4.5                    ##  ## loaded via a namespace (and not attached): ##   [1] utf8_1.2.2                               ##   [2] R.utils_2.11.0                           ##   [3] tidyselect_1.1.2                         ##   [4] gwascat_2.26.0                           ##   [5] RSQLite_2.2.14                           ##   [6] AnnotationDbi_1.56.2                     ##   [7] grid_4.1.3                               ##   [8] BiocParallel_1.28.3                      ##   [9] munsell_0.5.0                            ##  [10] codetools_0.2-18                         ##  [11] ragg_1.2.2                               ##  [12] future_1.25.0                            ##  [13] quincunx_0.1.4                           ##  [14] islasso_1.4.3                            ##  [15] colorspace_2.0-3                         ##  [16] filelock_1.0.2                           ##  [17] OrganismDbi_1.36.0                       ##  [18] highr_0.9                                ##  [19] knitr_1.39                               ##  [20] rstudioapi_0.13                          ##  [21] robustbase_0.95-0                        ##  [22] TTR_0.24.3                               ##  [23] listenv_0.8.0                            ##  [24] urltools_1.7.3                           ##  [25] optparse_1.7.1                           ##  [26] GenomeInfoDbData_1.2.7                   ##  [27] farver_2.1.0                             ##  [28] bit64_4.0.5                              ##  [29] rprojroot_2.0.3                          ##  [30] parallelly_1.31.1                        ##  [31] vctrs_0.4.1                              ##  [32] generics_0.1.2                           ##  [33] xfun_0.31                                ##  [34] BiocFileCache_2.2.1                      ##  [35] R6_2.5.1                                 ##  [36] rmdformats_1.0.3                         ##  [37] bitops_1.0-7                             ##  [38] cachem_1.0.6                             ##  [39] DelayedArray_0.20.0                      ##  [40] assertthat_0.2.1                         ##  [41] gwasrapidd_0.99.12                       ##  [42] BiocIO_1.4.0                             ##  [43] Homo.sapiens_1.3.1                       ##  [44] scales_1.2.0                             ##  [45] gtable_0.3.0                             ##  [46] globals_0.15.0                           ##  [47] rlang_1.0.2                              ##  [48] systemfonts_1.0.4                        ##  [49] splines_4.1.3                            ##  [50] rsnps_0.5.0.0                            ##  [51] sitadela_1.3.1                           ##  [52] BiocManager_1.30.16                      ##  [53] yaml_2.3.5                               ##  [54] reshape2_1.4.4                           ##  [55] GenomicFeatures_1.46.5                   ##  [56] quantmod_0.4.20                          ##  [57] RMySQL_0.10.23                           ##  [58] RBGL_1.70.0                              ##  [59] tools_4.1.3                              ##  [60] lava_1.6.10                              ##  [61] bookdown_0.26                            ##  [62] liftOver_1.18.0                          ##  [63] ggplot2_3.3.5                            ##  [64] ellipsis_0.3.2                           ##  [65] kableExtra_1.3.4                         ##  [66] jquerylib_0.1.4                          ##  [67] Rcpp_1.0.8.3                             ##  [68] rrBLUP_4.6.1                             ##  [69] plyr_1.8.7                               ##  [70] progress_1.2.2                           ##  [71] zlibbioc_1.40.0                          ##  [72] purrr_0.3.4                              ##  [73] RCurl_1.98-1.6                           ##  [74] prettyunits_1.1.1                        ##  [75] cowplot_1.1.1                            ##  [76] zoo_1.8-10                               ##  [77] fs_1.5.2                                 ##  [78] crul_1.2.0                               ##  [79] magrittr_2.0.3                           ##  [80] data.table_1.14.2                        ##  [81] openxlsx_4.2.5                           ##  [82] triebeard_0.3.0                          ##  [83] mvtnorm_1.1-3                            ##  [84] survcomp_1.44.1                          ##  [85] hms_1.1.1                                ##  [86] evaluate_0.15                            ##  [87] XML_3.99-0.9                             ##  [88] RMTstat_0.3.1                            ##  [89] shape_1.4.6                              ##  [90] compiler_4.1.3                           ##  [91] biomaRt_2.50.3                           ##  [92] tibble_3.1.7                             ##  [93] KernSmooth_2.23-20                       ##  [94] crayon_1.5.1                             ##  [95] R.oo_1.24.0                              ##  [96] htmltools_0.5.2                          ##  [97] pcaPP_2.0-1                              ##  [98] tzdb_0.3.0                               ##  [99] tidyr_1.2.0                              ## [100] rrcov_1.7-0                              ## [101] lubridate_1.8.0                          ## [102] DBI_1.1.2                                ## [103] SuppDists_1.1-9.7                        ## [104] dbplyr_2.1.1                             ## [105] MASS_7.3-56                              ## [106] rappdirs_0.3.3                           ## [107] PhenotypeSimulator_0.3.4                 ## [108] getopt_1.20.3                            ## [109] readr_2.1.2                              ## [110] rmeta_3.0                                ## [111] cli_3.3.0                                ## [112] quadprog_1.5-8                           ## [113] R.methodsS3_1.8.1                        ## [114] parallel_4.1.3                           ## [115] pkgconfig_2.0.3                          ## [116] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ## [117] pkgdown_2.0.3.9000                       ## [118] GenomicAlignments_1.30.0                 ## [119] signal_0.7-7                             ## [120] xml2_1.3.3                               ## [121] foreach_1.5.2                            ## [122] svglite_2.1.0                            ## [123] bslib_0.3.1                              ## [124] webshot_0.5.3                            ## [125] prodlim_2019.11.13                       ## [126] rvest_1.0.2                              ## [127] stringr_1.4.0                            ## [128] VariantAnnotation_1.40.0                 ## [129] digest_0.6.29                            ## [130] graph_1.72.0                             ## [131] httpcode_0.3.0                           ## [132] rmarkdown_2.14                           ## [133] harmonicmeanp_3.0                        ## [134] restfulr_0.0.13                          ## [135] curl_4.3.2                               ## [136] Rsamtools_2.10.0                         ## [137] rjson_0.2.21                             ## [138] tseries_0.10-51                          ## [139] lifecycle_1.0.1                          ## [140] jsonlite_1.8.0                           ## [141] survivalROC_1.0.3                        ## [142] desc_1.4.1                               ## [143] viridisLite_0.4.0                        ## [144] fansi_1.0.3                              ## [145] pillar_1.7.0                             ## [146] lattice_0.20-45                          ## [147] DEoptimR_1.0-11                          ## [148] KEGGREST_1.34.0                          ## [149] fastmap_1.1.0                            ## [150] httr_1.4.3                               ## [151] GO.db_3.14.0                             ## [152] xts_0.12.1                               ## [153] glue_1.6.2                               ## [154] zip_2.2.0                                ## [155] SNPlocs.Hsapiens.dbSNP151.GRCh38_0.99.20 ## [156] png_0.1-7                                ## [157] iterators_1.0.14                         ## [158] pander_0.6.5                             ## [159] glmnet_4.1-4                             ## [160] bit_4.0.4                                ## [161] stringi_1.7.6                            ## [162] sass_0.4.1                               ## [163] bootstrap_2019.6                         ## [164] blob_1.2.3                               ## [165] statgenGWAS_1.0.8                        ## [166] textshaping_0.3.6                        ## [167] org.Hs.eg.db_3.14.0                      ## [168] memoise_2.0.1                            ## [169] FMStable_0.1-2                           ## [170] dplyr_1.0.8                              ## [171] future.apply_1.9.0"},{"path":"/articles/09-external.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Evaluation of external PRS or external GWAS","text":"Although main PRISMA functionality de novo PRS derivation evaluation, one can easily evaluate externally derived PRS, example PRS retrieved EBI PGS Catalog. can done two ways: Subsetting GWASExperiment according SNPs retrieved PRS/PGS running PRISMA pipeline (prisma() prismaPipeline()). better way new effects calculated suitable population. pipeline run quite fast, number SNPs included external PRS . Provided retireved PRS directly prsCrossValidate() function. take object (effects) return evaluation scores PRS tested population genotypes. PRS retrieval functions included package (getPGSScores()) fetch data frames ready usage prsCrossValidate(). Quality control initial dataset may may performed.","code":""},{"path":"/articles/09-external.html","id":"testing-an-externally-retrieved-prs","dir":"Articles","previous_headings":"","what":"Testing an externally retrieved PRS","title":"Evaluation of external PRS or external GWAS","text":"purposes vignette going use score file reported PGS000034 Adult Body Mass Index reported trait. score included package. also created smaller toy dataset called pgd source toy dataset containing common SNPs PGS000034 source data used create toy dataset. Load pgd dataset use common SNPs exPgs. already state commands demo purposes. Run PRISMA full pipeline, GLM: raw matrix evaluation metrics:","code":"base <- file.path(system.file(package=\"prisma\"),\"extdata\",\"scores\") pgsId <- \"PGS000034\" exPgs <- getPGSScores(pgsId=pgsId,base=base) ## Scheduling 1 PGS API calls... ##   Requesting 1 PGS Catalog API calls with PGS ID(s)... ##     Call 1: PGS000034 ## Retrieving and enriching scores file(s) for PGS000034 ##   local file PGS000034.txt.gz ##   processing PGS000034 ## Dealing with duplicates (if any) rownames(exPgs) <- exPgs$variant_id  head(exPgs) ##            chromosome  position variant_id risk_allele reference_allele ## rs1000940          17   5223976  rs1000940           G                A ## rs10132280         14  24998019 rs10132280           C                A ## rs1016287           2  59159129  rs1016287           T                C ## rs10182181          2  25003800 rs10182181           G                A ## rs10733682          9 128500735 rs10733682           A                G ## rs10938397          4  44877284 rs10938397           G                A ##            locus_name effect_weight       OR asm ## rs1000940          NA         0.019 1.019182  nr ## rs10132280         NA         0.023 1.023267  nr ## rs1016287          NA         0.023 1.023267  nr ## rs10182181         NA         0.031 1.031486  nr ## rs10733682         NA         0.017 1.017145  nr ## rs10938397         NA         0.040 1.040811  nr data(pgd,package=\"prisma\") gdsfile(pgd) <- system.file(package=\"prisma\",\"extdata\",\"pgd.gds\")  pgd ## class: GWASExperiment  ## dim: 25 100  ## metadata(5): genome backend filters gdsfile alleleOrder ## assays class: SnpMatrix with 25 rows (SNPs) and 100 columns (samples) ## assays(1): '' ## rownames(25): rs657452 rs11583200 ... rs2033732 rs1928295 ## feature names(6): chromosome snp.name ... allele.1 allele.2 ## colnames(100): 12 21 ... 590 595 ## sample names(6): pedigree member ... sex affected ## phenotype names(6): FID IID ... Age BMI ## performed tests(0): ## associated PRS(0):  exPgs <- exPgs[rownames(pgd),] outPath <- tempfile() d1 <- tempfile() wspace1 <- file.path(outPath,d1)  # Traits response <- \"BMI\" covariates <- c(\"Case_Control\",\"Gender\",\"Age\")  # Lose filters for the toy dataset filts <- getDefaults(\"filters\") filts$IBD <- NA filts$hwe <- 1e-3 filts$pcaOut <- FALSE filts$inbreed <- NA  prismaPipeline(     gwe=pgd,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=\"glm\",     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace1,     cleanup=\"intermediate\",     logging=\"file\",     output=\"normal\",     rc=0.25,     outPath=outPath ) m <- prsCrossValidate(exPgs,pgd,response=response,     covariates=covariates,leaveOut=0.2,times=5)"},{"path":"/articles/09-external.html","id":"testing-a-derived-prs-with-independent-genotypic-data","dir":"Articles","previous_headings":"","what":"Testing a derived PRS with independent genotypic data","title":"Evaluation of external PRS or external GWAS","text":"Often (actually always) like test derived PRS candidates independent population share similar characteristics, example living country similar origins. Sometimes also beneficial test random PRSs population see whether original PRS indeed added value random effect. applyPRS() function can used accomplish aforementioned processes. example , run PRS randomization process","code":"data(toy,package=\"prisma\") gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Traits response <- \"BMI\" covariates <- c(\"Case_Control\",\"Gender\",\"Age\")  # Lose filters for the toy dataset filts <- getDefaults(\"filters\") filts$IBD <- NA filts$hwe <- 1e-3 filts$pcaOut <- FALSE filts$inbreed <- NA  wspace2 <- tempfile() prismaOut <- prisma(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=\"statgen\",     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace2,     cleanup=\"intermediate\",     logging=\"file\",     output=\"normal\",     rc=0.5 ) ##  ## 2022-06-06 20:47:00: Data processing started... ##  ## Input ## -------------------------------------------------------------------- ## Input object (gwe) : a GWASExperiment object with 1000 markers (SNPs) and 100 samples ##  ## Regression parameters ## -------------------------------------------------------------------- ## Phenotypic response (phenotype)          : BMI ## Regression covariates (covariates)       : Case_Control, Gender, Age ## Principal Components in covariates (pcs) : No ## Number of Principal Components (npcs)    : - ##  ## Preprocessing options ## -------------------------------------------------------------------- ## Sample and genotype filtering options (filters)     : ##   snpCallRate    : 0.98 ##   sampleCallRate : 0.95 ##   maf            : 0.05 ##   hwe            : 0.001 ##   heteroStat     : median ##   heteroFac      : 3 ##   heteroHard     : NA ##   pcaOut         : No ##   pcaRobust      : hubert ##   nPC            : NA ##   LD             : 0.2 ##   IBD            : NA ##   inbreed        : NA ## Principal Components calculation method (pcaMethod) : snprel ## Impute missing genotypes (imputeMissing)            : No ## Missing genotype imputation method (imputeMethod)   : singlesplit ##  ## GWA analysis options ## -------------------------------------------------------------------- ## Genome-Wide Association tests (gwaMethods)        : statgen ## Association tests combination method (gwaCombine) : fishersimesmaxminharmonicwhitlockpandora ## Association tests options                         : ##   statgen : ##     kinship : astle ##     reml    : EMMA ##     gls     : single ##  ## PRS candidate extraction options ## -------------------------------------------------------------------- ## PRS extraction algorithms (prsMethods) : lassosum, prsice ## PRS algorithms options (prsMethods)    : ##   lassosum : ##     anc   : eur ##     valid : auto ##   prsice : ##     clump_kb : 250 ##     clump_r2 : 0.1 ##     clump_p  : 0.75 ##     score    : avg ##     perm     : 100 ##     seed     : 42 ##  ## PRS construction and evaluation options ## -------------------------------------------------------------------- ## Training set size (trainSize)                               : 80% ## Number of PRS selection iterations (niter)                  : 4 ## PRS selection resolution method (resolution)                : frequency ## PRS selection resolution step (step)                        : 1 ## Minimum SNP frequency in PRS (minFreq)                      : 2 ## Minimum number of SNPs in PRS (minSnps)                     : 2 ## Drop quantiles with same number of SNPs (dropSameQuantiles) : Yes ## PRS aggregation method (aggregation)                        : intersectionunion ## SNP effect summarization method (effectWeight)              : meanmedianweight ## PRS evaluation framework (evalWith)                         : vanillaprscice ##  ## PRS selection options ## -------------------------------------------------------------------- ## PRS selection method (prsSelectMethod)           : maxima ## PRS selection criterion (prsSelectCrit)          : prs_r2 ## PRS criterion summarization (prsSelectStat)      : mean ## R^2 type if criterion includes R^2 (prsSelectR2) : adjusted ##  ## Miscellaneous options ## -------------------------------------------------------------------- ## Local workspace directory (prsWorkspace) : /tmp/Rtmp1aBwWH/file5a5827f340de ## Cleanup level (cleanup)                  : intermediate ## PRS pipeline output type (dnOutput)      : normal ## Output level (output)                    : normal ## Run ID (runId)                           : auto ## Available cores fraction (rc)            : 50% ##  ## **************************************************************** ## Executing PRISMA pipeline with statgen ## **************************************************************** ##  ## ################################################################ ## 1. Discovery of de novo PRS candidates ## ################################################################ ## prisma operations will be executed at /tmp/Rtmp1aBwWH/file5a5827f340de/statgen/baseline ##  ## Cleaning up temporary program-specific intermediate files from /tmp/Rtmp1aBwWH/file5a5827f340de/statgen/baseline ##  ## ################################################################ ## 2. Calculation of PRS evaluation metrics ## ################################################################ ## Aggregation mode: intersect ##   iteration 1 yields 3 markers ##   iteration 2 yields 97 markers ##   iteration 3 yields 29 markers ##   iteration 4 yields 3 markers ## Calculating frequencies ## Averaging effects with mean ## Constructing output ## Done! ##  ## ================================================================ ## -----> Frequency 2 <----- ## ================================================================ ## prisma operations will be executed at /tmp/Rtmp1aBwWH/file5a5827f340de/statgen/selection/2 ##  ## Cleaning up temporary program-specific intermediate files from /tmp/Rtmp1aBwWH/file5a5827f340de/statgen/selection/2 ##  ## ================================================================ ## -----> Frequency 3 <----- ## ================================================================ ## prisma operations will be executed at /tmp/Rtmp1aBwWH/file5a5827f340de/statgen/selection/3 ##  ## Cleaning up temporary program-specific intermediate files from /tmp/Rtmp1aBwWH/file5a5827f340de/statgen/selection/3 ##  ## ################################################################ ## 3. Selection of best PRS candidate markers ## ################################################################ ## The optimal number of markers for PRS based on prs_r2 is 4 at prs_r2=0.19894 ##  ## ################################################################ ## 4. Wrap-up and graphics ## ################################################################ ## sitadela database found at /home/panos/.local/share/R/sitadela directory ## Getting latest annotation on the fly for hg19 from refseq ## Retrieving genome information for hg19 from refseq ## Retrieving latest gene annotation for hg19 from refseq ## Loading required namespace: RMySQL ## Converting annotation to GenomicRanges object... ##  ## Attaching package: 'Biostrings' ## The following object is masked from 'package:base': ##  ##     strsplit ## Getting DNA sequences... ## Getting GC content... ##  ## 2022-06-06 20:48:34: Data processing finished! ## Total processing time: 01 minutes 33 seconds  snpSelection <- getPrsCandidates(prismaOut,\"statgen\",1)  metrics <- applyPRS(snpSelection,toy,response=response,covariates=covariates) ## All input PRS SNPs found in the input object! Proceeding... ##  ## Regressing with GLM ## Trait(s)    : BMI ## Covariate(s): Case_Control, Gender, Age ## Regression  : gaussian (predicted) ## Use PCs     : No ## Creating the reduced model ## Creating the full model ## No summary statistics found in the input object. No SNP randomization will be performed.  metrics$metrics ##       reduced_r2          full_r2           prs_r2       prs_pvalue  ##     4.386799e-01     5.909386e-01     1.522587e-01     4.533066e-08  ##     reduced_rmse        full_rmse      reduced_mae         full_mae  ##     3.551591e+00     3.031879e+00     2.829719e+00     2.402121e+00  ## reduced_pred_cor    full_pred_cor  reduced_pred_r2     full_pred_r2  ##     6.623292e-01     7.687253e-01     4.386799e-01     5.909386e-01  ##      prs_pred_r2  ##     1.522587e-01  head(metrics$values) ##     raw_pheno red_pheno full_pheno         prs ## 12   30.15677  31.57696   32.16866  0.52282598 ## 21   30.16859  31.33548   28.36736  1.77442175 ## 139  30.93989  31.14021   33.42950  0.01781605 ## 142  42.38751  31.62525   35.08138 -0.48719388 ## 148  30.30177  31.72185   29.69688  1.44926079 ## 157  29.51856  24.07311   24.18296  0.48103345"},{"path":"/articles/09-external.html","id":"r-session-info","dir":"Articles","previous_headings":"","what":"R session info","title":"Evaluation of external PRS or external GWAS","text":"","code":"sessionInfo() ## R version 4.1.3 (2022-03-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 18.04.6 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] BSgenome.Hsapiens.UCSC.hg19_1.4.3 BSgenome_1.62.0                   ##  [3] rtracklayer_1.54.0                Biostrings_2.62.0                 ##  [5] XVector_0.34.0                    prisma_0.0.2                      ##  [7] SNPRelate_1.28.0                  gdsfmt_1.30.0                     ##  [9] snpStats_1.44.0                   Matrix_1.4-1                      ## [11] survival_3.3-1                    SummarizedExperiment_1.24.0       ## [13] Biobase_2.54.0                    GenomicRanges_1.46.1              ## [15] GenomeInfoDb_1.30.1               IRanges_2.28.0                    ## [17] S4Vectors_0.32.4                  BiocGenerics_0.40.0               ## [19] MatrixGenerics_1.6.0              matrixStats_0.62.0                ## [21] lassosum_0.4.5                    ##  ## loaded via a namespace (and not attached): ##   [1] utf8_1.2.2                               ##   [2] R.utils_2.11.0                           ##   [3] tidyselect_1.1.2                         ##   [4] gwascat_2.26.0                           ##   [5] RSQLite_2.2.14                           ##   [6] AnnotationDbi_1.56.2                     ##   [7] grid_4.1.3                               ##   [8] BiocParallel_1.28.3                      ##   [9] munsell_0.5.0                            ##  [10] codetools_0.2-18                         ##  [11] ragg_1.2.2                               ##  [12] future_1.25.0                            ##  [13] quincunx_0.1.4                           ##  [14] islasso_1.4.3                            ##  [15] colorspace_2.0-3                         ##  [16] filelock_1.0.2                           ##  [17] OrganismDbi_1.36.0                       ##  [18] knitr_1.39                               ##  [19] rstudioapi_0.13                          ##  [20] robustbase_0.95-0                        ##  [21] TTR_0.24.3                               ##  [22] listenv_0.8.0                            ##  [23] optparse_1.7.1                           ##  [24] GenomeInfoDbData_1.2.7                   ##  [25] farver_2.1.0                             ##  [26] bit64_4.0.5                              ##  [27] rprojroot_2.0.3                          ##  [28] parallelly_1.31.1                        ##  [29] vctrs_0.4.1                              ##  [30] generics_0.1.2                           ##  [31] xfun_0.31                                ##  [32] BiocFileCache_2.2.1                      ##  [33] R6_2.5.1                                 ##  [34] rmdformats_1.0.3                         ##  [35] bitops_1.0-7                             ##  [36] cachem_1.0.6                             ##  [37] DelayedArray_0.20.0                      ##  [38] assertthat_0.2.1                         ##  [39] gwasrapidd_0.99.12                       ##  [40] BiocIO_1.4.0                             ##  [41] Homo.sapiens_1.3.1                       ##  [42] scales_1.2.0                             ##  [43] gtable_0.3.0                             ##  [44] globals_0.15.0                           ##  [45] rlang_1.0.2                              ##  [46] systemfonts_1.0.4                        ##  [47] splines_4.1.3                            ##  [48] rsnps_0.5.0.0                            ##  [49] sitadela_1.3.1                           ##  [50] BiocManager_1.30.16                      ##  [51] yaml_2.3.5                               ##  [52] reshape2_1.4.4                           ##  [53] GenomicFeatures_1.46.5                   ##  [54] quantmod_0.4.20                          ##  [55] RMySQL_0.10.23                           ##  [56] RBGL_1.70.0                              ##  [57] tools_4.1.3                              ##  [58] lava_1.6.10                              ##  [59] bookdown_0.26                            ##  [60] liftOver_1.18.0                          ##  [61] ggplot2_3.3.5                            ##  [62] ellipsis_0.3.2                           ##  [63] kableExtra_1.3.4                         ##  [64] jquerylib_0.1.4                          ##  [65] Rcpp_1.0.8.3                             ##  [66] rrBLUP_4.6.1                             ##  [67] plyr_1.8.7                               ##  [68] progress_1.2.2                           ##  [69] zlibbioc_1.40.0                          ##  [70] purrr_0.3.4                              ##  [71] RCurl_1.98-1.6                           ##  [72] prettyunits_1.1.1                        ##  [73] tidyjson_0.3.1                           ##  [74] cowplot_1.1.1                            ##  [75] zoo_1.8-10                               ##  [76] fs_1.5.2                                 ##  [77] crul_1.2.0                               ##  [78] magrittr_2.0.3                           ##  [79] data.table_1.14.2                        ##  [80] openxlsx_4.2.5                           ##  [81] mvtnorm_1.1-3                            ##  [82] survcomp_1.44.1                          ##  [83] hms_1.1.1                                ##  [84] evaluate_0.15                            ##  [85] XML_3.99-0.9                             ##  [86] RMTstat_0.3.1                            ##  [87] shape_1.4.6                              ##  [88] compiler_4.1.3                           ##  [89] biomaRt_2.50.3                           ##  [90] tibble_3.1.7                             ##  [91] KernSmooth_2.23-20                       ##  [92] crayon_1.5.1                             ##  [93] R.oo_1.24.0                              ##  [94] htmltools_0.5.2                          ##  [95] pcaPP_2.0-1                              ##  [96] tzdb_0.3.0                               ##  [97] tidyr_1.2.0                              ##  [98] rrcov_1.7-0                              ##  [99] lubridate_1.8.0                          ## [100] DBI_1.1.2                                ## [101] SuppDists_1.1-9.7                        ## [102] dbplyr_2.1.1                             ## [103] MASS_7.3-56                              ## [104] rappdirs_0.3.3                           ## [105] PhenotypeSimulator_0.3.4                 ## [106] getopt_1.20.3                            ## [107] readr_2.1.2                              ## [108] rmeta_3.0                                ## [109] cli_3.3.0                                ## [110] quadprog_1.5-8                           ## [111] R.methodsS3_1.8.1                        ## [112] parallel_4.1.3                           ## [113] pkgconfig_2.0.3                          ## [114] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  ## [115] pkgdown_2.0.3.9000                       ## [116] GenomicAlignments_1.30.0                 ## [117] signal_0.7-7                             ## [118] xml2_1.3.3                               ## [119] foreach_1.5.2                            ## [120] svglite_2.1.0                            ## [121] bslib_0.3.1                              ## [122] webshot_0.5.3                            ## [123] prodlim_2019.11.13                       ## [124] rvest_1.0.2                              ## [125] stringr_1.4.0                            ## [126] VariantAnnotation_1.40.0                 ## [127] digest_0.6.29                            ## [128] graph_1.72.0                             ## [129] httpcode_0.3.0                           ## [130] rmarkdown_2.14                           ## [131] harmonicmeanp_3.0                        ## [132] restfulr_0.0.13                          ## [133] curl_4.3.2                               ## [134] Rsamtools_2.10.0                         ## [135] rjson_0.2.21                             ## [136] tseries_0.10-51                          ## [137] lifecycle_1.0.1                          ## [138] jsonlite_1.8.0                           ## [139] survivalROC_1.0.3                        ## [140] desc_1.4.1                               ## [141] viridisLite_0.4.0                        ## [142] fansi_1.0.3                              ## [143] pillar_1.7.0                             ## [144] lattice_0.20-45                          ## [145] DEoptimR_1.0-11                          ## [146] KEGGREST_1.34.0                          ## [147] fastmap_1.1.0                            ## [148] httr_1.4.3                               ## [149] GO.db_3.14.0                             ## [150] xts_0.12.1                               ## [151] glue_1.6.2                               ## [152] zip_2.2.0                                ## [153] SNPlocs.Hsapiens.dbSNP151.GRCh38_0.99.20 ## [154] png_0.1-7                                ## [155] iterators_1.0.14                         ## [156] pander_0.6.5                             ## [157] glmnet_4.1-4                             ## [158] bit_4.0.4                                ## [159] stringi_1.7.6                            ## [160] sass_0.4.1                               ## [161] bootstrap_2019.6                         ## [162] blob_1.2.3                               ## [163] statgenGWAS_1.0.8                        ## [164] textshaping_0.3.6                        ## [165] org.Hs.eg.db_3.14.0                      ## [166] memoise_2.0.1                            ## [167] FMStable_0.1-2                           ## [168] dplyr_1.0.8                              ## [169] future.apply_1.9.0"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Panagiotis Moulos. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Moulos P (2022). prisma: Automated Polygenic Risk Score modeling evaluation. R package version 0.0.2, https://github.com/pmoulos/prisma.","code":"@Manual{,   title = {prisma: Automated Polygenic Risk Score modeling and evaluation},   author = {Panagiotis Moulos},   year = {2022},   note = {R package version 0.0.2},   url = {https://github.com/pmoulos/prisma}, }"},{"path":"/index.html","id":"prisma---automated-polygenic-risk-score-modeling-and-evaluation","dir":"","previous_headings":"","what":"Automated Polygenic Risk Score modeling and evaluation","title":"Automated Polygenic Risk Score modeling and evaluation","text":"prisma R package semi-automated construction evaluation Polygenic Risk Scores (PRS) data multiple summary statistics PRS extraction algorithms. prisma supports several Genome Wide Association (GWA) tests calculation summary statistics integrates results multiple PRS algorithms. addition, offers multiple PRS evaluation criteria semi-automated optimal PRS selection process local maximization evaluation criteria. Finally, integrates GWA effects linear programming helps user select best PRS rich report results online search GWAS Catalog.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Automated Polygenic Risk Score modeling and evaluation","text":"prisma requires presence several R packages also additional 3rd party software tools running GWA tests derive summary statistics well PRS extraction. See detailed installation guide information step--step process. prerequisites place, PRISMA can installed GitHub time :","code":"library(devtools) install_github(\"pmoulos/prisma\")"},{"path":"/index.html","id":"quickstart","dir":"","previous_headings":"","what":"Quickstart","title":"Automated Polygenic Risk Score modeling and evaluation","text":"following depict basic PRISMA PRS extraction pipeline. full documentation see package vignettes also online documentation.","code":""},{"path":"/index.html","id":"step-by-step-pipeline","dir":"","previous_headings":"","what":"Step by step pipeline","title":"Automated Polygenic Risk Score modeling and evaluation","text":"","code":"library(prisma)  data(toy,package=\"prisma\")  # Lose filters for the toy dataset filts <- getDefaults(\"filters\") filts$IBD <- NA filts$hwe <- 1e-3 filts$pcaOut <- FALSE filts$inbreed <- NA  # Workspace d1 <- tempfile() wspace1 <- file.path(tempdir(),d1)  # Traits response <- \"BMI\" covariates <- c(\"Case_Control\",\"Gender\",\"Age\")  # Complete 4-iteration PRS pipeline - ~1 min to run with 4 cores - no PCA prismaOut <- prisma(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=c(\"glm\",\"statgen\"),     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace1,     cleanup=\"intermediate\",     logging=\"file\",     output=\"normal\",     rc=0.25 )  # Below, individual wrapper steps implemented in prisma as whole # Output only of the discovery PRS pipeline with statgenGWAS d2 <- tempfile() wspace2 <- file.path(tempdir(),d2) dnList <- prsPipeline(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=\"statgen\",     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace2,     cleanup=\"intermediate\",     logging=\"file\",     rc=0.25 )  # After, calculate the evaluation metrics d3 <- tempfile() wspace3 <- file.path(tempdir(),d3) evalMetrics <- prsSelection(     dnList=dnList,     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=\"statgen\",     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace3,     cleanup=\"intermediate\",     logging=\"file\",     output=\"summary\",     useDenovoWorkspace=dnList,     rc=0.25 )  candidates <- selectPrs(     metrics=evalMetrics$metrics,     snpSelection=evalMetrics$pgs,     gwe=toy,     base=evalMetrics$baseline )"},{"path":"/index.html","id":"complete-pipeline","dir":"","previous_headings":"","what":"Complete pipeline","title":"Automated Polygenic Risk Score modeling and evaluation","text":"","code":"if (Sys.which(\"PRSice_linux\") != \"\") {     outPath <- tempfile()     wspace1 <- tempfile()          prismaPipeline(         gwe=toy,         phenotype=response,         covariates=covariates,         pcs=FALSE,         trainSize=0.8,         niter=4,         resolution=\"frequency\",         minSnps=2,         filters=filts,         pcaMethod=\"snprel\",         imputeMissing=FALSE,         gwaMethods=c(\"glm\",\"statgen\"),         prsiceOpts=list(clump_p=0.75,perm=100),         prsWorkspace=wspace4,         cleanup=\"intermediate\",         logging=\"file\",         output=\"normal\",         rc=0.25,         outPath=outPath     ) }"},{"path":"/reference/GWASExperiment-class.html","id":null,"dir":"Reference","previous_headings":"","what":"GWASExperiment objects — GWASExperiment-class","title":"GWASExperiment objects — GWASExperiment-class","text":"GWASExperiment class matrix-like container     directly inherits properties      SummarizedExperiment class extends     respect holding GWAS data terms accomodating      genotypic phenotypic data also association scores     SNP effects Genome-Wide Association tests. addition,     PRISMA's main purpose construction evaluation     Polygenic Risk Scores, offers facilities store     results respective analyses. Specifically, assays GWASExperiment hold matrix     object (SnpMatrix bigSNP) rows represent SNPs     variants columns represent samples. values     assays represent genotypes accessed     manipulated respective functions packages     snpStats bigSNP. Apart assays,     rowData GWASExperiment hold information     markers colData hold information     samples. information typically derived     initial input data used construct      GWASExperiment. easiest way construct     set PLINK files BED, BIM FAM formats. Direct     construction also possible, long provided     information markers samples complete,     example, markers accompanied least     chromosome position data well major/minor      allele information. Apart basic GWASExperiment data make direct     use SummarizedExperiment slots,     class offers slots store associated phenotypic     anthropometric data sample used     GWA tests, slots store results tests     terms p-values reggression coefficients (effects).     SNPs may become part PRS,     GWASExperiment also offers slot storing weights     PRS SNPs. Furthermore, GWASExperiment takes     advantage metadata slot     SummarizedExperiment store additional     information GWAS subsequent PRS extraction     GWA summary statistics, Principal Component     Analysis results used covariates capture     account potential underlying population stratification,     reference genome information, track filters applied     genotypes samples information.      Finally, offers ability avoid genotypic     phenotypic data duplication conducting multiple GWA     tests allowing association storage many test     results (e.g. different covariates) within     object.","code":""},{"path":"/reference/GWASExperiment-class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GWASExperiment objects — GWASExperiment-class","text":"","code":"## Constructor      GWASExperiment(         genotypes = SnpMatrix(),          features = DataFrame(),         samples = DataFrame(),         phenotypes = DataFrame(),         pvalues = SimpleList(),         effects = SimpleList(),         prsbetas = SimpleList(),         metadata = list(             genome = NA_character_,             backend = NA_character_,             filters = setNames(                 data.frame(matrix(ncol = 5, nrow = 0)),                 c(\"parameter\", \"name\", \"value\", \"type\", \"filtered\")             )         )     )       ## Accessors - apart from the ones of SummarizedExperiment      genotypes(x, ...)     genotypes(x, ...) <- value     gfeatures(x, withDimnames=TRUE, ...)     gfeatures(x, ...) <- value     gsamples(x, withDimnames=TRUE, ...)     gsamples(x, ...) <- value      phenotypes(x, withDimnames=TRUE, ...)     phenotypes(x, withDimnames=TRUE, ...) <- value      pvalues(x, response = 1L, covariates = NULL, npcs = 0,         withDimnames = TRUE, ...)     pvalues(x, response = 1L, covariates = NULL, npcs = 0,         withDimnames = TRUE, ...) <- value     allPvalues(x, i = seq_len(ncol(x)), ...)     effects(x, response = 1L, covariates = NULL, npcs = 0,         withDimnames = TRUE, ...)     effects(x, response = 1L, covariates = NULL, npcs = 0,         withDimnames = TRUE, ...) <- value     allEffects(x, i = seq_len(ncol(x)), ...)     prsbetas(x, response = 1L, covariates = NULL, npcs = 0,         withDimnames = TRUE, ...)     prsbetas(x, response = 1L, covariates = NULL, npcs = 0,         withDimnames = TRUE, ...) <- value     allPrsbetas(x, i = seq_len(ncol(x)), ...)               ## Splitting          gsplit(x, by, across = c(\"features\", \"samples\"),          rc = NULL, ...)       ## Elements          genome(x)     genome(x, ...) <- value     gdsfile(x)     gdsfile(x, ...) <- value     filterRecord(x)     filterRecord(x, ...) <- value     pcaCovariates(x)     pcaCovariates(x, ...) <- value       ## Quick colData access      # S4 method for GWASExperiment,ANY,missing [[(x, i, j, ...)     # S4 method for GWASExperiment,ANY,missing [[(x, i, j, ...) <- value       ## Subsetting      # S4 method for GWASExperiment [(x, i, j, ..., drop=TRUE)     # S4 method for GWASExperiment,ANY,ANY,GWASExperiment [(x, i, j) <- value       ## Combining      # S4 method for GWASExperiment cbind(..., deparse.level=1)     # S4 method for GWASExperiment rbind(..., deparse.level=1)"},{"path":"/reference/GWASExperiment-class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GWASExperiment objects — GWASExperiment-class","text":"x GWASExperiment object. ... cbind, rbind, ...      contains GWASExperiment objects combined.      accessors, ignored. value object class specified S4 method     signature outlined Details. , j genotypes, genotypes<-,      integer numeric scalar, see Details      additional constraints functions     like pvalues. Brifely, latter      scalar vector indices retrieve     statistical scores, corresponding number models      fit x. [,GWASExperiment, [,GWASExperiment<-,      , j subscripts can act subset      rows columns x, matrix      elements genotypes. [[,GWASExperiment, [[<-,GWASExperiment,      scalar index (e.g., character(1)      integer(1)) column gsamples. withDimnames logical(1), indicating whether      dimnames GWASExperiment object applied      (.e. copied) extracted assays (genotypes     data samples, features, phenotypes). precisely,      setting withDimnames=FALSE getter      returns assays -whereas setting      withDimnames=FALSE return possibly modified      dimnames. Setting withDimnames=FALSE setter      (assays<-) required dimnames supplied      assays identical dimnames GWASExperiment      object. influence actual assignment dimnames      assays (always stored -). details, see     SummarizedExperiment. drop logical(1), ignored methods. deparse.level See ?base::cbind      description argument. genotypes SnpMatrix bigSNP      matrix-like object holds genotypes      SNPs/markers row sample column. features DataFrame      data.frame holding detailed information     genotyped SNP. See also Details. samples DataFrame      data.frame holding information     genotyped sample. See also Details. phenotypes DataFrame      data.frame holding phenotypic records      genotyped sample, typically used GWA tests. See      also Details. pvalues SimpleList      list p-values GWA tests     SNP. member corresponds GWA test specific     covariates. See also Details. effects SimpleList      list regression coefficients (converted     odds ratios) GWA tests SNP (effects).      member corresponds GWA test specific covariates.      See also Details. prsbetas SimpleList      list weights SNP participating     PRS. member corresponds GWA test specific     covariates. Typically, subset effects, unless adjustment     algorithms (e.g. lassosum) applied. See also Details. metadata list similar metadata     SummarizedExperiment. contain     least genome, backend filters     members. See also Details. response numeric integer character scalar.     number, correspond column number     response phenotype GWA test. character,     one phenotypes associated x.     See also Details. covariates character vector NULL.     covariates used regression models GWA tests.     exist phenotypes x. See also      Details. npcs number PCs included covariates     GWA test. See also Details. name sample SNP attribute     used splitting factor. across split GWASExperiment accross      \"features\" (default) \"samples\", according     attribute defined . rc fraction available cores use      splitting.","code":""},{"path":"/reference/GWASExperiment-class.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"GWASExperiment objects — GWASExperiment-class","text":"GWASExperiment class straighforward expansion     SummarizedExperiment class meant      numeric data types derived typically sequencing      experiment suitable host genotypic data main      features latter Single Nucleotide Polymorphisms      (SNPs) share lot common information sequencing     experiments genomic coordinates certain types     abundance. structure rectangular like matrix,      additional annotations rows columns,      possibility manage several assays simultaneously      long dimensions. generic     information can found manual pages     SummarizedExperiment class. following focus     expansions introduced GWASExperiment class. rows GWASExperiment object represent SNPs/markers     interest. Information markers stored     DataFrame data.frame object, accessible      using function gfeatures (native      rowData gfeatures alias ).      object must many rows rows      GWASExperiment object, row object providing      information SNP corresponding row      GWASExperiment object. Columns object represent      different attributes features interest. Specifically,      GWASExperiment case, must least genomic     coordinates, chromosome position, unique id (    can dbSNP id) two alleles comprising genotype.     typical case GWASExperiment created PLINK     files backend provided snpStats package     columns object chromosome,     snp.name, cM, position, allele.1     allele.2. also preferred column names     object. must also assigned rownames, preferrably     snp.names column. column GWASExperiment object represents sample     (e.g. person contributing GWAS project). Information      samples stored DataFrame ,     data.frame object, accessible using function      gsamples (native colData      gsamples alias ). object must      many rows columns GWASExperiment object,      row object providing information sample     corresponding column GWASExperiment object.     Columns object represent different sample attributes,      e.g., pedigree, sex etc. Column names typically provide short      identifier unique sample. typical case      GWASExperiment created PLINK files backend      provided snpStats package columns     object pedigree, member, father,     mother, sex affected. also      preferred column names object. must also      assigned rownames, preferrably member      column. GWASExperiment object, SummarizedExperiment, can also      contain information overall experiment, instance      lab conducted, publications      associated, etc. information stored      list object, accessible using metadata      function. form data associated experiment     left discretion user. However,      metadata GWASExperiment object must least     three elements. :  genome: reference genome used         genotyping technology (usually hg38 hg19).         can accessed set using genome function. filters: set filters applied         GWASExperiment filter noisy genotyping data ()         summary results data.frame.         placeholder automatically added construction. can         accessed set filterRecord fuction. backend: backend package used read         store genotype data (one snpStats         bigsnpr). crucial downstream functions         manipulation must changed. GWASExperiment container appropriate matrix-like     genotypic data, derived gentype microarray     technologies. Apart related SummarizedExperiment data     accessor functions, data accessed using      genotypes function, described . returns     SnpMatrix bigSNP object. SimpleList      object genotypic data potentially different      experiment can accessed assays.      genotypes returns first one, typically,      used. element list must either      SnpMatrix codebigSNP object must      dimensions dimensions     GWASExperiment stored. Row column     names object must either NULL match      GWASExperiment construction. Furthermore, GWASExperiment offers facilities storing     data typical subsequent GWAS analyses PRS     constructions, storing phenotypic anthropometric     data used association analysis, results GWA tests     results PRS analysis. Instead storing     data metadata slot SummarizedExperiment,     bound slots following dimensions subsetting     main genotypic matrix object. Therefore, phenotypic     data accessed phenotypes function,     results GWA tests (p-values, regression coefficients)     accessed pvalues effects     functions respectively, associated PRS weights     accessed throught function prsbetas.     functions described return      SimpleList objects, GWASExperiment object may     multiple GWA PRS results attached avoid     genotype repetition. listing associated analyses     GWASExperiment object may retrieved     listGwa listPrs functions      functions allPvalues, allEffects     allPrsbetas can used retrieve list     analyses results.","code":""},{"path":"/reference/GWASExperiment-class.html","id":"constructor","dir":"Reference","previous_headings":"","what":"Constructor","title":"GWASExperiment objects — GWASExperiment-class","text":"GWASExperiment instances constructed using     GWASExperiment function arguments outlined      .","code":""},{"path":"/reference/GWASExperiment-class.html","id":"accessors","dir":"Reference","previous_headings":"","what":"Accessors","title":"GWASExperiment objects — GWASExperiment-class","text":"following code snippets, x GWASExperiment     object. describe standard SummarizedExperiment     accessors rowData, colData, dim     etc. Details can found respective man pages. General     patterns row data must NULL identical     row names main matrix object (, genotypes)     assumed. genotypes(x), genotypes(x) <- value: Get      set genotypes. value SnpMatrix      bigSNP dimensions x. gfeatures(x, withDimnames=TRUE),      gfeatures(x) <- value: Get set feature data (similar     row data SummarizedExperiment). value      DataFrame data.frame object. gsamples(x, withDimnames=TRUE),      gsamples(x) <- value: Get set sample data (similar     column data SummarizedExperiment). value      DataFrame data.frame object. phenotypes(x, withDimnames=TRUE),      phenotypes(x) <- value: Get set phenotypic data     sample. value data.frame      object many rows number samples associated     phenotypes experiment. pvalues(x, response = 1L, covariates = NULL,      npcs = 0, withDimnames = TRUE), pvalues(x, response = 1L,      covariates = NULL, npcs = 0, withDimnames = TRUE, ...) <- value: Get set p-values application one     genotype-phenotype association tests. response     phenotype association test performed. can     numeric integer value denoting column number      phenotypes data frame associated x value,     character case name phenotype     corresponds column name aforementioned data frame.      defaults first available phenotype. covariates     phenotypic covariates included association      model must available phenotypes data frame. can     either numeric/integer vector denoting column numbers     character vector denoting column names phenotypes data     frame. defaults NULL addition covariates,     main phenotype (response). npcs     denotes number PCs include model additional     covariates capture potential population substructures.     defaults 0 PCs additional covariates.     withDimnames, see e.g. gfeatures.     reason accessor additional arguments     (response, covariates, npcs)     x may multiple association test results attached     , variable offer way unique access     . Finally, value numeric matrix p-values     SNP. matrix many columns different     test types performed (e.g. SNPTEST statgenGWAS)     named accordingly. allPvalues(x, = seq_len(ncol(x))):     retrieve (access-) either p-value matrices     attached x many requested ,     assuming least tests performed. effects(x, response = 1L, covariates = NULL,      npcs = 0, withDimnames = TRUE), effects(x, response = 1L,      covariates = NULL, npcs = 0, withDimnames = TRUE, ...) <- value: Get set SNP effects respect phenotype      application one genotype-phenotype association      tests. effects essentially regression coefficients     odds ratios binomial regression models. response,      covariates npcs pvalues     accessor. value numeric matrix effects     SNP. matrix many columns different test     types performed (e.g. SNPTEST statgenGWAS) named     accordingly. allEffects(x, = seq_len(ncol(x))):     retrieve (access-) either effect matrices     attached x many requested ,     assuming least tests performed. prsbetas(x, response = 1L, covariates = NULL,      npcs = 0, withDimnames = TRUE), prsbetas(x, response = 1L,      covariates = NULL, npcs = 0, withDimnames = TRUE, ...) <- value: Get set beta coefficients (odd ratios) effects      derived application Polygenic Risk Scores     algorithm, respect phenotype tested one     association tests. Essentially, PRS betas     regression coefficients SNPs participating     PRS either corrected case effect shrinkage algorithms     (e.g. lassosum), returned association test.     response, covariates npcs      pvalues accessor. value numeric matrix      effects SNP participating PRS candidate     0 otherwise. matrix many columns different      PRS algorithms executed x named accordingly. allPrsbetas(x, = seq_len(ncol(x))):     retrieve (access-) either PRS beta matrices     attached x many requested ,     assuming least tests performed. genome(x), genome(x) <- value: Get set     genome build features (SNPs, variations)     mapped . Typically, one \"hg19\" \"hg38\"     class designed mainly human data. genomes     may provided, human builts,      functionalities also supported SNP information     retrieval dbSNP /Ensembl, also enrichment     PGS score files. gdsfile(x), gdsfile(x) <- value: Get set     supporting GDS file location. required      package SNPRelate perform certain functionalities     Linkage Disequilibrium (LD) pruning, Identity Descent (IBD)     filtering others. provided, functionalities     available. filterRecord(x), filterRecord(x) <- value: Get set data frame holding record filters applied     x, cutoff values filtering results (.e.     many SNPs filtered). data frame specific     format violating cause error. Typically, users     access filter records. see structure     data frame, call filterRecord(x). pcaCovariates(x), pcaCovariates(x) <- value: Get set PCA covariates capture underlying population     stratification structures. PCA covariates typically     calculated using calcPcaCovar function     one supporting methods within package. Users     usually access PCA covariates setting using     calcPcaCovar function. gsplit(x, , across = c(\"features\", \"samples\"),      rc = NULL: Split object column names stored     gfeatures gsamples. former, object     split row-wise former, split column-wise.     either name gfeatures     gsamples column, index. missing,     object split according rc variable     prepares object parallel calculatios     split done according number available cores     use (rc). rc=NULL also     missing, split object returned     lenght-one list.","code":""},{"path":"/reference/GWASExperiment-class.html","id":"subsetting","dir":"Reference","previous_headings":"","what":"Subsetting","title":"GWASExperiment objects — GWASExperiment-class","text":"subsetting operations described respective     section SummarizedExperiment help page.      restrictions case GWASExperiment     case replacement, data types stored slots must     compatible (.e. SnpMatrix, bigSNP objects genotypes      DataFrame, data.frame objects associated genotype     sample data).","code":""},{"path":"/reference/GWASExperiment-class.html","id":"combining","dir":"Reference","previous_headings":"","what":"Combining","title":"GWASExperiment objects — GWASExperiment-class","text":"combining functions GWASExperiment objects follow     principles SummarizedExperiment objects.     Special attention given regarding integrity main     SummarizedExperiment class extensions. briefly      phenotypes follow samples (columns/colData)     GWASExperiment object statistical scores parallel     features (rowData) object (pvalues, effects etc.). combining objects, following attributes values     preserved, become meaningless combination     samples /SNPs:  pvalues, effects, prsbetas: scores         dropped initial population potentially          samples SNPs derived changed. filters: filtered SNPs/samples statistics         re-initialized population SNPs/samples         changed. values related PCA, , statistics         depend population changes object          combination.","code":""},{"path":"/reference/GWASExperiment-class.html","id":"splitting","dir":"Reference","previous_headings":"","what":"Splitting","title":"GWASExperiment objects — GWASExperiment-class","text":"splitting operations differ classic      SummarizedExperiment sense GWASExperiment     object may curry multiple associated GWA PRS analyses     using different sets covariates. can preserved     using gsplit function operates across     feature properties sample properties.","code":""},{"path":"/reference/GWASExperiment-class.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"GWASExperiment objects — GWASExperiment-class","text":"Panagiotis Moulos","code":""},{"path":[]},{"path":"/reference/GWASExperiment-class.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GWASExperiment objects — GWASExperiment-class","text":"","code":"library(PhenotypeSimulator)  # Simulate some data dat1 <- makeSimData(nsnp=100,nsam=10,nphe=3,csnp=10) #> coercing object of mode  numeric  to SnpMatrix  # Simple GWASExperiment object gwe1 <- GWASExperiment(     genotypes=dat1$snp,     features=dat1$feature,     samples=dat1$sample,     phenotypes=dat1$pheno )  # With pseudo-effects and pseudo-pvalues pspval <- matrix(runif(200),100,2) rownames(pspval) <- rownames(dat1$snp) colnames(pspval) <- c(\"test1\",\"test2\")  # Pseudo-effects and directions pseff <- matrix(runif(200,min=0,max=2),100,2) dire <- matrix(FALSE,100,2) dire[sample(nrow(dire),50),1] <- TRUE dire[sample(nrow(dire),50),2] <- TRUE pseff[dire[,1],1] <- -pseff[dire[,1],1] pseff[dire[,2],2] <- -pseff[dire[,2],2] rownames(pseff) <- rownames(dat1$snp) colnames(pseff) <- c(\"test1\",\"test2\")  # Assign effects and p-values to the object, assuming a model # with 'Trait_1' as response and 'Trait_2', 'Trait_3' as # covariates has been fit pvalues(gwe1,response=\"Trait_1\",     covariates=c(\"Trait_2\",\"Trait_3\")) <- pspval effects(gwe1,response=\"Trait_1\",     covariates=c(\"Trait_2\",\"Trait_3\")) <- pseff  # Add SNPs (rbind) dat2 <- makeSimData(nsnp=100,nsam=10,nphe=3,csnp=10) #> coercing object of mode  numeric  to SnpMatrix rownames(dat2$snp) <- rownames(dat2$feature) <-      paste(\"snp\",101:200,sep=\"_\") gwe2 <- GWASExperiment(     genotypes=dat2$snp,     features=dat2$feature,     samples=dat1$sample,     phenotypes=dat1$pheno ) # p-values and effects will be dropped with warning gwe12 <- suppressWarnings(rbind(gwe1,gwe2))  # Add samples (cbind) dat3 <- makeSimData(nsnp=100,nsam=10,nphe=3,csnp=10) #> coercing object of mode  numeric  to SnpMatrix rownames(dat3$sample) <- rownames(dat3$pheno) <-      colnames(dat3$snp) <- paste(\"sample\",11:20,sep=\"_\") gwe3 <- GWASExperiment(     genotypes=dat3$snp,     features=dat1$feature,     samples=dat3$sample,     phenotypes=dat3$pheno ) # p-values and effects will be dropped with warning gwe13 <- suppressWarnings(cbind(gwe1,gwe3))"},{"path":"/reference/SnpMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple SnpMatrix object constructor — SnpMatrix","title":"Simple SnpMatrix object constructor — SnpMatrix","text":"funtion serves constructor SnpMatrix     object matrix coded genotypes.","code":""},{"path":"/reference/SnpMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple SnpMatrix object constructor — SnpMatrix","text":"","code":"SnpMatrix(snp)"},{"path":"/reference/SnpMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple SnpMatrix object constructor — SnpMatrix","text":"snp matrix genotypes integers     numerics. See also Details.","code":""},{"path":"/reference/SnpMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple SnpMatrix object constructor — SnpMatrix","text":"SnpMatrix object.","code":""},{"path":"/reference/SnpMatrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simple SnpMatrix object constructor — SnpMatrix","text":"Regarding main snp argument,     integer matrix, genotypes coded 1     (homozygous minor allele), 2 (heterozygous),     3 (homozygous major allele). Missing values     represented 0s.     numeric matrix, genotypes coded 0     (homozygous minor allele), 1 (heterozygous),     2 (homozygous major allele). Missing values     represented NAs.","code":""},{"path":"/reference/SnpMatrix.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simple SnpMatrix object constructor — SnpMatrix","text":"Panagiotis Moulos","code":""},{"path":"/reference/SnpMatrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simple SnpMatrix object constructor — SnpMatrix","text":"","code":"g <- z <- cbind(c(1L,2L,3L),c(0L,1L,2L),c(3L,2L,1L))     S <- SnpMatrix(g) #> coercing object of mode  numeric  to SnpMatrix #> object has no names - using numeric order for row/column names     as(S,\"numeric\") #>   1  2 3 #> 1 0 NA 2 #> 2 1  0 1 #> 3 2  1 0"},{"path":"/reference/adjustPrsWeights.html","id":null,"dir":"Reference","previous_headings":"","what":"PRS weight adjustment through final regression — adjustPrsWeights","title":"PRS weight adjustment through final regression — adjustPrsWeights","text":"function may used adjust SNP effects     derive final PRS (e.g. total dataset)     whole extraction assessment process.     process obligatory.","code":""},{"path":"/reference/adjustPrsWeights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PRS weight adjustment through final regression — adjustPrsWeights","text":"","code":"adjustPrsWeights(snpSelection, gwe, response,          covariates = NULL, pcs = FALSE, family = NULL,         rc = NULL)"},{"path":"/reference/adjustPrsWeights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PRS weight adjustment through final regression — adjustPrsWeights","text":"snpSelection data frame SNPs comprising     PRS, properly formatted (see      aggregatePrsMarkers). gwe GWASExperiment object used     derive PRS. response character phenotypic response     used derive PRS. covariates character vector covariares     used derive PRS. pcs Use PCs present gwe? Defaults     FALSE. PRS extracted PCs     covariates, TRUE. family Regression family, e.g. \"gaussian\",     see also gwa. rc fraction available cores use      parallel calculations. Default NULL     parallelization.","code":""},{"path":"/reference/adjustPrsWeights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PRS weight adjustment through final regression — adjustPrsWeights","text":"new data frame SNPs comprising PRS     adjusted effects.","code":""},{"path":"/reference/adjustPrsWeights.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"PRS weight adjustment through final regression — adjustPrsWeights","text":"Panagiotis Moulos","code":""},{"path":"/reference/adjustPrsWeights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PRS weight adjustment through final regression — adjustPrsWeights","text":"","code":"data(toy,package=\"prisma\")     data(prisma_out,package=\"prisma\")          prs <- getPrsCandidates(prismaOut,\"statgen\",1)     #prs <- prismaOut$results$statgen$candidates[[1]]          prsa <- adjustPrsWeights(prs,toy,\"BMI\",         c(\"Age\",\"Gender\",\"Case_Control\"),pcs=FALSE) #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender, Case_Control #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1442343 to rs6506142 #> Found 3 associations (uncorrected p-values).          identical(prs$effect_weight,prsa$effect_weight) #> [1] FALSE     # FALSE"},{"path":"/reference/aggregatePrsMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers","title":"Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers","text":"function aggregates results iterative     PRS extraction derived using prsPipeline.     aggregation done intersecting unifying     SNPs extracted one PRS algorithms.     aggregated result can subjected PRS      selection process according frequency      appearance marker result subset     aggregated markers final PRS.","code":""},{"path":"/reference/aggregatePrsMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers","text":"","code":"aggregatePrsMarkers(gwaList, mode = c(\"intersect\",          \"union\"), qcut = 0.9, assoc = c(\"auto\", \"glm\",         \"rrblup\", \"statgen\", \"snptest\", \"plink\", \"lasso\"),         avgfun = c(\"mean\", \"median\", \"weight\"), gwe = NULL)"},{"path":"/reference/aggregatePrsMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers","text":"gwaList list GWASExperiments      summaries derived prsPipeline. mode Aggregation mode, can \"intersect\"     (default) \"union\". qcut quantile cutoff frequency SNP     appearances gwaList. SNPs frequencies      one corresponding quantile ignored     output. assoc effects use performed     GWA tests SNP weights PRS. Can \"auto\"     (default) \"glm\", \"rrblup\",      \"statgen\", \"snptest\", \"plink\",     long exists. See also Details. avgfun summarize SNP effects (regression      coefficients) iterative extraction process.     One \"mean\" (default), \"median\"      \"weight\". See also Details. gwe GWASExperiment object used derive     PRS. given, output complete data frame,     harmonized scores EBI PGS Catalog.","code":""},{"path":"/reference/aggregatePrsMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers","text":"gwe NULL, data frame SNP     markers summarized prsPipeline run     following columns: chromosome: chromosome          marker located position: marker position         chromosome variant_id: SNP rs id          identification available risk_allele: risk allele reference_allele: non-risk allele locus_name: SNP's closest gene         (NA , assigned later          assignGenes) effect_weight: SNP effect          derived regression functions avgfun : effect_weight          transformed Odds Ratio asm: genome assembly (\"hg19\"         \"hg38\" \"nr\" unknown) freq: number appearances         prsPipeline iterative process gwe NULL, simpler data frame     SNP marker following columns: snp SNP rs id          identification available freq number appearances         prsPipeline iterative process effect SNP effect derived         regression functions avgfun","code":""},{"path":"/reference/aggregatePrsMarkers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers","text":"Regarding assoc argument, controls     effects included final PRS data frame,     available ones. \"auto\" (     default), final effects selected based     GWA algorithms executed internal     prioritization scheme according perception      regarding algorithm popularity. Specifically,     first available effects used based following     prioritization: SNPTEST (\"snptest\") PLINK (\"plink\") statgenGWAS (\"statgen\") GLM (\"glm\") rrBLUP (\"rrblup\") future intend combine available     effects based linear optimization methods (work     progress) Regarding avgfun argument, controls     SNP effects PRS candidates summarized      iterative PRS extraction process order produce      final effects calculation weighted PRS.      \"mean\" (default), final effect SNP      mean effects across iterations     appears. \"median\",      respective median \"weight\", SNP      effects weighted 1 minus recorded PRS R^2      \"best\" runs can given value.","code":""},{"path":"/reference/aggregatePrsMarkers.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers","text":"Panagiotis Moulos","code":""},{"path":"/reference/aggregatePrsMarkers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregate PRS candidate SNPs from iterative extraction — aggregatePrsMarkers","text":"","code":"data(toy,package=\"prisma\")     data(prisma_out,package=\"prisma\")          iters <- prismaOut$results$glm$iterations     #iters <- getRawIterations(prismaOut,\"glm\")     snps <- aggregatePrsMarkers(iters,qcut=0.25,gwe=toy) #> Aggregation mode: intersect #>   iteration 1 yields 3 markers #>   iteration 2 yields 62 markers #>   iteration 3 yields 40 markers #>   iteration 4 yields 2 markers #> Calculating frequencies #> Averaging effects with mean #> Constructing output #> Done!"},{"path":"/reference/assignGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign genes to a PRISMA output or list of PRS candidates — assignGenes","title":"Assign genes to a PRISMA output or list of PRS candidates — assignGenes","text":"function assigns gene names SNPs     prisma output list.","code":""},{"path":"/reference/assignGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign genes to a PRISMA output or list of PRS candidates — assignGenes","text":"","code":"assignGenes(prismaOut, gv = c(\"hg19\",\"hg38\"), sitDb = NULL)"},{"path":"/reference/assignGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign genes to a PRISMA output or list of PRS candidates — assignGenes","text":"prismaOut output object prisma     list PRS candidate data frames. gv Human genome version, one \"hg19\" (default)     \"hg38\". sitDb sitadela SQLite database least     two genomes described RefSeq.","code":""},{"path":"/reference/assignGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign genes to a PRISMA output or list of PRS candidates — assignGenes","text":"input, HUGO gene names assigned  locus_name column PRS candidates.","code":""},{"path":"/reference/assignGenes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign genes to a PRISMA output or list of PRS candidates — assignGenes","text":"sitadela database found provided location,     required information downloaded --fly.     advised annotation done iteratively.      sitDb=NULL, annotation performed.","code":""},{"path":"/reference/assignGenes.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Assign genes to a PRISMA output or list of PRS candidates — assignGenes","text":"Panagiotis Moulos","code":""},{"path":"/reference/assignGenes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign genes to a PRISMA output or list of PRS candidates — assignGenes","text":"","code":"if (FALSE) {     data(toy,package=\"prisma\")     data(prisma_out,package=\"prisma\")      prismaOut <- assignGenes(prismaOut,gv=genome(toy)) }"},{"path":"/reference/calcPcaCovar.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate PCA covariates for GWASExperiments — calcPcaCovar","title":"Calculate PCA covariates for GWASExperiments — calcPcaCovar","text":"function performs PCA using three available methods     genetic data included iput object order     capture potential underlying population structure     outliers, derive PCs used covariates     downstream GWA. Two three methods can used     perform robust PCA intention better      capturing potential outliers.","code":""},{"path":"/reference/calcPcaCovar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate PCA covariates for GWASExperiments — calcPcaCovar","text":"","code":"calcPcaCovar(obj, ld = 0.2, method = c(\"auto\",          \"snprel\", \"grid\", \"hubert\"), npc = 0, pval = 0.05,          rc = NULL)"},{"path":"/reference/calcPcaCovar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate PCA covariates for GWASExperiments — calcPcaCovar","text":"obj GWASExperiment object without      missing values. ld Linkage Disequilibrium cutoff (defaults     0.2) SNPs include PCA. See also     Details. method Method used calculate PCs. One     \"auto\" (default), \"snprel\", \"grid\"     \"hubert\". See also Details. npc number PCs attach obj.     0 (default), Tracy-Widom test used     determine best number PCs include. pval p-value Tracy-Widom test. Defaults     0.05. PCs p-value threshold     ignored. rc Fraction available cores use     method=\"snprel\".","code":""},{"path":"/reference/calcPcaCovar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate PCA covariates for GWASExperiments — calcPcaCovar","text":"input GWASExperiment object attached PC     covariates corresponding data hosted     object. can retrieved  pcaCovariates(obj).","code":""},{"path":"/reference/calcPcaCovar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate PCA covariates for GWASExperiments — calcPcaCovar","text":"Regarding ld argument, generally     recommended literature use LD-pruned SNPs     PCA GWAS Experiments. argument controls     threshold LD LD-pruning. based     recommendations Reed al., 2013. Regarding method argument,      \"auto\", PCs already exist object, LD     pruning redone following robust PCA      attached filters object robust PCA marked.     , PCA package SNPRelate performed.     noted larger datasets, robust     PCA can take lot time, much less     optimized method SNPRelate.","code":""},{"path":"/reference/calcPcaCovar.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate PCA covariates for GWASExperiments — calcPcaCovar","text":"Panagiotis Moulos","code":""},{"path":"/reference/calcPcaCovar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate PCA covariates for GWASExperiments — calcPcaCovar","text":"","code":"data(toy,package=\"prisma\")     gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")          # Only 1 PC will be returned because of dataset size     toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) #> Performing PCA to select covariates to include in associations #> Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... #> Performing LD pruning... #> SNP pruning based on LD: #> Excluding 0 SNP (non-autosomes or non-selection) #> Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) #>     # of samples: 100 #>     # of SNPs: 962 #>     using 1 thread #>     sliding window: 500,000 basepairs, Inf SNPs #>     |LD| threshold: 0.2 #>     method: composite #> Chromosome 18: 23.44%, 154/657 #> Chromosome 21: 21.28%, 73/343 #> 227 markers are selected in total. #> LD pruning finished! 227 SNPs will be used for PCA. #>  #> Performing PCA... #> Principal Component Analysis (PCA) on genotypes: #> Excluding 773 SNPs (non-autosomes or non-selection) #> Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) #>     # of samples: 100 #>     # of SNPs: 227 #>     using 1 thread #>     # of principal components: 32 #> PCA:    the sum of all selected genotypes (0,1,2) = 10268 #> CPU capabilities: Double-Precision SSE2 #> Mon Jun  6 20:05:48 2022    (internal increment: 13024) #>  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 1s #> Mon Jun  6 20:05:49 2022    Begin (eigenvalues and eigenvectors) #> Mon Jun  6 20:05:49 2022    Done. #> Selecting number of PCs to include #>   with Tracy-Widom test for significant eigenvalues #>     selected 1 PCs"},{"path":"/reference/cvSumFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to summarize PRS cross-validations — cvSumFuns","title":"Functions to summarize PRS cross-validations — cvSumFuns","text":"functions facilitate summarization lenghty     PRS candidate cross-validation runs using multiple     linear regression samples agains main phenotype     investigation. mean used directly     (although prohibited know expect     interpret) rather used generate     plots numbers PRISMA final HTML report.","code":""},{"path":"/reference/cvSumFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to summarize PRS cross-validations — cvSumFuns","text":"","code":"summarizeCvMetrics(cvm)          cvSummary(M, nsnp, scr = TRUE, out = FALSE)          plotCvMetrics(cvo, what = c(\"r2\", \"rmse\", \"mae\", \"pr2\",\"crl\"),         pl = c(\"pct\", \"prs\"), silent = FALSE)"},{"path":"/reference/cvSumFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to summarize PRS cross-validations — cvSumFuns","text":"cvm output link{prismaCrossValidate}     one GWA method. See also Details. M list member cvm one     PRS candidate, one leave-fraction. Contains     metrics particular leave-percentage      total samples. See examples. nsnp number SNPs PRS candidate.     provided, guessed M. scr print output cvSummary     screen? See also Details. store output cvSummary     variable? See also Details. cvo cvm. metric plot available     ones? See also Details. pl \"pct\" plots according      leave-samples PRS candidates, \"prs\"      plots according numbr SNPs PRS given     percentage. Essentially, two types CV plots     PRISMA report. silent plotting without messages? Defaults     FALSE.","code":""},{"path":"/reference/cvSumFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to summarize PRS cross-validations — cvSumFuns","text":"summarizeCvMetrics, list length     PRS candidates specific GWA method.     list member contains metrics collected prismaCrossValidate across requested     number iterations. See also man page prismaCrossValidate.     cvSummary, summary CV metrics      PRS candidate across requested iterations prismaCrossValidate. See Details     detailed explanation calculated.     plotCvMetrics, list requested     ggplot2 objects, named according type     plots (leave-percentage based, PRS size     based). See also examples.","code":""},{"path":"/reference/cvSumFuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functions to summarize PRS cross-validations — cvSumFuns","text":"Reagrding cvm argument, list     lists, containing several cross-validation metrics.     main members named number SNPs PRS     candidate sub-members named      leave-splits cross validation.      structures meant used directly, although      provided. feed overall PRISMA HTML      report. Typically, member list output     produced function prismaCrossValidate     many cvm's number GWA     methods used main prisma     run. Regarding scr variables,     control summarized cross-validation      metrics displayed /stored.     TRUE, output stored variable      later use e.g. prismaReport     scr TRUE output nicely printed     screen. TRUE, also varable     returned. case careful syntax     screen may flooded information!     set FALSE. need output! Regarding argument, following      explain different options: r2: model R^2 values (train samples) rmse: Root Mean Squared Error mae: Mean Absolute Error pr2: predicted R^2 values (LOO samples) crl: correlations phenotype Regarding output cvSummary, following     calculated PRS candidate, specific     percentage leave-samples specific     number cross-validation iterations: General information Number SNPs PRS (n_snp):             number SNPs PRS candidate              evaluated. Number cross-validation (cv_times):             number leave-cross-validations.             iteration, random number samples comprising             requested percentage leave-samples             dataset left PRS validated             based regressing phenotypes rest             samples including PRS covariate             evaluating model based left-             samples. Statistical significance PRS             model (max_prs_pvalue): best p-value             PRS covariate CV regression             model. R^2 summary statistics R^2 full regression model including              PRS  (mean_full_r2, sd_full_r2):              average R^2 full model including              PRS +/- standard deviation. R^2 reduced regression model              excluding PRS (mean_reduced_r2,              sd_reduced_r2): average R^2              reduced regression model, including             covariates excluding PRS, +/- standard              deviation. Adjusted R^2 PRS full model              contribution (mean_prs_r2,              sd_prs_r2): average adjusted R^2             full model, denoting contribution             PRS (essentially R^2 full model             minus R^2 reduced model), +/-             standard deviation. Statistical significance full R^2          reduced R^2 p-value Student's t-test              (ttest_full_reduced_r2) hypothesis             mean R^2 full model larger             mean R^2 reduced model. p-value Wiloxon rank sum test             (wilcox_full_reduced_r2)              hypothesis median R^2 full model              larger median R^2 reduced              model. Empirical p-value              (empirical_full_reduced_r2) denoting             number times R^2 full model              smaller R^2 reduced model across             number cross-validation iterations. RMSE (Root Mean Squared Error) summary          statistics RMSE full regression model              including PRS (mean_full_rmse,              sd_full_rmse): Average RMSE              full model PRS +/- standard deviation. RMSE reduced regression model              excluding PRS (mean_reduced_rmse,              sd_reduced_rmse): Average RMSE              reduced model including covariates              excluding PRS, +/- standard deviation. Statistical significance full RMSE          reduced RMSE p-value Student's t-test              (ttest_full_reduced_rmse)              hypothesis mean RMSE full model              larger mean RMSE reduced             model. p-value Wiloxon rank sum test             (wilcox_full_reduced_rmse)              hypothesis median RMSE full model              larger median RMSE reduced              model. Empirical p-value              (empirical_full_reduced_rmse) denoting             number times RMSE full model              smaller RMSE reduced model across             number cross-validation iterations. MAE (Mean Absolute Error) summary statistics MAE full regression model              including PRS (mean_full_mae,              sd_full_mae): Average MAE              full model PRS +/- standard deviation. MAE reduced regression model              excluding PRS (mean_reduced_mae,              sd_reduced_mae): Average MAE              reduced model including covariates              excluding PRS, +/- standard deviation. Statistical significance full MAE          reduced MAE p-value Student's t-test              (ttest_full_reduced_mae)              hypothesis mean MAE full model              larger mean MAE reduced             model. p-value Wiloxon rank sum test             (wilcox_full_reduced_mae)              hypothesis median MAE full model              larger median MAE reduced              model. Empirical p-value              (empirical_full_reduced_mae) denoting             number times MAE full model              smaller MAE reduced model across             number cross-validation iterations. Correlation summary statistics R observed & predicted values              full model (mean_full_pred_cor,              sd_full_pred_cor): average correlation             actual observed phenotype values             predicted full regression model,             including PRS, +/- standard deviation. R observed & predicted values              reduced model (mean_reduced_pred_cor,              sd_reduced_pred_cor): average              correlation actual observed phenotype              values predicted reduced regression              model, including covariates              excluding PRS, +/- standard deviation. Statistical significance full R          reduced R p-value Student's t-test              (ttest_full_reduced_pred_cor)              hypothesis mean R full model              larger mean R reduced             model. p-value Wiloxon rank sum test             (wilcox_full_reduced_pred_cor)              hypothesis median R full model              larger median R reduced              model. Empirical p-value              (empirical_full_reduced_pred_cor) denoting              number times R full model              smaller R reduced model across             number cross-validation iterations. R^2 summary statistics predicted          test values R^2 full regression model including              PRS  (mean_full_pred_r2,              sd_full_pred_r2): average R^2              full model including PRS +/- standard              deviation, predicted leave-test              values. R^2 reduced regression model              excluding PRS (mean_reduced_pred_r2,              sd_reduced_pred_r2): average R^2              reduced regression model, including             covariates excluding PRS, +/- standard              deviation, predicted leave-test              values. Adjusted R^2 PRS full model              contribution (mean_prs_pred_r2,              sd_prs_pred_r2): average adjusted R^2             full model, denoting contribution             PRS (essentially R^2 full model             minus R^2 reduced model), +/-             standard deviation, predicted leave-             test values. Significance full R^2 reduced R^2          (predicted) p-value Student's t-test              (ttest_full_reduced_pred_r2)              hypothesis mean R^2 full model              larger mean R^2 reduced model,              predicted test values. p-value Wiloxon rank sum test             (wilcox_full_reduced_pred_r2)              hypothesis median R^2 full model              larger median R^2 reduced              model, predicted test values. Empirical p-value              (empirical_full_reduced_pred_r2) denoting              number times R^2 full model              smaller R^2 reduced model across             number cross-validation iterations,             predicted test values.","code":""},{"path":"/reference/cvSumFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to summarize PRS cross-validations — cvSumFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/cvSumFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to summarize PRS cross-validations — cvSumFuns","text":"","code":"data(toy,package=\"prisma\")     data(prisma_out,package=\"prisma\")          response <- \"BMI\"     covariates <- c(\"Case_Control\",\"Gender\",\"Age\")          cvm <- prismaCrossValidate(prismaOut,toy,response=response,         covariates=covariates,leaveOut=c(0.2,0.4),times=5) #>  #> ################################################################ #> Running cross-validations for glm with 2 leave-out cases across 1 PRS candidates #> ################################################################ #>  #> ================================================================ #> -----> Cross-validating PRS candidate with 24 markers #> ================================================================ #>  #> ----- Leave-out percentage 20% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 40% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ################################################################ #> Running cross-validations for statgen with 2 leave-out cases across 1 PRS candidates #> ################################################################ #>  #> ================================================================ #> -----> Cross-validating PRS candidate with 4 markers #> ================================================================ #>  #> ----- Leave-out percentage 20% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 40% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ################################################################ #> Done! Use summarizeCvMetrics() and plotCvMetrics() to summarize and inspect the results. #> ################################################################     s <- summarizeCvMetrics(cvm[[\"glm\"]]) #> Summarizing cross-validation statistics for PRS with 24 SNPs     identical(names(cvm[[\"glm\"]]),names(s)) # TRUE #> [1] TRUE     identical(nrow(s[[1]]),2L) # TRUE #> [1] TRUE     # Has two leave-out sample percentages 20%, 40%          # Let's display summarized metrics for the 24-SNP PRS      # derived by GLM when leaving out 20% of the samples     # of the initial dataset     M <- cvm[[\"glm\"]][[\"24\"]][[\"0.2\"]]     cvSummary(M,nsnp=24,scr=TRUE) #>  #> ================================================================ #> PRISMA PRS cross-validation report #> ================================================================ #> Number of SNPs in PRS                                 : 24 #> Number of cross-validations                           : 5 #> Statistical significance of PRS in model              : 2.185e-09 #> ---------------------------------------------------------------- #> R^2 summary statistics #> R^2 of the full regression model including the PRS    : 0.7002 +/- 0.0416 #> R^2 of the reduced regression model excluding the PRS : 0.4469 +/- 0.039 #> Adjusted R^2 of the PRS full model contribution       : 0.2532 +/- 0.0499 #> ---------------------------------------------------------------- #> Statistical significance of full R^2 against reduced R^2 #> t-test         : 4.617e-06 #> Wilcoxon test  : 3.968e-03 #> Empirical test : 0 #> ---------------------------------------------------------------- #> RMSE summary statistics #> RMSE of the full regression model including the PRS    : 2.578 +/- 0.791 #> RMSE of the reduced regression model excluding the PRS : 3.603 +/- 0.7436 #> ---------------------------------------------------------------- #> Statistical significance of full RMSE against reduced RMSE #> t-test         : 9.661e-01 #> Wilcoxon test  : 9.841e-01 #> Empirical test : 1 #> ---------------------------------------------------------------- #> MAE summary statistics #> MAE of the full regression model including the PRS    : 1.9377 +/- 0.5275 #> MAE of the reduced regression model excluding the PRS : 2.7673 +/- 0.5733 #> ---------------------------------------------------------------- #> Statistical significance of full MAE against reduced MAE #> t-test         : 9.777e-01 #> Wilcoxon test  : 9.921e-01 #> Empirical test : 1 #> ---------------------------------------------------------------- #> Correlation summary statistics #> R between observed & predicted values with the full model    : 0.7943 +/- 0.1286 #> R between observed & predicted values with the reduced model : 0.6044 +/- 0.1684 #> ---------------------------------------------------------------- #> Statistical significance of full R against reduced R #> t-test         : 4.124e-02 #> Wilcoxon test  : 7.540e-02 #> Empirical test : 0 #> ---------------------------------------------------------------- #> R^2 summary statistics for the predicted test values #> R^2 from the full regression model including the PRS    : 0.6441 +/- 0.2069 #> R^2 from the reduced regression model excluding the PRS : 0.388 +/- 0.1825 #> Adjusted R^2 from the PRS full model contribution       : 0.2561 +/- 0.148 #> ---------------------------------------------------------------- #> Significance of full R^2 against reduced R^2 (predicted) #> t-test         : 3.603e-02 #> Wilcoxon test  : 7.540e-02 #> Empirical test : 0 #> ----------------------------------------------------------------          # Some metric plots (ggplot2 graphs)     cvo <- cvm[[1]]     p1 <- plotCvMetrics(cvo,what=\"r2\",pl=\"prs\") #> Creating cross-validation SNP plots for r2 #>   for 0.2 leave out samples fraction #>   for 0.4 leave out samples fraction     # p1     p2 <- plotCvMetrics(cvo,what=\"rmse\",pl=\"pct\") #> Creating cross-validation percentage plots for rmse     # p2"},{"path":"/reference/downloadExternalFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to download external GWA and PRS tools — downloadExternalFuns","title":"Functions to download external GWA and PRS tools — downloadExternalFuns","text":"functions can used download 3rd party tools     used within PRISMA. user may also download      outside R make sure findable     system, example included environmental      PATH variable. tool installed     within R automatically assigned directories,     also findable PRISMA. however     user chooses custom path, (e.g. using      path argument), added     PATH environmental variable order      findable PRISMA.     download installation process complete      (), funcitons update environmental variable      (R environment essentially).","code":""},{"path":"/reference/downloadExternalFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to download external GWA and PRS tools — downloadExternalFuns","text":"","code":"downloadExternalTools(tools = c(\"snptest\",\"plink\",\"prsice\",         \"impute\",\"gtool\",\"qctool\"),         ver = getDefaults(\"externalTools\"), path = NULL)          downloadGtool(ver = c(\"v0.7.5\"), path = NULL)          downloadImpute(ver = c(\"v2.3.2\"), path = NULL)          downloadPlink(ver = c(\"v1.90\"), path = NULL)          downloadPrsice(ver = c(\"v2.3.5\", \"v2.3.3\"), path = NULL)           downloadSnptest( ver = c(\"v2.5.6\", \"v2.5.4\", \"v2.5.2\"),         path = NULL)          downloadQctool(ver = c(\"v2.2.0\", \"v2.0.8\"), path = NULL)          download1000GP3(path = NULL)"},{"path":"/reference/downloadExternalFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to download external GWA and PRS tools — downloadExternalFuns","text":"tools tools required PRISMA     operations. One \"snptest\",     \"plink\",\"prsice\",\"impute\",     \"gtool\", \"qctool\". ver One supported tool versions. See     usage function. path tool's installation path path     download 1000 genomes imputation reference files.","code":""},{"path":"/reference/downloadExternalFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to download external GWA and PRS tools — downloadExternalFuns","text":"functions return value, update     environment holding paths tools.","code":""},{"path":"/reference/downloadExternalFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to download external GWA and PRS tools — downloadExternalFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/downloadExternalFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to download external GWA and PRS tools — downloadExternalFuns","text":"","code":"if (FALSE) {     downloadExternalTools(c(\"snptest\",\"plink\"))     downloadQctool()     download1000GP3() }"},{"path":"/reference/ebiQueryFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to query EBI GWAS and PGS Catalogs — ebiQueryFuns","title":"Functions to query EBI GWAS and PGS Catalogs — ebiQueryFuns","text":"functions can used retrieve PRS candidates     format data frames (compatible general     prisma output well one      aggregatePrsMarkers). can done     two sources, EBI PGS Catalog EBI GWAS Catalog     given one identifiers. functions build upon     gwasrapidd quincunx packages leverage     EBI APIs fetch required data. additional      feature regarding PGS scores quincunx     fetches metadata, getPGSScores actually fetches     combines (possible) PGS scores, alleles,     effects etc. , resulting data frames can used     GWASExperiment object either PRISMA     external validation pipeline PRScice2 (takes longer)     vanilla R regression cross-validation using     e.g. prsCrossValidate check     performance one traits present     GWASExperiment object.","code":""},{"path":"/reference/ebiQueryFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to query EBI GWAS and PGS Catalogs — ebiQueryFuns","text":"","code":"getGWASVariants(efoId = NULL, efoTrait = NULL,          removeUnknownRisk = TRUE, retries = 5)          getPGSScores(pgsId = NULL, efoId = NULL, pubmedId = NULL,         base = NULL, retries = 5, validateLoc = FALSE)          prismaLookup(prismaOut)"},{"path":"/reference/ebiQueryFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to query EBI GWAS and PGS Catalogs — ebiQueryFuns","text":"efoId One EFO ids proper format. See     also Details. efoTrait One EFO traits free text      format, existing. See also Details. pgsId One PGS ids proper format. See     also Details. pubmedId One PubMed ids proper format. retries number retries case API call     failures. removeUnknownRisk variants unknown risk     removed score GWAS Catalog? Defaults     TRUE. base base path PGS Catalog location.     can local path, see also Details. validateLoc Validate SNP locations retrieved     PGS scores? Defaults FALSE, see also Details. prismaOut output object prisma     list PRS candidate data frames.","code":""},{"path":"/reference/ebiQueryFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to query EBI GWAS and PGS Catalogs — ebiQueryFuns","text":"data frame one  aggregatePrsMarkers used GWASExperiment object accompanying input,     many values filled possible (e.g. GWAS     Catalog record variant regression effects.)     prismaLookup, list lists. outer     level named GWA methods prismaOut.     inner level named according PRS candidate     names GWA method prismaOut.","code":""},{"path":"/reference/ebiQueryFuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functions to query EBI GWAS and PGS Catalogs — ebiQueryFuns","text":"Regarding efoId argument, one     valid EFO ids GWAS Catalog proper     format (e.g. \"EFO_0004566\"). Improper format      detected rejected respective function.      applies pgsId argument      like \"PGS000034\" pubmedId format      like \"32527150\". Regarding base argument, can either     NULL (default) retrieve PGS score     link present quincunx API call metadata,     local path following structure PGS     catalog FTP storage. first case guaranteed     prone connection errors, depending also     operation system, especially multiple score     files must retrieved processed. second case     assumes scores PGS Catalog stored     somewhere locally (occupy much space).     can done example Linux wget     command:  Regarding validateLoc argument, case      duplicates remaining basic position/id/risk allele      deduplication, TRUE, performs location      validation, cases, duplicate rs ids      different locations (especially genome assembly      reported (\"nr\") potentially indicating      old genome assemblies (<hg18). process relies      package biomaRt uses query duplicate rs      ids cross-validate locations retrieved      Ensembl variation databases. SNPs locations      validated dropped deduplicated.      process involves calling Ensembl APIs, ma slow.      Therefore, intended use retrieved PRS      plugin SNPs GWAS data, validateLoc      can FALSE speed process reduce      failures, unique SNP ids used local      genotypes instead location. cases      strict validation required (e.g. ORs must      used reported, TRUE.","code":"mkdir -p LOCAL_PATH         cd LOCAL_PATH         wget -m ftp://anonymous:@ftp.ebi.ac.uk/pub/databases/spot/pgs/scores/                  # Then in R:         # base <- LOCAL_PATH/ftp.ebi.ac.uk/pub/databases/spot/pgs/scores/         # If the long path is not desired:                  cd LOCAL_PATH/ftp.ebi.ac.uk/pub/databases/spot/pgs/scores/         mv * ../../../../../../         cd LOCAL_PATH         rm -r ./ftp.ebi.ac.uk/pub/databases/spot/pgs/scores/                  # Then in R: base <- LOCAL_PATH"},{"path":"/reference/ebiQueryFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to query EBI GWAS and PGS Catalogs — ebiQueryFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/ebiQueryFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to query EBI GWAS and PGS Catalogs — ebiQueryFuns","text":"","code":"# \\donttest{     # Assume an internet connection!     efoId <- c(\"EFO_0004566\",\"EFO_0005937\")     efoTrait <- c(\"body weight gain\",         \"longitudinal BMI measurement\")           test1 <- getGWASVariants(efoId=efoId,         removeUnknownRisk=FALSE) #> Scheduling 2 GWAS API calls... #>   Requesting 2 GWAS API calls with  EFO ID(s)... #>     Call 1: EFO_0004566 #>     Call 2: EFO_0005937     test2 <- getGWASVariants(efoTrait=efoTrait) #> Scheduling 2 GWAS API calls... #>   Requesting 2 GWAS API calls with EFO trait(s)... #>     Call 1: body weight gain #>     Call 2: longitudinal BMI measurement          pgsId <- \"PGS000034\"     test3 <- getPGSScores(pgsId=pgsId) #> Scheduling 1 PGS API calls... #>   Requesting 1 PGS Catalog API calls with PGS ID(s)... #>     Call 1: PGS000034 #> Retrieving and enriching scores file(s) for PGS000034 #>   remote file PGS000034.txt.gz #>   processing PGS000034 #> Dealing with duplicates (if any)          data(prisma_out,package=\"prisma\")     lookup <- prismaLookup(prismaOut) #> -----> Querying for glm #> Querying GWAS Catalog with the largest PRS #>   Querying association 62070264 #> -----> Querying for statgen #> Querying GWAS Catalog with the largest PRS # }"},{"path":"/reference/enrichScoreFile.html","id":null,"dir":"Reference","previous_headings":"","what":"Enrichment of PGS Catalog retrieved scores — enrichScoreFile","title":"Enrichment of PGS Catalog retrieved scores — enrichScoreFile","text":"function try enrich PRS SNPs      information respective genome version     info already (e.g. PGS files     missing locations rs ids)","code":""},{"path":"/reference/enrichScoreFile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enrichment of PGS Catalog retrieved scores — enrichScoreFile","text":"","code":"enrichScoreFile(sf, gb = c(\"hg19\", \"hg38\", \"nr\"),         addGenes = FALSE, clean = FALSE)"},{"path":"/reference/enrichScoreFile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Enrichment of PGS Catalog retrieved scores — enrichScoreFile","text":"sf data frame created file retrieved      PGS Catalog. gb Human genome build, \"hg19\" (default),     hg19/GRCh37, \"hg38\" hg38/ GRCh38      \"nr\" unavailable. addGenes Try assign gene names using     Bioconductor sitadela package? Defaults FALSE. clean Keep matched SNPs dbSNP     genome version respect location. Default     FALSE.","code":""},{"path":"/reference/enrichScoreFile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Enrichment of PGS Catalog retrieved scores — enrichScoreFile","text":"data frame whatever information (    location, rs ids etc.) missing      retrieved.","code":""},{"path":"/reference/enrichScoreFile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Enrichment of PGS Catalog retrieved scores — enrichScoreFile","text":"\"gb\" provided (.e. retrieved PGS     Catalog respective quincunx API call),     function try enrich PRS SNPs      information respective genome version     info already (e.g. PGS files     missing locations rs ids). available     (\"nr\") simply known, function     try use enrichment information hg38.","code":""},{"path":"/reference/enrichScoreFile.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Enrichment of PGS Catalog retrieved scores — enrichScoreFile","text":"Panagiotis Moulos","code":""},{"path":"/reference/enrichScoreFile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Enrichment of PGS Catalog retrieved scores — enrichScoreFile","text":"","code":"scoreFile <- system.file(package=\"prisma\",\"extdata\",\"PGS000299.txt.gz\")     pgs <- read.delim(scoreFile,comment.char=\"#\")     pgse <- enrichScoreFile(pgs,addGenes=FALSE)     is(pgse,\"GPos\") # TRUE #> [1] TRUE"},{"path":"/reference/extendGWAS.html","id":null,"dir":"Reference","previous_headings":"","what":"External imputation of GWAS data using IMPUTE2 — extendGWAS","title":"External imputation of GWAS data using IMPUTE2 — extendGWAS","text":"function convenient wrapper around IMPUTE2     program imputing genotypes based initial      dataset genotyped SNPs reference panel based     population studies 1000 genomes project.","code":""},{"path":"/reference/extendGWAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"External imputation of GWAS data using IMPUTE2 — extendGWAS","text":"","code":"extendGWAS(obj, intSize = 1e+6, wspace = NULL,          refSpace = NULL, continue = FALSE,         cleanup = c(\"none\", \"intermediate\", \"all\"),         runId = NULL, convTool = c(\"gtool\", \"qctool\"),         rc = NULL)"},{"path":"/reference/extendGWAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"External imputation of GWAS data using IMPUTE2 — extendGWAS","text":"obj GWASEXperiment object. intSize interval size IMPUTE2     operate. Defaults 1e+6. See also     Details. wspace path directory used     IMPUTE2 workspace. NULL temporary      directory used, however intermediate files can     saved way. therefore advised     explicitly provide path. refSpace local directory IMPUTE2     reference panel files located. See also      link{download1000GP3} function. NULL     assumed files downloaded     default path used aforementioned function. continue Continue crashed imputation session?     Defaults FALSE initial run. See also     Details. cleanup cleanup level imputation      process. \"none\" (default) leaves      intermediate files intact \"intermediate\"     removes interval GEN files \"\" removes     entire wspace. runId identification string run.     used create subdirectory inside wspace.     provided (NULL, default), random string     generated. convTool conversion tool use GEN     PLINK file formats. Defaults \"gtool\". See     also Details. rc fraction available cores use.     used impute SNPs multiple genomic intervals     time.","code":""},{"path":"/reference/extendGWAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"External imputation of GWAS data using IMPUTE2 — extendGWAS","text":"(larger) GWASExperiment object imputed SNPs     based IMPUTE2 reference panel. Bare mind     SNP ids present initial     GWASExperiment object follow naming      format names SNPs present     reference panel used IMPUTE2.  gfeatures output augmented     one column INFO score returned IMPUTE2     denoting \"trustworthiness\" imputed position.","code":""},{"path":"/reference/extendGWAS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"External imputation of GWAS data using IMPUTE2 — extendGWAS","text":"Regarding intSize argument, controls     genomic interval (chromosome)     IMPUTE2 impute reference panel variants based     variants exist interval     obj. default IMPUTE2 operate     whole chromosomes process accurate     operating intervals take longer. Using     intervals also IMPUTE2 parallelized according     rc parameter. Regarding continue argument, can used     continue crashed imputation session, provided     path IMPUTE2 working space given      (wspace). function automatically      determines already done restarts     specific checkpoint. funcionality provided      imputation process may take long time, especially     GWASExperiments containing lot samples,     something go wrong resulting stop     process. Regarding \"cleanup\" argument, intermediate     files produced PLINK files GEN files produced     used IMPUTE2 also intermediate GEN files per     imputation interval. removed case     cleanup=\"intermediate\", also final      imputed PLINK files left workspace.     workspace deleted, output function can     recostructed using also runId, otherwise,      resulting GWASExperiment stored      RDA file later usage. Regarding convTool argument, controls     external tool used conversion     PLINK files GEN files vice-versa. default     \"gtool\" experienced crashed therefore     support \"qctool\" added. See also     downloadGtool      downloadQctool functions.","code":""},{"path":"/reference/extendGWAS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"External imputation of GWAS data using IMPUTE2 — extendGWAS","text":"Panagiotis Moulos","code":""},{"path":"/reference/extendGWAS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"External imputation of GWAS data using IMPUTE2 — extendGWAS","text":"","code":"if (FALSE) {     # The process may take long or crash because of the     # small sample size.     data(toy,package=\"prisma\")     toyEx <- extendGWAS(toy) }"},{"path":"/reference/filterGWAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate PRS candidate SNPs from iterative extraction — filterGWAS","title":"Aggregate PRS candidate SNPs from iterative extraction — filterGWAS","text":"function implements various genotype sample     filters based properties genotypic data     present input GWAS object. filters     losely based protocol Reed et al., 2015     (PubMed ID: 26343929).","code":""},{"path":"/reference/filterGWAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate PRS candidate SNPs from iterative extraction — filterGWAS","text":"","code":"filterGWAS(obj, filters = getDefaults(\"filters\"),         imputeMissing = TRUE, imputeMode = c(\"single\",\"split\"),         withPlink = FALSE, rc = NULL)"},{"path":"/reference/filterGWAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate PRS candidate SNPs from iterative extraction — filterGWAS","text":"obj object class GWASExperiment holding     genotypic data filtered. filters set genotype filters, see also Details     getDefaults. imputeMissing Impute remaining missing values     filtering? iterative imputation method based     package snpStats used, see also      imputeGWAS. imputeMode Perform imputation within     dataset (\"single\", default) split dataset     part containing missing values part     missing values (\"split\"), may happen large     dataset accurate. withPlink Perform basic filtering (IBD PCA)     PLINK instead snpStats. Maybe faster suitable     huge datasets less options. Defaults      FALSE. Also, case, filterRecord     filled. rc fraction available cores use      parallel calculations. Default NULL     parallelization.","code":""},{"path":"/reference/filterGWAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate PRS candidate SNPs from iterative extraction — filterGWAS","text":"filtered GWASExperiment object without     missing values according imputeMissing.","code":""},{"path":"/reference/filterGWAS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Aggregate PRS candidate SNPs from iterative extraction — filterGWAS","text":"Regarding filters argument, list     whose members denote SNP sample-based filters     values filter cutoffs. detailed     explanation filters can found Reed et      al., 2015 (PubMed ID: 26343929). following filters available: snpCallRate: SNPs call rate within         sample. Defaults 0.98. sampleCallRate: sample call rate         SNPs accross samples. Defaults 0.95. maf: Minimum Allele Frequency across         samples, SNPs filtered. Defaults          0.05. hwe: Hardy-Weinberg equilibrium          p-value. Defaults 1e-6. heteroStat: statistic         heterozygosity distribution center defined.          Defaults \"median\". heteroFac: factor          scale (standard deviation, MAD) heterozygosity         distribution multiplied added         heteroStat create range acceptable         heterozygosity values, e.g. mean +/- 3*std. Defaults         3. heteroStat=\"mean\", scale         standard deviation.          heteroStat=\"median\", scale MAD. heteroHard: hard filter          heterozygosity values. set, heteroStat         heteroFac ignored. pcaOut: Automatically remove samples          based PCA filtering? Defaults TRUE         avoided datasets samples.         Also, applied robust PCA method chosen. pcaRobust: robust PCA method         applied sample exclustion. One \"grid\"         \"hubert\" (default). See package rrcov         details. nPC: Fixed number PCs use PCA         filtering. NA (default),          determined using twTest. LD: Linkage Disequilibrium filter          (calculated using package SNPRelate fuctions).         Defaults 0.2. IBD: Identity Descent filter          (calculated using package SNPRelate fuctions).         Defaults 0.2. inbreed: Inbreed coefficient filter.         Defaults 0.1. See also output getDefaults(\"filters\").","code":""},{"path":"/reference/filterGWAS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Aggregate PRS candidate SNPs from iterative extraction — filterGWAS","text":"Panagiotis Moulos","code":""},{"path":"/reference/filterGWAS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregate PRS candidate SNPs from iterative extraction — filterGWAS","text":"","code":"data(toy,package=\"prisma\")     gdsfile(toy) <- system.file(package=\"prisma\",         \"extdata\",\"toy.gds\")      # Lose filters for the toy dataset     filts <- getDefaults(\"filters\")     filts$IBD <- NA     filts$hwe <- 1e-3     filts$pcaOut <- FALSE     filts$inbreed <- NA          toyF <- filterGWAS(toy,filters=filts,         imputeMissing=FALSE) #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 119 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>               # With PLINK     if (Sys.which(\"plink\") != \"\")         toyF <- filterGWAS(toy,filters=filts,             imputeMissing=FALSE,withPlink=TRUE) #>  #> Performing basic filtering #>   Exporting temporary PLINK files for the calculations #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/file381e44242d9d.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/file381e44242d9d.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/file381e44242d9d.bed (SNP-major mode) #>  #> Executing: #> /home/panos/.local/share/R/plink-1.90/plink \\ #>   --bfile /tmp/Rtmpxo9Dha/file381e44242d9d \\ #>   --out /tmp/Rtmpxo9Dha/file381e3dbfafea --het #>  #> Executing: #> /home/panos/.local/share/R/plink-1.90/plink \\ #>   --bfile /tmp/Rtmpxo9Dha/file381e44242d9d \\ #>   --out /tmp/Rtmpxo9Dha/file381e3dbfafea \\ #>   --make-bed \\ #>   --geno 0.02 \\ #>   --maf 0.05 \\ #>   --hwe 0.001 \\ #>   --mind 0.05 #> Reading PLINK files with snpStats framework #> 881 SNPs and 100 samples remaining"},{"path":"/reference/getDefaults.html","id":null,"dir":"Reference","previous_headings":"","what":"Get default parameters for several prisma functions — getDefaults","title":"Get default parameters for several prisma functions — getDefaults","text":"function hard-codes default options many      prisma functionalities, genotype filtering,     genome-wide association testing various algorithms     polygenic risk score extraction algorithms.","code":""},{"path":"/reference/getDefaults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get default parameters for several prisma functions — getDefaults","text":"","code":"getDefaults(what)"},{"path":"/reference/getDefaults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get default parameters for several prisma functions — getDefaults","text":"get parameters . can one     \"filters\", \"glm\", \"rrblup\",     \"statgen\", \"snptest\", \"plink\",     \"externalTools\", \"lassosum\",      \"prsice\".","code":""},{"path":"/reference/getDefaults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get default parameters for several prisma functions — getDefaults","text":"named list parameters corresponding  asked.","code":""},{"path":"/reference/getDefaults.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Get default parameters for several prisma functions — getDefaults","text":"Panagiotis Moulos","code":""},{"path":"/reference/getDefaults.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get default parameters for several prisma functions — getDefaults","text":"","code":"filterDefaults <- getDefaults(\"filters\")          snptestDefaults <- getDefaults(\"snptest\")"},{"path":"/reference/gwaFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to perform GWA tests with various algorithms — gwaFuns","title":"Functions to perform GWA tests with various algorithms — gwaFuns","text":"functions perform association tests create      summary statistics GWA dataset prior      extraction PRS candidates. part      overall PRISMA workflow (prisma)     designed also used independently just look     univariate association cases, .e. look      associations single trait using various tests.","code":""},{"path":"/reference/gwaFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to perform GWA tests with various algorithms — gwaFuns","text":"","code":"gwa(obj, response, covariates = NULL, pcs = FALSE,         psig = 0.05, methods = c(\"glm\", \"rrblup\", \"statgen\",             \"snptest\", \"plink\", \"lasso\"),         combine = c(\"fisher\", \"simes\", \"max\", \"min\", \"harmonic\",             \"whitlock\",\"pandora\"), glmOpts = getDefaults(\"glm\"),         rrblupOpts = getDefaults(\"rrblup\"),          statgenOpts = getDefaults(\"statgen\"),         snptestOpts = getDefaults(\"snptest\"),         plinkOpts = getDefaults(\"plink\"), rc = NULL, ...)          gwaBlup(obj, response, covariates = NULL,          usepc = c(\"auto\", \"estim\", \"rrint\", \"fixed\", \"none\"),          npcs = NULL, psig = 0.05, rc = NULL)          gwaGlm(obj, response, covariates = NULL, pcs = FALSE,         family = NULL, psig = 0.05, penalized = FALSE,         size = 1, rc = NULL, ...)              gwaPlink(obj, response, covariates = NULL, pcs = TRUE,         psig = 0.05, seed = 42, cliopts = NULL, wspace = NULL,          rc = NULL)          gwaStatgen(obj, response, covariates = NULL, pcs = TRUE,          psig = 0.05, rc = NULL)          gwaSnptest(obj, response, covariates = NULL, pcs = TRUE,         psig = 0.05, test = c(\"frequentist\", \"bayesian\"),          model = c(\"additive\", \"dominant\", \"recessive\",          \"general\", \"heterozygote\"), wspace = NULL)"},{"path":"/reference/gwaFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to perform GWA tests with various algorithms — gwaFuns","text":"obj object class GWASExperiment holding     genotypic phenotypic data used association     tests. response trait associations      searched . character length 1      exist phenotypes obj. covariates covariates include association     methods/regression models. character vector      traits existing phenotypes obj. pcs Inlcude PCs association models? Defaults     FALSE. psig significance level (p-value cutoff)     association SNP/marker phenotype      (response) considered significant. Defaults     0.05. methods GWA methods apply obj     respect response covariates. can     one \"glm\", \"rrblup\", \"statgen\",     \"snptest\", \"plink\", \"lasso\". See also     Details explanation case. combine () p-values combined     produce summarized p-value GWA methods     association test. methods yet available,     see also Details. glmOpts list options GLM regression      model fit. See also Details. rrblupOpts list options ridge regression      model fit (rrBLUP). See also Details. statgenOpts list options regression fit     statgenGWAS. See also Details. snptestOpts list options modeling     associations SNPTEST. See also Details. plinkOpts list options modeling     associations PLINK. See also Details. usepc PCA PCs using     gwaBlup rrBLUP model fitting. Defaults     \"auto\" also \"rrint\" preferred.     See also Details. npcs Number PCs use rrBLUP. Defaults     NULL auto-determining . family model family GLM, e.g.      \"gaussian\" classic regression continuous     response variable \"binomial\" logistic     regression. default (NULL), guessed     form response variable. penalized Use penalized (LASSO) regression     GLM. Defaults FALSE. size number SNPs include GLM      model, usually utilized penalized=TRUE.     Defaults 1 models 1 SNP      covariate. wspace path create workspaces temporary     files SNPTEST PLINK operate outside R. test One supported test types SNPTEST.     can \"frequentist\" (default)      \"bayesian\". See also SNPTEST documentation. seed random seed PLINK resampling      operations. Defaults 42. cliopts string additional command-line     parameters pass PLINK executable. Defaults     NULL. model One supported genotype modeling     types SNPTEST. can one \"additive\"     (default), \"dominant\", \"recessive\",     \"general\" \"heterozygote\". See also     SNPTEST documentation. rc fraction available cores use      parallel calculations. Default NULL     parallelization. ... Additional arguments passed regression     functions.","code":""},{"path":"/reference/gwaFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to perform GWA tests with various algorithms — gwaFuns","text":"Depending function used, either data frame     summary statistics (always least SNP     name, effects/ORs p-values)","code":""},{"path":"/reference/gwaFuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functions to perform GWA tests with various algorithms — gwaFuns","text":"Regarding methods argument, following     briefly explain associations modeled     case: glm: case, SNP checked         association response trait         using General Linear Regression model         form: response ~ covariates + [SNP]         response ~ covariates + pcs + [SNP]         depending whether PCs added covariates         . [SNP] simply recorded genotype         (0 homozygous minor allele, 1         heterozygous allele 2 homozygous         major allele). p-value regression         coefficient (effect/) [SNP] recorded         used determine SNP associated         covariate . function can         used independently directly using gwaGlm.         case, data frame summary statistics         returned instead input          GWASExperiment. rrblup: case,          GWAS function package         rrBLUP used model associations,         effects significance SNP using         Ridge Regression. function can used         independently directly using gwaBlup.         case, data frame ridge regression          summary statistics returned instead          input GWASExperiment. statgen: case,         runSingleTraitGwas function         statgenGWAS package used model          associations, effects significance          SNP using also linear regression.          function can used independently directly          using gwaStatgen. case, data          frame summary statistics returned instead          input GWASExperiment. snptest: case, SNPTEST         software used check associations         summary statistics. noted         SNPTEST operates least 100 samples.         function can used directly previous          ones gwaSnptest. plink: case, PLINK         software used check associations         return summary statistics. function can used         directly previous ones gwaPlink. Regarding combine argument, used     control p-values returned usage many     association tests combined produce      summarized p-value. Currently \"whitlock\",      \"pandora\" \"harmonic\" placeholders     since estimation p-value weights work     progress. rest, please see Moulos Hatzis,     2015 (PMID: 25452340) Fanidis Moulos, 2021      (PMID: 32778872). Regarding glmOpts argument, named     list members: family: regression family,         defaults NULL auto-detection. size: number sequential SNPs         include lasso regression model (currently         testing mode). Regarding rrblupOpts argument,      named list members: pcblup: PCs included         ridge regression calculated? Defaults         \"auto\", see main function arguments         rest options. npcs: number PCs include. Regarding statgenOpts argument,      named list members: kinship: kinship matrix estimation         method, included statgenGWAS model         fitting. Defaults \"astle\", see         statgenGWAS package options. reml: method calculated         Restricted Maximum Likelihood statgenGWAS         model fitting. Defaults \"EMMA\", see         statgenGWAS package options. gls: method used estimate         SNP effects, \"signle\" (default) using         single kinship matrix, \"multi\"          using chromosome specific kinship matrices. See         statgenGWAS package explanations. Regarding snptestOpts argument,      named list members: test: type test used (see         also main arguments ). Defaults          \"frequentist\". See also SNPTEST documentation. model: genotype effect estimation         mode, defaults \"additive\", See also main         arguments SNPTEST documentation. workspace: path SNPTEST         temporary workspace. Defaults NULL         using tempdir. provided         maximum control. Regarding plinkOpts argument,     named list members: effect: effects         modeled SNP (similar model         SNPTEST). Please see PLINK documentation         full list options. seed: seed PLINK randomized          operations resampling permuting.         Defaults 42. cliopts: options passed         plink command, given         command line. Please note         switched options accepting numbers srings         _not_ input/output files. Regarding usepc argument gwaBlup,     can one \"auto\", \"estim\",     \"rrint\", \"fixed\" \"none\".     controls rrBLUP models use PCs generic     ridge regression model. following available: \"auto\": automated mode,         input object contains calculated PCs         used covariates, used, otherwise         optimal number estimate (switch          \"estim\".) \"estim\": Automatic iterative estimation. \"rrint\": case, number PCs         include taken existing PCs input         GWASExperiment object, npcs         argument PCs input. ,         number used internally GWAS         rrBLUP function include PCs model. Although         default, seems         stable method recommended used. \"fixed\": uses npcs         (similar way \"auto\".) \"none\": include PCs         model.","code":""},{"path":"/reference/gwaFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to perform GWA tests with various algorithms — gwaFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/gwaFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to perform GWA tests with various algorithms — gwaFuns","text":"","code":"data(toy,package=\"prisma\")     gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")          # Only 1 PC will be returned because of dataset size     toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) #> Performing PCA to select covariates to include in associations #> Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... #> Performing LD pruning... #> SNP pruning based on LD: #> Excluding 0 SNP (non-autosomes or non-selection) #> Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) #>     # of samples: 100 #>     # of SNPs: 962 #>     using 1 thread #>     sliding window: 500,000 basepairs, Inf SNPs #>     |LD| threshold: 0.2 #>     method: composite #> Chromosome 18: 23.44%, 154/657 #> Chromosome 21: 21.28%, 73/343 #> 227 markers are selected in total. #> LD pruning finished! 227 SNPs will be used for PCA. #>  #> Performing PCA... #> Principal Component Analysis (PCA) on genotypes: #> Excluding 773 SNPs (non-autosomes or non-selection) #> Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) #>     # of samples: 100 #>     # of SNPs: 227 #>     using 1 thread #>     # of principal components: 32 #> PCA:    the sum of all selected genotypes (0,1,2) = 10268 #> CPU capabilities: Double-Precision SSE2 #> Mon Jun  6 20:06:52 2022    (internal increment: 13024) #>  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s #> Mon Jun  6 20:06:52 2022    Begin (eigenvalues and eigenvectors) #> Mon Jun  6 20:06:52 2022    Done. #> Selecting number of PCs to include #>   with Tracy-Widom test for significant eigenvalues #>     selected 1 PCs          toyG <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),         pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\")) #>  #> Starting GWA analysis in 2 chunks with 2 methods: glm, statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : Yes #>   testing SNPs from rs1009238 to rs1568327 #> Found 24 associations (uncorrected p-values). #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #> Found 24 associations (uncorrected p-values). #>  #> Combining p-values from multi-GWAS using fisher method #>  #> Overall, found 54 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : Yes #>   testing SNPs from rs2824974 to rs2828316 #> Found 18 associations (uncorrected p-values). #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #> Found 18 associations (uncorrected p-values). #>  #> Combining p-values from multi-GWAS using fisher method #>  #> Overall, found 35 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 54 associations found out of 657 markers #>   Part 21: 35 associations found out of 343 markers #>  #> Overall, found 89 associations with (uncorrected) combined p-values).          glmSumstat <- gwaGlm(toy,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),pcs=TRUE) #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : Yes #>   testing SNPs from rs1009238 to rs2828316 #> Found 42 associations (uncorrected p-values).          rrSumstat <- gwaBlup(toy,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),usepc=\"rrint\",npcs=1) #>  #> Preparing genotypes for rrBLUP... #> Performing GWAS with rrBLUP model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #> Found 55 associations (uncorrected p-values).          sgSumstat <- gwaStatgen(toy,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),pcs=TRUE) #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #> Found 42 associations (uncorrected p-values).          if (Sys.which(\"snptest\") != \"\")         snpSumstat <- gwaSnptest(toy,response=\"BMI\",             covariates=c(\"Age\",\"Gender\"),pcs=TRUE) #> snptest operations will be executed at /tmp/Rtmpxo9Dha/snptest_AZQIL3254L #> Preparing SNPTEST association run at workspace directory: /tmp/Rtmpxo9Dha/snptest_AZQIL3254L #>  writing SNPTEST sample file in /tmp/Rtmpxo9Dha/snptest_AZQIL3254L #>   writing PLINK files in /tmp/Rtmpxo9Dha/snptest_AZQIL3254L #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/snptest_AZQIL3254L/plink_snptest_DPKHE3458Z.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/snptest_AZQIL3254L/plink_snptest_DPKHE3458Z.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/snptest_AZQIL3254L/plink_snptest_DPKHE3458Z.bed (SNP-major mode) #> Preparation done! #>  #> Performing GWAS with SNPTEST #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #>  #> Executing: #> /home/panos/.local/share/R/snptest-2.5.4/snptest \\ #>   -data /tmp/Rtmpxo9Dha/snptest_AZQIL3254L/plink_snptest_DPKHE3458Z.bed \\ #>     /tmp/Rtmpxo9Dha/snptest_AZQIL3254L/pheno.sample \\ #>   -frequentist 1 \\ #>   -method score \\ #>   -pheno BMI \\ #>   -cov_all \\ #>   -o /tmp/Rtmpxo9Dha/snptest_AZQIL3254L/snptest.out #> Found 38 associations (uncorrected p-values).          if (Sys.which(\"plink\") != \"\")         plSumstat <- gwaPlink(toy,response=\"BMI\",             covariates=c(\"Age\",\"Gender\"),pcs=TRUE) #> plink operations will be executed at /tmp/Rtmpxo9Dha/plink_PIICY8094S #> Preparing PLINK association run at workspace directory: /tmp/Rtmpxo9Dha/plink_PIICY8094S #>   writing the PLINK phenotype file... #>   writing the covariates file... #>   writing PLINK genotype files in /tmp/Rtmpxo9Dha/plink_PIICY8094S #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/plink_PIICY8094S/plink_plink_QJCXD6659L.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/plink_PIICY8094S/plink_plink_QJCXD6659L.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/plink_PIICY8094S/plink_plink_QJCXD6659L.bed (SNP-major mode) #> Preparation done! #>  #> Performing GWAS with PLINK #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #>  #> Executing: #> /home/panos/.local/share/R/plink-1.90/plink \\ #>   --bfile /tmp/Rtmpxo9Dha/plink_PIICY8094S/plink_plink_QJCXD6659L \\ #>   --pheno /tmp/Rtmpxo9Dha/plink_PIICY8094S/pheno_QJCXD6659L \\ #>   --allow-no-sex \\ #>   --ci 0.95 \\ #>   --seed 42 \\ #>   --out /tmp/Rtmpxo9Dha/plink_PIICY8094S/out_QJCXD6659L \\ #>   --covar /tmp/Rtmpxo9Dha/plink_PIICY8094S/covar_QJCXD6659L \\ #>   --linear perm #> Found 43 associations (uncorrected p-values)."},{"path":"/reference/gweConvertFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to convert GWASExperiment to other classes — gweConvertFuns","title":"Functions to convert GWASExperiment to other classes — gweConvertFuns","text":"functions either convert GWASExperiment      another object file required functionalities      supporting packages, convert human     genome coordinate systems. Finally, facilitate     conversion process required, functionality     \"guess\" human genome version provided.","code":""},{"path":"/reference/gweConvertFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to convert GWASExperiment to other classes — gweConvertFuns","text":"","code":"GWASExperiment2gData(obj, covariates = NULL, pcs = FALSE,         reverse = FALSE)          GWASExperiment2GDS(obj)          GWASExperimentLiftOver(obj, from, to)          guessHumanGenomeVersion(obj)"},{"path":"/reference/gweConvertFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to convert GWASExperiment to other classes — gweConvertFuns","text":"obj GWASExperiment object. covariates covariates include     gData object (package statgenGWAS) including     response phenotype. pcs include PCs present obj     gData object? Defaults FALSE. reverse reverse genotypes construction     gData object? Defaults FALSE. source genome version, one      \"hg19\" \"hg38\". target genome version, one      \"hg19\" \"hg38\".","code":""},{"path":"/reference/gweConvertFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to convert GWASExperiment to other classes — gweConvertFuns","text":"GWASExperiment2gData, gData object     can used functions statgenGWAS      package.     GWASExperiment2GDS, GDS file written     location specified gdsfile(obj).    GWASExperimentLiftOver,      GWASExperiment object returned, changed SNP      positions one genome version .     SNPs may dropped inability liftOver     algorithm map versions (rare).     guessHumanGenomeVersion, string denoting     guessed human genome version (\"hg19\"  \"hg38\").","code":""},{"path":"/reference/gweConvertFuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functions to convert GWASExperiment to other classes — gweConvertFuns","text":"Regarding guessHumanGenomeVersion function,     queries dbSNP 5 random SNPs present obj     using package rsnps. Depending result,     genome version guessed.","code":""},{"path":"/reference/gweConvertFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to convert GWASExperiment to other classes — gweConvertFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/gweConvertFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to convert GWASExperiment to other classes — gweConvertFuns","text":"","code":"data(toy,package=\"prisma\")          # There are some non-numeric phenotypes - ignore     gd <- suppressWarnings(GWASExperiment2gData(toy))          gdsfile(toy) <- tempfile()     GWASExperiment2GDS(toy) #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/file381e283d2d60.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/file381e283d2d60.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/file381e283d2d60.bed (SNP-major mode) #> Start file conversion from PLINK BED to SNP GDS ... #>     BED file: '/tmp/Rtmpxo9Dha/file381e283d2d60.bed' #>         SNP-major mode (Sample X SNP), 24.4K #>     FAM file: '/tmp/Rtmpxo9Dha/file381e283d2d60.fam' #>     BIM file: '/tmp/Rtmpxo9Dha/file381e283d2d60.bim' #> Mon Jun  6 20:07:30 2022     (store sample id, snp id, position, and chromosome) #>     start writing: 100 samples, 1000 SNPs ... #>  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s #> Mon Jun  6 20:07:30 2022 \tDone. #> Optimize the access efficiency ... #> Clean up the fragments of GDS file: #>     open the file '/tmp/Rtmpxo9Dha/file381e451c56ad' (34.6K) #>     # of fragments: 50 #>     save to '/tmp/Rtmpxo9Dha/file381e451c56ad.tmp' #>     rename '/tmp/Rtmpxo9Dha/file381e451c56ad.tmp' (34.3K, reduced: 312B) #>     # of fragments: 24     file.exists(gdsfile(toy)) # TRUE #> [1] TRUE          genome(toy) # hg19 #> [1] \"hg19\"     toy2 <- GWASExperimentLiftOver(toy,from=\"hg19\",         to=\"hg38\") #> Lifting over features #>   lifting chr18 #>   lifting chr21          guessHumanGenomeVersion(toy) # hg19 #> Getting info about the following rsIDs: rs238146, rs273746, rs13048320, rs4798085 #> [1] \"hg19\""},{"path":"/reference/harvestWorkspace.html","id":null,"dir":"Reference","previous_headings":"","what":"Reconstruct various prisma outputs from a workspace — harvestWorkspace","title":"Reconstruct various prisma outputs from a workspace — harvestWorkspace","text":"function checks traverses path supposed     valid prisma workspace, either provided user     auto-generated, reads existing results returns     structure suitable pipeline continuation usable     prisma functions. function can directly     used user break prisma steps better      monitoring continue previously interrupted pipeline.     extensively used continue=TRUE     respective pipelines support continuation     possible failure.","code":""},{"path":"/reference/harvestWorkspace.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reconstruct various prisma outputs from a workspace — harvestWorkspace","text":"","code":"harvestWorkspace(wspace, rid, denovo = TRUE, fast = FALSE)"},{"path":"/reference/harvestWorkspace.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reconstruct various prisma outputs from a workspace — harvestWorkspace","text":"wspace path prisma workspace. rid prisma run id. denovo workspace contain results     denovo PRS pipeline execution? fast workspace contain results     PRS pipeline fast validation? (see prisma     details.)","code":""},{"path":"/reference/harvestWorkspace.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reconstruct various prisma outputs from a workspace — harvestWorkspace","text":"list data frame prisma pipeline outcomes,     according (auto-detected) run type.","code":""},{"path":"/reference/harvestWorkspace.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Reconstruct various prisma outputs from a workspace — harvestWorkspace","text":"important note prisma creates workspace     paths certain attributes differentiate     random paths. One attribute     prisma workspace expected contain least: JSON file params.json stored         parameters analysis continuation prisma iteration directories named         certain convention according run type.","code":""},{"path":"/reference/harvestWorkspace.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Reconstruct various prisma outputs from a workspace — harvestWorkspace","text":"Panagiotis Moulos","code":""},{"path":"/reference/harvestWorkspace.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reconstruct various prisma outputs from a workspace — harvestWorkspace","text":"","code":"wspace <- \"/my/local/path\"          #output <- harvestWorkspace(wspace)"},{"path":"/reference/importGWAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Create GWASExperiments from PLINK files — importGWAS","title":"Create GWASExperiments from PLINK files — importGWAS","text":"function creates GWASExperiment object     PLINK BED/BIM/FAM files using functions     package snpStats. future, importing     package bigSNP supported.","code":""},{"path":"/reference/importGWAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create GWASExperiments from PLINK files — importGWAS","text":"","code":"importGWAS(input, phenos = NULL, backend = c(\"snpStats\",         \"bigsnpr\"), selection = NULL, genome = NA_character_,         alleleOrder = c(\"plink\", \"reverse\"), writeGds = TRUE,         gdsfile = ifelse(backend == \"snpStats\", tempfile(), NA),         gdsOverwrite = TRUE)"},{"path":"/reference/importGWAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create GWASExperiments from PLINK files — importGWAS","text":"input list full path PLINK file      triplet (BED/BIM/FAM) string triplet      basename suffixed bed/bim/fam. See     als Details. phenos data frame file dataset     phenotypes. must number rows     samples present PLINK triplet. backend R backend use object management.     See Details. selection list members named snps     samples used related      select.snps select.subjects arguments     read.plink function snpStats. genome reference genome SNPs     mapped . Typically one \"hg19\"      \"hg38\" information available, otherwise     NA. alleleOrder alleles reversed? yes     choose \"reverse\". writeGds Write GDS supporting file      importing PLINK files? cases reading     files external imputation needed. Defaults      TRUE. gdsfile GDS file supported package     SNPRelate necessary operations like     SNPRelate PCA LD. written?     adivsed explicitly provide path. gdsOverwrite overwrite provided GDS file     exists? Defaults TRUE.","code":""},{"path":"/reference/importGWAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create GWASExperiments from PLINK files — importGWAS","text":"GWASExperiment object contents PLINK     files triplet optionally, additional associated     phenotypes.","code":""},{"path":"/reference/importGWAS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create GWASExperiments from PLINK files — importGWAS","text":"Regarding input argument, list,     latter must named members names bed,     bim, fam. single string,     must point full path triplet found     must end bim, bed,      fam appended base. Regarding backend argument, current PRISMA     design goals support importing processing     data R package snpStats R package      bigSNP. Currently, snpStats supported.","code":""},{"path":"/reference/importGWAS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create GWASExperiments from PLINK files — importGWAS","text":"Panagiotis Moulos","code":""},{"path":"/reference/importGWAS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create GWASExperiments from PLINK files — importGWAS","text":"","code":"fam <- system.file(\"extdata/sample.fam\",package=\"snpStats\")     bim <- system.file(\"extdata/sample.bim\",package=\"snpStats\")     bed <- system.file(\"extdata/sample.bed\",package=\"snpStats\")     input <- list(fam=fam,bim=bim,bed=bed)     sample <- snpStats::read.plink(input$bed,input$bim,input$fam)          # Without phenotypes     gwe <- importGWAS(input,backend=\"snpStats\") #> Reading PLINK files with snpStats framework #> Reading PLINK files with SNPRelate framework and storing output tp /tmp/Rtmpxo9Dha/file381e758455ea #> Start file conversion from PLINK BED to SNP GDS ... #>     BED file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bed' #>         SNP-major mode (Sample X SNP), 603 bytes #>     FAM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.fam' #>     BIM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bim' #> Mon Jun  6 20:07:41 2022     (store sample id, snp id, position, and chromosome) #>     start writing: 120 samples, 20 SNPs ... #>  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s #> Mon Jun  6 20:07:41 2022 \tDone. #> Optimize the access efficiency ... #> Clean up the fragments of GDS file: #>     open the file '/tmp/Rtmpxo9Dha/file381e758455ea' (5.1K) #>     # of fragments: 50 #>     save to '/tmp/Rtmpxo9Dha/file381e758455ea.tmp' #>     rename '/tmp/Rtmpxo9Dha/file381e758455ea.tmp' (4.8K, reduced: 312B) #>     # of fragments: 24          # With phenotypes     set.seed(42)     pseudopheno <- data.frame(         case_control=sample(c(0,1),nrow(sample$fam),replace=TRUE),         other_pheno=sample(c(\"drug\",\"nodrug\"),nrow(sample$fam),replace=TRUE),         cont=round(runif(nrow(sample$fam)),3),         row.names=rownames(sample$fam)     )     gwe <- importGWAS(input,phenos=pseudopheno,backend=\"snpStats\") #> Reading PLINK files with snpStats framework #> Reading PLINK files with SNPRelate framework and storing output tp /tmp/Rtmpxo9Dha/file381eb4f614c #> Start file conversion from PLINK BED to SNP GDS ... #>     BED file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bed' #>         SNP-major mode (Sample X SNP), 603 bytes #>     FAM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.fam' #>     BIM file: '/home/panos/R/x86_64-pc-linux-gnu-library/4.1/snpStats/extdata/sample.bim' #> Mon Jun  6 20:07:41 2022     (store sample id, snp id, position, and chromosome) #>     start writing: 120 samples, 20 SNPs ... #>  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s #> Mon Jun  6 20:07:41 2022 \tDone. #> Optimize the access efficiency ... #> Clean up the fragments of GDS file: #>     open the file '/tmp/Rtmpxo9Dha/file381eb4f614c' (5.1K) #>     # of fragments: 50 #>     save to '/tmp/Rtmpxo9Dha/file381eb4f614c.tmp' #>     rename '/tmp/Rtmpxo9Dha/file381eb4f614c.tmp' (4.8K, reduced: 312B) #>     # of fragments: 24"},{"path":"/reference/imputeGWAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Genotype imputation for GWASExperiment objects — imputeGWAS","title":"Genotype imputation for GWASExperiment objects — imputeGWAS","text":"function performs internal imputation     GWASExperiment object using combined approach     fucntionalities snpStats packages     scrime package. internal imputation PRISMA refers     missing genotype imputation within dataset     using existing genotypes _within_ dataset     impute missing genotypes. confused     imputation based external reference panel     1000 Genomes Project can used     impute extend dataset include      non-genotyped SNPs/markers. process also      available PRISMA refered \"extension\"     (see also extendGWAS function.)","code":""},{"path":"/reference/imputeGWAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genotype imputation for GWASExperiment objects — imputeGWAS","text":"","code":"imputeGWAS(obj, mode = c(\"single\", \"split\"),         failed = c(\"scrime\", \"none\"), rc = NULL)"},{"path":"/reference/imputeGWAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genotype imputation for GWASExperiment objects — imputeGWAS","text":"obj GWASExperiment object missing     genotype values imputed. mode Perform imputation within     dataset (\"single\", default) split dataset     part containing missing values part     missing values (\"split\"). See also Details     Description explanation internal      imputation process. failed genotypes failed      imputed iterative regression process? Impute     kNN scrime package (\"scrime\",      default) imputation (\"none\"). rc fraction available cores use      parallel calculations. Default NULL     parallelization.","code":""},{"path":"/reference/imputeGWAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genotype imputation for GWASExperiment objects — imputeGWAS","text":"GWASExpriment object      (failed=\"scrime\") missing values fewer     (failed=\"none\") missing values genotypes.","code":""},{"path":"/reference/imputeGWAS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Genotype imputation for GWASExperiment objects — imputeGWAS","text":"Regarding mode argument, controls     imputation based snpStats functions      (snp.imputation) performed.     mode=\"single\", imputation rules     created within total initial dataset without     splitting \"better\" \"worse\" dataset terms     missing value content. mode=\"split\",     dataset split part containing samples     missing values part samples without missing     values. realistic smaller datasets     may happen large dataset accurate.     splitting chosen small datasets, likely     imputation rules created     small number samples, resulting fewer rules (.e.     fewer SNPs can imputed) poorer accuracy. internal imputation process PRISMA split     two phases: Phase 1: genotypes          GWASExperiment input used create         imputation rules (respective function         snpStats). rules essentially linear         regression models model potential predictions         SNP genotypes according nearby genotypes         present high R^2 values therefore can used         provide missing cases relatively good          accuracy. process iteratively deployed          PRISMA, imputation rules can         produced, .e. result imputation         iteration used create new rules impute         SNPs possible, new rules         can produced. Phase 2: phase, missing genotypes         imputed iterative process         Phase 1, imputed k-nearest neighbor         algorithm genotype imputation R package         scrime. step optional. Phase 3: Missing genotypes         imputed scrime package Phase 2         replaced global average genotype         rest genotypes. phase optional         quite rare needed.","code":""},{"path":"/reference/imputeGWAS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Genotype imputation for GWASExperiment objects — imputeGWAS","text":"Panagiotis Moulos","code":""},{"path":"/reference/imputeGWAS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genotype imputation for GWASExperiment objects — imputeGWAS","text":"","code":"data(toy,package=\"prisma\")          # Make some genotypes missing     set.seed(42)     toMiss <- lapply(seq_len(ncol(toy)),function(j) {         n <- sample(20,1)         miss <- logical(nrow(toy))         miss[sample(nrow(toy),n)] <- TRUE         return(miss)     })          G <- as(genotypes(toy),\"numeric\") + 1     mode(G) <- \"integer\"     for (j in seq_len(ncol(toy)))         G[toMiss[[j]],j] <- 0L     G <- SnpMatrix(G) #> coercing object of mode  numeric  to SnpMatrix     genotypes(toy) <- G          toyI <- imputeGWAS(toy,fail=\"none\") #>  #> Imputing missing values with snpStats rules #>  #> Starting imputation analysis in 2 chunks #>  #> ========== Imputing chromosome/part 18 #> -----> Imputation iteration 1 #> Creating imputation rules #> SNPs tagged by a single SNP: 45 #> SNPs tagged by multiple tag haplotypes (saturated model): 537 #> 97 samples have missing genotypes in 433 SNPs in total. #> Imputing... #> Applying imputations... #> -----> Imputation iteration 2 #> Creating imputation rules #> SNPs tagged by a single SNP: 44 #> SNPs tagged by multiple tag haplotypes (saturated model): 538 #> 52 samples have missing genotypes in 47 SNPs in total. #> Imputing... #> Applying imputations... #>  #> ========== Imputing chromosome/part 21 #> -----> Imputation iteration 1 #> Creating imputation rules #> SNPs tagged by a single SNP: 20 #> SNPs tagged by multiple tag haplotypes (saturated model): 301 #> 92 samples have missing genotypes in 221 SNPs in total. #> Imputing... #> Applying imputations... #> -----> Imputation iteration 2 #> Creating imputation rules #> SNPs tagged by a single SNP: 20 #> SNPs tagged by multiple tag haplotypes (saturated model): 301 #> 27 samples have missing genotypes in 17 SNPs in total. #> Imputing... #> Applying imputations... #>  #> Imputation finished, re-merging the output     before <- length(which(is.na(genotypes(toy))))     after <- length(which(is.na(genotypes(toyI))))     before > after # TRUE #> [1] TRUE"},{"path":"/reference/listAttrFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to list analyses in a GWASExperiment — listAttrFuns","title":"Functions to list analyses in a GWASExperiment — listAttrFuns","text":"functions list associated analyses     GWASExperiment, .e. GWA tests association summary     statistics, PRS weights PRS extraction analysis.     GWASExperiment may multiple GWA PRS analysis     performed , GWA multiple PCs     covariates. analysis attached main     GWASExperiment avoid repetition large genotypic     data.","code":""},{"path":"/reference/listAttrFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to list analyses in a GWASExperiment — listAttrFuns","text":"","code":"listGwa(obj)     listPrs(obj)"},{"path":"/reference/listAttrFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to list analyses in a GWASExperiment — listAttrFuns","text":"obj GWASExperiment object.","code":""},{"path":"/reference/listAttrFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to list analyses in a GWASExperiment — listAttrFuns","text":"functions print information screen.","code":""},{"path":"/reference/listAttrFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to list analyses in a GWASExperiment — listAttrFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/listAttrFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to list analyses in a GWASExperiment — listAttrFuns","text":"","code":"data(toy,package=\"prisma\")     gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")          # Only 1 PC will be returned because of dataset size     toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) #> Performing PCA to select covariates to include in associations #> Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... #> Performing LD pruning... #> SNP pruning based on LD: #> Excluding 0 SNP (non-autosomes or non-selection) #> Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) #>     # of samples: 100 #>     # of SNPs: 962 #>     using 1 thread #>     sliding window: 500,000 basepairs, Inf SNPs #>     |LD| threshold: 0.2 #>     method: composite #> Chromosome 18: 23.44%, 154/657 #> Chromosome 21: 21.28%, 73/343 #> 227 markers are selected in total. #> LD pruning finished! 227 SNPs will be used for PCA. #>  #> Performing PCA... #> Principal Component Analysis (PCA) on genotypes: #> Excluding 773 SNPs (non-autosomes or non-selection) #> Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) #>     # of samples: 100 #>     # of SNPs: 227 #>     using 1 thread #>     # of principal components: 32 #> PCA:    the sum of all selected genotypes (0,1,2) = 10268 #> CPU capabilities: Double-Precision SSE2 #> Mon Jun  6 20:07:46 2022    (internal increment: 13024) #>  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s #> Mon Jun  6 20:07:46 2022    Begin (eigenvalues and eigenvectors) #> Mon Jun  6 20:07:46 2022    Done. #> Selecting number of PCs to include #>   with Tracy-Widom test for significant eigenvalues #>     selected 1 PCs          toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),         pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\")) #>  #> Starting GWA analysis in 2 chunks with 2 methods: glm, statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : Yes #>   testing SNPs from rs1009238 to rs1568327 #> Found 24 associations (uncorrected p-values). #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #> Found 24 associations (uncorrected p-values). #>  #> Combining p-values from multi-GWAS using fisher method #>  #> Overall, found 54 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : Yes #>   testing SNPs from rs2824974 to rs2828316 #> Found 18 associations (uncorrected p-values). #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #> Found 18 associations (uncorrected p-values). #>  #> Combining p-values from multi-GWAS using fisher method #>  #> Overall, found 35 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 54 associations found out of 657 markers #>   Part 21: 35 associations found out of 343 markers #>  #> Overall, found 89 associations with (uncorrected) combined p-values).     toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),         pcs=FALSE,psig=0.05,methods=c(\"glm\",\"statgen\")) #>  #> Starting GWA analysis in 2 chunks with 2 methods: glm, statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 25 associations (uncorrected p-values). #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : No #> Found 25 associations (uncorrected p-values). #>  #> Combining p-values from multi-GWAS using fisher method #>  #> Overall, found 52 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 16 associations (uncorrected p-values). #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : No #> Found 16 associations (uncorrected p-values). #>  #> Combining p-values from multi-GWAS using fisher method #>  #> Overall, found 35 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 52 associations found out of 657 markers #>   Part 21: 35 associations found out of 343 markers #>  #> Overall, found 87 associations with (uncorrected) combined p-values).          listGwa(toy) #> 1 -> Phenotype: BMI | Covariates: Age, Gender | PCs: 1 #>      Putative formula: BMI ~ Age + Gender + PC1 + [SNP] #> 2 -> Phenotype: BMI | Covariates: Age, Gender | PCs: - #>      Putative formula: BMI ~ Age + Gender + [SNP] #>  #> Note: The PC variables have putative names based on the number of PCs included in the model. #> For example, instead of PC1, PC2, PC3 the actual PCs may be PC1, PC3, PC4          prsiceOpts <- getDefaults(\"prsice\")     prsiceOpts$perm <- 100     if (Sys.which(\"PRSice_linux\") != \"\") {         toy <- runPRS(base=toy,response=\"BMI\",             covariates=c(\"Age\",\"Gender\"),             pcs=TRUE,prsiceOpts=prsiceOpts)         toy <- runPRS(base=toy,response=\"BMI\",             covariates=c(\"Age\",\"Gender\"),             pcs=FALSE,prsiceOpts=prsiceOpts)     } #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/lassosum_QYJSJ6461I #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/lassosum_QYJSJ6461I #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/lassosum_QYJSJ6461I/plink_lassosum_target_VHSGZ1399P.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/lassosum_QYJSJ6461I/plink_lassosum_target_VHSGZ1399P.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/lassosum_QYJSJ6461I/plink_lassosum_target_VHSGZ1399P.bed (SNP-major mode) #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Coordinating summary stats with reference panel... #> Coordinating summary stats with test data... #> Coordinating summary stats, reference panel, and test data... #> Splitting genome by LD blocks ... #> Running lassosum ... #> s =  0.2  #> s =  0.5  #> s =  0.9  #> Running lassosum with s=1... #> Calculating polygenic scores ... #> Running lassosum validation and PRS calculation #> 100 out of 100 samples kept in pheno. #> 100 out of 100 samples kept in covar. #> Done! R^2 is: 0.756356747467697 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/prsice_HWUPU5469K #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/prsice_HWUPU5469K #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/prsice_HWUPU5469K/plink_prsice_YJTRP3784U.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/prsice_HWUPU5469K/plink_prsice_YJTRP3784U.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/prsice_HWUPU5469K/plink_prsice_YJTRP3784U.bed (SNP-major mode) #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/prsice_HWUPU5469K/base_YJTRP3784U \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/prsice_HWUPU5469K/pheno_YJTRP3784U \\ #>   --target /tmp/Rtmpxo9Dha/prsice_HWUPU5469K/plink_prsice_YJTRP3784U \\ #>   --cov /tmp/Rtmpxo9Dha/prsice_HWUPU5469K/covar_YJTRP3784U \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 1 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_YJTRP3784U \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.708854 #> Full model R^2 is: 0.867266 #> Null model R^2 is: 0.158412 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/lassosum_EWZRO6903A #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/lassosum_EWZRO6903A #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/lassosum_EWZRO6903A/plink_lassosum_target_JVIAQ8582L.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/lassosum_EWZRO6903A/plink_lassosum_target_JVIAQ8582L.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/lassosum_EWZRO6903A/plink_lassosum_target_JVIAQ8582L.bed (SNP-major mode) #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Coordinating summary stats with reference panel... #> Coordinating summary stats with test data... #> Coordinating summary stats, reference panel, and test data... #> Splitting genome by LD blocks ... #> Running lassosum ... #> s =  0.2  #> s =  0.5  #> s =  0.9  #> Running lassosum with s=1... #> Calculating polygenic scores ... #> Running lassosum validation and PRS calculation #> 100 out of 100 samples kept in pheno. #> 100 out of 100 samples kept in covar. #> Done! R^2 is: 0.757420227733504 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/prsice_SAKPN7219U #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/prsice_SAKPN7219U #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/prsice_SAKPN7219U/plink_prsice_WEHUS1327G.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/prsice_SAKPN7219U/plink_prsice_WEHUS1327G.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/prsice_SAKPN7219U/plink_prsice_WEHUS1327G.bed (SNP-major mode) #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/prsice_SAKPN7219U/base_WEHUS1327G \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/prsice_SAKPN7219U/pheno_WEHUS1327G \\ #>   --target /tmp/Rtmpxo9Dha/prsice_SAKPN7219U/plink_prsice_WEHUS1327G \\ #>   --cov /tmp/Rtmpxo9Dha/prsice_SAKPN7219U/covar_WEHUS1327G \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 1 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_WEHUS1327G \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.702364 #> Full model R^2 is: 0.857239 #> Null model R^2 is: 0.154874 #>  #> Running PRS algorithms finished! Processing the results... #> Done!              listPrs(toy) #> 1 -> Phenotype: BMI | Covariates: Age, Gender | PCs: 1 #>      Putative formula: BMI ~ Age + Gender + PC1 + [PRS] #> 2 -> Phenotype: BMI | Covariates: Age, Gender | PCs: - #>      Putative formula: BMI ~ Age + Gender + [PRS] #>  #> Note: The PC variables have putative names based on the number of PCs included in the model. #> For example, instead of PC1, PC2, PC3 the actual PCs may be PC1, PC3, PC4"},{"path":"/reference/makeSimData.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create basic simulated GWAS data — makeSimData","title":"Function to create basic simulated GWAS data — makeSimData","text":"function losely based functionalities     R package PhenotypeSimulator can used      create basic simulated GWAS dataset continuous     phenotypes.","code":""},{"path":"/reference/makeSimData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create basic simulated GWAS data — makeSimData","text":"","code":"makeSimData(nsnp = 10000, nsam = 100, nphe = 3,         csnp = 100, psnp = c(0.01, 0.05, 0.1, 0.15, 0.20, 0.25,         0.3, 0.4))"},{"path":"/reference/makeSimData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create basic simulated GWAS data — makeSimData","text":"nsnp number SNPs simulate genotypes      . Defaults 10000. nsam number samples simulate. Defaults     100. nphe number continuous phenotypes     simulate. Defaults 3. csnp number causative SNPs simulate.     Defaults 100. psnp MAFs sample .","code":""},{"path":"/reference/makeSimData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create basic simulated GWAS data — makeSimData","text":"list members: snp: SnpMatrix object genotypes. sample: sample map (gsamples         equivalent FAM PLINK file). feature: feature map (gfeatures          equivalent BIM PLINK file). pheno: simulated data frame          phenotypes. list can used create GWASExperiment    object.","code":""},{"path":"/reference/makeSimData.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to create basic simulated GWAS data — makeSimData","text":"Panagiotis Moulos","code":""},{"path":"/reference/makeSimData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to create basic simulated GWAS data — makeSimData","text":"","code":"dat <- makeSimData(nsnp=100,nsam=100,nphe=3,csnp=10) #> coercing object of mode  numeric  to SnpMatrix     gwe <- GWASExperiment(         genotypes=dat$snp,         features=dat$feature,         samples=dat$sample,         phenotypes=dat$pheno     )"},{"path":"/reference/mergeGWAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge GWASExperiments from different populations — mergeGWAS","title":"Merge GWASExperiments from different populations — mergeGWAS","text":"function attempts merge two GWASExperiments     various goals, merging similar populations     common phenotypic /anthropometric data increase     statistical power. See Details rigorous      explanation merging process.","code":""},{"path":"/reference/mergeGWAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge GWASExperiments from different populations — mergeGWAS","text":"","code":"mergeGWAS(gwe1, gwe2, output = c(\"common\", \"all\"),          mafResolve = NULL, gdsfile = NULL, writegds = FALSE)"},{"path":"/reference/mergeGWAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge GWASExperiments from different populations — mergeGWAS","text":"gwe1 GWASExperiment object first     dataset. gwe2 GWASExperiment object second     dataset. output One \"common\" (default) operate     common SNPs gwe1 gwe2      \"\" operate SNPs. SNPs unique     dataset returned missing genotypes     merged set. mafResolve alleles      resolved just strand fliping resolved? Based     frequency one two datasets (1     2) online resources (dbSNP, population     studies etc.). later default (NULL). gdsfile path new GDS file. NULL,      temporary file written (unadvised      writegds=TRUE!). writegds write new GDS file? Defaults      FALSE. can written anytime     GWASExperiment2GDS function.","code":""},{"path":"/reference/mergeGWAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge GWASExperiments from different populations — mergeGWAS","text":"new GWASExperiment object merged genotypes,     samples phenotypes.","code":""},{"path":"/reference/mergeGWAS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Merge GWASExperiments from different populations — mergeGWAS","text":"merging GWASExperiment objects performed     based following steps assumptions. Firstly,     two objects checked genome version compatibility.     compatible process start.     consider using      GWASExperimentLiftOver function can     potentially render two datasets compatible. Also,     datasets common reference SNP naming.     possible merge dataset markers     named e.g. Illumina IDs dataset     markers named dbSNP (rs) IDs. two datasets compatible terms genome      version coordinates, common SNPs     identified two datasets. must     point information (location, minor major     alleles, strand), process checks     attributes tries resolve discrepancies. first check whether non identical SNPs terms     alleles can solved strand-fliping.     resolved strand-fliping may point     risk allele. resolved either using     one dataset reference (mafResolve=1 2)     even better, querying online resources (e.g.     Ensembl dbSNP) identify true minor major     alleles based summarized frequencies population     studies (internet connection      ). SNPs whose alleles resolved     means (strand-flip, online MAF resolve) completely     dropped. common SNPs two objects continue     identical, probably means      location/position mismatches potentially derived     older annotations. can resolved online.     remaining non-resolvable     SNPs, dropped. , genotypes common     SNPs merged. genotypes alleles      flipped also switched. Finally, common annotation elements genotypes     combined. output==\"common\" process     stops. output=\"\", unique elements     dataset also combined common.     genotypes SNPs unique dataset set     missing. respect allele resolving common     SNPs resolved strand-flipping      online: SNPs queried biomaRt resolve          allele frequencies. Genome version important          point alleles used IDs. minor allele available Ensembl,          flip decision based . (e.g.          outdated/merged SNPs, dbSNP queried package         rsnps fill Ensembl result. SNPs may removed dbSNP.          Nothing can done. Flip based          majority rest. found SNPs may information          MAF minor alleles. dbSNP requeried          rsnps filling missing info retried. ,          resolved flipped          according majority.","code":""},{"path":"/reference/mergeGWAS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Merge GWASExperiments from different populations — mergeGWAS","text":"Panagiotis Moulos","code":""},{"path":"/reference/mergeGWAS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Merge GWASExperiments from different populations — mergeGWAS","text":"","code":"data(toy,package=\"prisma\")          toy1 <- toy[1:800,1:50]     toy2 <- toy[201:1000,51:100]          toym <- mergeGWAS(toy1,toy2) #> Now trying to merge features (markers, SNPs) #>   Found 600 common SNPs #>   Checking common SNPs for reversed strands or alleles #>   Found 0 SNPs with no mathcing alleles #>   Found 0 SNPs fixable by strand-flip #>   Checking for non-resolvable alleles #>   Merging features #> Now trying to merge samples #> Now trying to construct unified genotypes #>   Merging genotypes #> Done! #>       dim(toym) # 600 100 #> [1] 600 100          toym <- mergeGWAS(toy1,toy2,output=\"all\") #> Now trying to merge features (markers, SNPs) #>   Found 600 common SNPs #>   Checking common SNPs for reversed strands or alleles #>   Found 0 SNPs with no mathcing alleles #>   Found 0 SNPs fixable by strand-flip #>   Checking for non-resolvable alleles #>   Retrieving SNPs specific to each dataset #>   Merging features #> Now trying to merge samples #> Now trying to construct unified genotypes #>   Merging genotypes #> coercing object of mode  numeric  to SnpMatrix #> object has no names - using numeric order for row/column names #> coercing object of mode  numeric  to SnpMatrix #> object has no names - using numeric order for row/column names #> Done! #>       dim(toym) # 1000 100 #> [1] 1000  100"},{"path":"/reference/normalityCheck.html","id":null,"dir":"Reference","previous_headings":"","what":"Enrichment of PGS Catalog retrieved scores — normalityCheck","title":"Enrichment of PGS Catalog retrieved scores — normalityCheck","text":"function uses three distinct tests assess      normality numeric vector, namely Shapiro-Wilk      test, Kolmogorov Smirnov test normal      distribution (y=\"pnorm\"      ks.test function) Jarque-Bera test      implemented package tseries. latter      present, test available.","code":""},{"path":"/reference/normalityCheck.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enrichment of PGS Catalog retrieved scores — normalityCheck","text":"","code":"normalityCheck(x, pval = 0.05, tests = c(\"sw\", \"ks\", \"jb\"),         lower = 30, combine = c(\"fisher\", \"simes\", \"max\", \"min\"),          nsample = 1000)"},{"path":"/reference/normalityCheck.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Enrichment of PGS Catalog retrieved scores — normalityCheck","text":"x numeric vector tested normality. pval p-value cutoff test significance. tests one \"sw\" (Shapiro-Wilk),     \"ks\" (Kolmogorov-Smirnov) \"jb\"     (Jarque-Bera). lower lower threshold sample size,     selected tests executed without      resampling. See also Details. combine p-value combination multiple tests     selected. One \"fisher\", \"simes\",      \"max\", \"min\". See also Details. nsample Number resampling iterations     sample size larger lower. Defaults      1000.","code":""},{"path":"/reference/normalityCheck.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Enrichment of PGS Catalog retrieved scores — normalityCheck","text":"named list members statistics, actual     values statistics used assess normality,  pvalues, respective p-values, \"pval\",     p-value threshold tests (input p, normal, logical indicating output test.)","code":""},{"path":"/reference/normalityCheck.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Enrichment of PGS Catalog retrieved scores — normalityCheck","text":"Regarding lower argument, represents      length threshold input vector (aka number     observations) normality assessed     using resampling x sample      length lower. final outcome      determined p = 100 * (1 - 2*pval) quantile      nsample length Shapiro-Wilk p-value      distribution created nsample resampling     iterations. p >= pval, x can      considered follow normal distribution. Regarding combine argument, determines     outcomes multiple tests combined.     \"fisher\" \"simes\", Fisher     Simes method p-value combination used.     details two methods please refer      PMID: 25452340 Bioconductor package metaseqR2.     \"min\" \"max\", minimum     (lose) maximum (stricter) p-value     three tests considered determine outcome.","code":""},{"path":"/reference/normalityCheck.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Enrichment of PGS Catalog retrieved scores — normalityCheck","text":"Panagiotis Moulos","code":""},{"path":"/reference/normalityCheck.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Enrichment of PGS Catalog retrieved scores — normalityCheck","text":"","code":"x <- rnorm(20)  o1 <- normalityCheck(x) #> Sample size 20 <= 30. Will execute combined normality checks using requested tests. o2 <- normalityCheck(x,combine=\"simes\") #> Sample size 20 <= 30. Will execute combined normality checks using requested tests. # Two instead of 3 tests o3 <- normalityCheck(x,tests=c(\"sw\",\"jb\"),combine=\"simes\") #> Sample size 20 <= 30. Will execute combined normality checks using requested tests."},{"path":"/reference/pgd.html","id":null,"dir":"Reference","previous_headings":"","what":"A toy GWASExperiment dataset with 25 SNPs — pgd","title":"A toy GWASExperiment dataset with 25 SNPs — pgd","text":"data set contains genotypes 25 SNPs      case/control study specified source. used     examples tests prisma package respect     external PGS analysis.","code":""},{"path":"/reference/pgd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A toy GWASExperiment dataset with 25 SNPs — pgd","text":"small GWASExperiment demo purposes.","code":""},{"path":"/reference/pgd.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A toy GWASExperiment dataset with 25 SNPs — pgd","text":"Kalafati et al. (https://doi.org/10.1016/j.nut.2018.10.032)","code":""},{"path":"/reference/pgd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A toy GWASExperiment dataset with 25 SNPs — pgd","text":"Panagiotis Moulos","code":""},{"path":"/reference/prismaCvFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to perform PRS cross-validation evaluations — prismaCvFuns","title":"Functions to perform PRS cross-validation evaluations — prismaCvFuns","text":"functions perform cross-validation regressions     given either output prisma     full evaluation (prismaCrossValidate) one     PRS candidate data frame SNPs proper format     (prsCrossValidate). Several metrics      returned inspection evaluation     used PRISMA HTML report.","code":""},{"path":"/reference/prismaCvFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to perform PRS cross-validation evaluations — prismaCvFuns","text":"","code":"prismaCrossValidate(prismaOut, gwe, response,          covariates = NULL, pcs = FALSE,          leaveOut = seq(0.05, 0.5, 0.05), times = 10,         prsCalc = c(\"avg\", \"sum\", \"std\"), family = NULL,          rc = NULL, ...)          prsCrossValidate(snpSelection, gwe, response,          covariates = NULL, pcs = FALSE, leaveOut = 0.05,         times = 10, prsCalc = c(\"avg\", \"sum\", \"std\"),         family = NULL, rc = NULL, ...)          applyPRS(snpSelection, gwe, response,          covariates = NULL, pcs = FALSE, minSnps = 2,         prsCalc = c(\"avg\", \"sum\", \"std\"), times = 10,         family = NULL, rc = NULL,...)"},{"path":"/reference/prismaCvFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to perform PRS cross-validation evaluations — prismaCvFuns","text":"prismaOut output link{prisma}     function containing results iterative PRS     extraction. gwe GWASExperiment object (one     used generate prismaOut). snpSelection data frame candidate SNPs,     output, part output      aggregatePrsMarkers, one list      members output selectPrs. response trait PRS sought     extracted. character length 1 exist     phenotypes gwe. covariates covariates include regression     models. character vector traits      existing phenotypes gwe. leaveOut fraction (percentage) samples     leave-cross-validation run. can vector     multiple fractions prismaCrossValidate. times prismaCrossValidate, many      cross-validations perform. applyPRS,     number SNP randomizations perform summary      statistics present gwe. Defaults      10. See also Details. prsCalc final PRS calculated     data frame PRS candidate SNPs? One \"avg\"      (default), \"sum\" \"std\". See also      Details. family Regression family functions, e.g.      \"gaussian\" classical linear regression     \"binomial\" logistic regression. See also     gwa. Defaults NULL trying     set automatically. pcs Inlcude PCs regression model? Defaults     FALSE. See also Details. minSnps minimum number SNPs present     gwe order continue PRS application     using genotypes gwe. Defaults      2. rc fraction available cores use      parallel calculations. Default NULL     parallelization. ... arguments passed regression      functions, like glm.","code":""},{"path":"/reference/prismaCvFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to perform PRS cross-validation evaluations — prismaCvFuns","text":"prismaCrossValidate, list      cross-validation metrics, GWA method used,     PRS candidate leave-percentage.     list nested, first level GWA      method, second level SNP candidates (named     number SNPs PRS candidate)     third level leave-percentage samples     cross-validation. actual value third     level data frame times rows, containing     metrics collected cross-validation,     leaving leaveOut[] fraction samples,     =1:ntimes. data frame output     prsCrossValidate. collected metrics,     see Details.     applyPRS list three four members: metrics: cross         validation metrics - see Details. values: data frame following         columns: raw_pheno: phenotype             PRS contributes explanation red_pheno: predicted phenotype             regression model without PRS             covariate full_pheno: predicted phenotype             regression model including PRS             covariate prs: PRS calculated according             prsCalc plots: list two ggplot objects: scatter: scatterplot             raw_pheno prs hist: histogram prs permutations: available         times > 0 summary          statistics (effects slot) present         gwe GWASExperiment object. metrics: matrics evaluation             metrics (metrics upper level             member) times iterations (number             rows) bootp: bootstrap p-value denoting             statistical significance tested PRS             non-random (essentially number times             PRS R^2 random PRS larger             original PRS R^2 divided times)","code":""},{"path":"/reference/prismaCvFuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functions to perform PRS cross-validation evaluations — prismaCvFuns","text":"Regarding prsCalc argument, tells CV     functions calculate PRS model given     genotypic data. three available method reflect      three first ways calculating PRS PRSice2     software (https://www.prsice.info/step_by_step/)     named accordingly (see --score option     PRSice2). Regarding pcs argument, TRUE, PCs      gwe used. gwe contain      PCs, warning issued pcs set      FALSE. Regarding times argument      applyPRS function, instructs function      perform times random SNP selections     input gwe repeat validation procedure      calculation evaluation metrics.      process available summary statistics     present gwe useful test random     PRS performs explaining examined phenotype.      Normally, metrics worse. boostrap      p-value also calculated evaluation      metrics. Regarding collected metrics, : R^2 reduced regression model          (reduced_r2): R^2 reduced         regression model, including covariates         PCs requested, PRS. R^2 full regression model          (full_r2): R^2 full regression         model including covariates PRS. R^2 PRS (prs_r2): adjusted         R^2 PRS (essentially R^2 full model minus         R^2 reduced model). Statistical significance (p-value) PRS          effect coefficient regression model         (prs_pvalue). R^2 reduced regression model          (reduced_r2): R^2 reduced         regression model, including covariates         PCs requested, PRS. RMSE (Root Mean Squared Error) reduced          regression model (reduced_rmse): RMSE          reduced regression model, including          covariates PCs requested, PRS. RMSE full regression model          (full_rmse): RMSE full regression         model including covariates PRS. MAE (Mean Absolute Error) reduced          regression model (reduced_mae): MAE          reduced regression model, including          covariates PCs requested, PRS. MAE full regression model          (full_mae): MAE full regression         model including covariates PRS. Correlation observed predicted         phenotype values reduced regression model         (reduced_pred_cor). Correlation observed predicted         phenotype values full regression model         (full_pred_cor). R^2 observed predicted phenotype         values reduced regression model         (reduced_pred_r2). R^2 observed predicted phenotype         values full regression model         (full_pred_r2). R^2 PRS observed predicted          phenotype values reduced regression model         (prs_pred_r2).","code":""},{"path":"/reference/prismaCvFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to perform PRS cross-validation evaluations — prismaCvFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/prismaCvFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to perform PRS cross-validation evaluations — prismaCvFuns","text":"","code":"data(toy,package=\"prisma\")     data(prisma_out,package=\"prisma\")          response <- \"BMI\"     covariates <- c(\"Case_Control\",\"Gender\",\"Age\")          cvm <- prismaCrossValidate(prismaOut,toy,response=response,         covariates=covariates,leaveOut=c(0.2,0.4),times=5) #>  #> ################################################################ #> Running cross-validations for glm with 2 leave-out cases across 1 PRS candidates #> ################################################################ #>  #> ================================================================ #> -----> Cross-validating PRS candidate with 24 markers #> ================================================================ #>  #> ----- Leave-out percentage 20% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 40% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ################################################################ #> Running cross-validations for statgen with 2 leave-out cases across 1 PRS candidates #> ################################################################ #>  #> ================================================================ #> -----> Cross-validating PRS candidate with 4 markers #> ================================================================ #>  #> ----- Leave-out percentage 20% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 40% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ################################################################ #> Done! Use summarizeCvMetrics() and plotCvMetrics() to summarize and inspect the results. #> ################################################################          can <- getPrsCandidates(prismaOut,\"glm\",1)     m <- prsCrossValidate(can,toy,response=response,         covariates=covariates,leaveOut=0.2,times=5) #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model"},{"path":"/reference/prismaFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Main prisma PRS extraction and validation pipelines — prismaFuns","title":"Main prisma PRS extraction and validation pipelines — prismaFuns","text":"functions comprises main PRISMA workhorse      perform steps required extract PRS      potentially chatacterizing phenotypic trait, given      set samples, genetic polymorphims      phenotypes participate subsequent GWAS      associations GWASExperiment object. ,     prisma function combines three     performs: Input checking subsequent management         according input details Iterative calls prsPipeline         SNP effect estimation method main          prisma iterator extracting multiple PRSs         later combined. Call prsSelection evaluates         output prsPipeline selects         best PRS candidates SNP effect estimation         method. Wrap data feed later PRISMA         report basic evaluation graphics. Output object containing results          input PRISMA reporting function. prsPipeline iterator PRISMA      workflow. produce list GWASExperiment     objects summaries, filling     prsbetas slot GWASExperiment. prsSelection accepts input output     prsPipeline evaluate select best     PRS candidates according input arguments. prismaPipeline seves wrapper      prisma makes sure pipeline     resume crashed point well write     checkpoints create report.","code":""},{"path":"/reference/prismaFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Main prisma PRS extraction and validation pipelines — prismaFuns","text":"","code":"prisma(         gwe,         phenotype,         covariates,         pcs = FALSE,         npcs = 0,         trainSize = 0.8,         niter = 10,         resolution = c(\"frequency\", \"quantile\"),         step = if (resolution == \"frequency\") 1 else              c(0.1, 0.2, 0.3, 0.4, 0.5, 0.75, 0.8, 0.9, 0.95, 0.99),         minFreq = 2,         minSnps = 5,         dropSameQuantiles = TRUE,         aggregation = c(\"intersection\", \"union\"),         effectWeight = c(\"mean\", \"median\", \"weight\"),         prsSelectMethod = c(\"maxima\", \"elbow\"),         prsSelectCrit = c(\"prs_r2\", \"prs_pvalue\", \"prs_aic\"),         prsSelectStat = c(\"mean\", \"median\", \"none\"),         prsSelectR2 = c(\"adjusted\", \"raw\"),         sigTest = c(\"ttest\", \"wilcoxon\", \"empirical\"),         filters = getDefaults(\"filters\"),         pcaMethod = c(\"auto\", \"snprel\", \"grid\", \"hubert\"),         imputeMissing = FALSE,         imputeMethod = c(\"single\", \"split\"),         gwaMethods = c(\"glm\", \"rrblup\", \"statgen\", \"snptest\",             \"plink\"),         gwaCombine = c(\"fisher\", \"simes\", \"max\", \"min\", \"harmonic\",              \"whitlock\", \"pandora\"),         glmOpts = getDefaults(\"glm\"),         rrblupOpts = getDefaults(\"rrblup\"),         statgenOpts = getDefaults(\"statgen\"),         snptestOpts = getDefaults(\"snptest\"),         plinkOpts = getDefaults(\"plink\"),         prsMethods = c(\"lassosum\",\"prsice\"),         lassosumOpts = getDefaults(\"lassosum\"),         prsiceOpts = getDefaults(\"prsice\"),         prsWorkspace = NULL,         cleanup = c(\"none\", \"intermediate\", \"all\"),         logging = c(\"screen\", \"file\"),         dnOutput = c(\"gwaslist\", \"summaries\"),         output = c(\"normal\", \"full\"),         continue = FALSE,         useDenovoWorkspace = NULL,         runId = NULL,         evalOnSplit = c(\"original\", \"new\"),         evalWith = c(\"vanilla\", \"prscice\"),         sitadelaDb = NULL,         rc = NULL     )          prsPipeline(         gwe,         phenotype,         covariates,         pcs = FALSE,         npcs = 0,         snpSelection = NULL,         trainSize = 0.8,         niter = 10,         filters = getDefaults(\"filters\"),         pcaMethod = c(\"auto\", \"snprel\", \"grid\", \"hubert\"),         imputeMissing = FALSE,         imputeMethod = c(\"single\", \"split\"),         gwaMethods = c(\"glm\", \"rrblup\", \"statgen\", \"snptest\",             \"plink\"),         gwaCombine = c(\"fisher\", \"simes\", \"max\", \"min\", \"harmonic\",              \"whitlock\", \"pandora\"),         glmOpts = getDefaults(\"glm\"),         rrblupOpts = getDefaults(\"rrblup\"),         statgenOpts = getDefaults(\"statgen\"),         snptestOpts = getDefaults(\"snptest\"),         plinkOpts = getDefaults(\"plink\"),         prsMethods = c(\"lassosum\",\"prsice\"),         lassosumOpts = getDefaults(\"lassosum\"),         prsiceOpts = getDefaults(\"prsice\"),         prsWorkspace = NULL,         cleanup = c(\"none\", \"intermediate\", \"all\"),         logging = c(\"screen\", \"file\"),         output = c(\"gwaslist\", \"summaries\"),         continue = FALSE,         useDenovoWorkspace = NULL,         runId = NULL,         evalWith = c(\"vanilla\", \"prscice\"),         rc = NULL     )          prsSelection(         dnList,         gwe,         phenotype,         covariates,         pcs = FALSE,         npcs = 0,         trainSize = 0.8,         niter = 10,         resolution = c(\"frequency\", \"quantile\"),         step = if (resolution == \"frequency\") 1 else              c(0.1, 0.2, 0.3, 0.4, 0.5, 0.75, 0.8, 0.9, 0.95, 0.99),         minFreq = 2,         minSnps = 5,         dropSameQuantiles = TRUE,         aggregation = c(\"intersection\", \"union\"),         effectWeight = c(\"mean\", \"median\", \"weight\"),         filters = getDefaults(\"filters\"),         pcaMethod = c(\"auto\", \"snprel\", \"grid\", \"hubert\"),         imputeMissing = FALSE,         imputeMethod = c(\"single\", \"split\"),         gwaMethods = c(\"glm\", \"rrblup\", \"statgen\", \"snptest\",             \"plink\"), # lasso later         gwaCombine = c(\"fisher\", \"simes\", \"max\", \"min\", \"harmonic\",              \"whitlock\", \"pandora\"),         glmOpts = getDefaults(\"glm\"),         rrblupOpts = getDefaults(\"rrblup\"),         statgenOpts = getDefaults(\"statgen\"),         snptestOpts = getDefaults(\"snptest\"),         plinkOpts = getDefaults(\"plink\"),         prsMethods = c(\"lassosum\",\"prsice\"),         lassosumOpts = getDefaults(\"lassosum\"),         prsiceOpts = getDefaults(\"prsice\"),         prsWorkspace = NULL,         cleanup = c(\"none\", \"intermediate\", \"all\"),         logging = c(\"screen\", \"file\"),         continue = FALSE,         useDenovoWorkspace = NULL,         runId = NULL,         evalWith = c(\"vanilla\", \"prscice\"),         output = c(\"summary\", \"full\"),         rc = NULL     )          prismaPipeline(..., retry = 10, outPath = NULL)"},{"path":"/reference/prismaFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Main prisma PRS extraction and validation pipelines — prismaFuns","text":"gwe GWASExperiment object GWA tests performed.     words, gwa must applied. dnList list resulting de novo PRS      extraction pipeline. See also Details. phenotype trait PRS sought     extracted. character length 1 exist     phenotypes gwe. covariates covariates include regression     models. character vector traits      existing phenotypes gwe. pcs Inlcude PCs regression model? Defaults     FALSE. npcs number PCs use pcs=TRUE.     npcs=0, PCs available gwe     used. trainSize fraction training set used     summary statistics calculation iteration.      See also Details. Defaults 0.8. niter Number PRS extraction iterations.      Defaults 100. resolution resolve best number     SNPs PRS candidate, either validating PRS     many SNPs number appearances     frequency cutoff (frequency, default) many     SNPs included different quantile cutoffs      frequency appearance distribution      (\"quantile\"). See also Details. step number steps step increment     resolution. Defaults 1      resolution=\"frequency\" set predefined     quantiles resolution=\"quantile\". See also     Details. minFreq minimum accepted frequency      appearance SNP niter iterations      considered member PRS candidate. Defaults      2. minSnps minimum number SNPs included     PRS candidate. Defaults 5. dropSameQuantiles      resolution=\"quantile\" drop quantiles      SNPs? Defaults TRUE. See also Details. aggregation SNPs different      PRS algorithms aggregated end      iterations order create distribution      appearances. One \"intersection\" (default)     \"union\". See also Details. effectWeight summarize SNP effects      (regression coefficients) across niter     iterations. One \"mean\" (default),     \"mean\" \"weight\". See also Details. prsSelectMethod select number SNPs     PRS niter iterations. One     \"maxima\" (default) \"elbow\". See also     Details. prsSelectCrit One \"prs_r2\" (default),      \"prs_pvalue\" \"prs_aic\". Determines     criterion used PRS selection. See also Details. prsSelectStat One \"mean\" (default),     \"median\" \"none\". Determines     calculated statistic (mean, median) used summarize     prsSelectCrit evaluation metrics     applicable (e.g. applicable p-values). prsSelectR2 One \"adjusted\" (default)      \"raw\". first one uses PRS contribution     evaluation regression model second one      R^2 full model. sigTest assess statistical significance     initial PRS R^2 calculations respective     R^2 (prsSelectCrit metrics)      prisma aggreagated result. One \"ttest\"      (default), \"wilcoxon\" \"empirical\". See     also Details. filters Filters applied gwe,     workflow executed prisma iteration.     details, see filterGWAS function. pcaMethod method use PCA. can     one \"auto\" (default), \"snprel\"     parallel PCA method implemented package SNPRelate,      \"grid\" \"hubert\" robust (     slow) PCA. See also gwa function. imputeMissing Impute missing values     prisma iteration? Defaults TRUE, see also     Details. imputeMethod One \"single\" (default)     \"split\". See imputeGWAS     details. gwaMethods GWAS SNP effect estimation      method(s) use order estimate effects     used PRS weights. can one     \"glm\", \"rrblup\", \"snptest\",     \"statgen\" \"plink\". See      gwa function details. gwaCombine combine SNP p-values     one GWAS effect estimation methods. Currently     used. glmOpts Options list specific GLM effect      estimation. See gwa function      details. rrblupOpts Options list specific rrBLUP      effect estimation. See gwa function      details. statgenOpts Options list specific statgenGWAS     effect estimation. See gwa function      details. snptestOpts Options list specific SNPTEST     effect estimation. See gwa function      details. plinkOpts Options list specific PLINK     effect estimation. See gwa function      details. prsMethods One PRS extraction algorithms     included prisma workflow. Can      \"prcise\", \"lassosum\" . lassosumOpts Options list specific lassosum     PRS extraction. See runPRS function     details. prsiceOpts Options list specific PRSice2     PRS extraction. See runPRS function     details. prsWorkspace local directory used     prisma operations. Defaults NULL     auto-generation. See also Details. cleanup Cleanup level finish     prisma pipeline. \"none\" (default) leaves     intermediate output intact. \"intermediate\"      deletes files produced effect estimation     well BED, BIM FAM files required PRSice2     lassosum linkage files. \"\" deletes     entire prsWorkspace. logging One \"screen\" (default)     \"file\". write log messages. prisma     runs parallel, \"file\" time. dnOutput output prsPipeline called     function. Can \"gwaslist\" (default)      list GWASExperiments \"summaries\"     summary required next steps prisma pipelie.     latter obviously smaller size. output level output function.     can \"normal\" list necessary     information create prisma report \"full\"     also contains itermediate output      prsPipeline called within prisma. continue Continue crashed pipeline? Defaults     FALSE, see Details. useDenovoWorkspace Validate prisma combined     PRS initial dataset splits generate new ones.     Defaults NULL, see also Details. runId unique run id run. given,     auto-generated. evalOnSplit data split use evaluate     PRS. \"original\" (default) uses original split      SNP effect calculations, \"new\" creates     new split taking much time. evalWith perform PRS evaluation      regressions. can \"vanilla\" (default)     R \"prsice\" PRSice2.     latter takes much time intermediate     writing PLINK files. sitadelaDb Either NULL sitadela SQLite      database least human RefSeq annotations hg19     hg38. used add gene names PRS SNP loci. snpSelection data frame candidate SNPs,     output, part output      aggregatePrsMarkers, one list      members output selectPrs. rc fraction available cores use      parallel calculations. Default NULL     parallelization. ... Arguments passed prisma     prismaPipeline wrapper.. retry number pipeline relaunches case     crash reason. Defaults 10. outPath path directory      checkpoint files report written.     can different prsWorkspace     defaults NULL auto-generation.","code":""},{"path":"/reference/prismaFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Main prisma PRS extraction and validation pipelines — prismaFuns","text":"list members params results.     lists.     params member following contents: call contains function call. args contains list         arguments used, default user-specific,          irrespective call. results member named list length     vector gweMethods sublist corresponds     results SNP effect calculation method.      one following contents: candidates, named list data frames         containing SNPs within PRS candidate.         names correspond number SNPs PRS         candidates candidates determined based         prsSelectMethod. iterations NULL         output prisma iteration (multiple         outputs prsSelection)          output=\"full\". reportData internal          structure containing PRS evaluation metrics         ggplot2 objects used make prisma report. object can saved .rda file later used     cross-validation metrics lookup GWAS      catalog (prismaLookup function).      three elements required build prisma report     (prismaReport function).","code":""},{"path":"/reference/prismaFuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Main prisma PRS extraction and validation pipelines — prismaFuns","text":"Regarding dnList argument, list     either GWASExperiment objects list     lists, summarizing GWASExperiment object     save space/memory elements     GWASExperiment object required downstream     analyses. content dnList determined     output argument prsPipeline.     latter \"summaries\", dnList sublists     following members: baseIndex: sample indices used         extraction summary statistics via         gwa (training). targetIndex: sample indices         used PRS extraction validation         supported pipelines (testing). effects: effects (regression coefficients         odds ratios) SNP (summary statistics). prsbetas: subset regression coefficients         /adjusted ones case lassosum,         comprise PRS weights. npcs: number principal components          included regression model. pr2: data frame metrics returned         PRSice2, PRS p-value R^2. dnList can essentially outcome     de novo PRS extraction pipeline. Regarding trainSize argument, controls     fraction input GWASExperiment object (.e.     fraction input dataset) used     calculation summary statistics using     link{gwa} function (usually). summary     statistics used rest samples     (fraction 1 - trainSize) PRS extraction,     input supported PRS algorithms      (PRSice2, lassosum). Therefore, prisma     iteration (niter),      trainSize*ncol(gwe) samples used calculate     summary statistics (1-trainSize)*ncol(gwe)     used targets PRS extrction process. Regarding dropSameQuantiles argument,     resolution=\"quantile\", possible     number SNPs different quantiles frequency     appearance distribution . default,     PRS evaluated highest quantile     number SNPs next lower one     (dropSameQuantiles=FALSE). example,     number PRS SNPs Q=0.5 Q=0.75 1000,     evaluation Q=0.75.     force evaluation, set      dropSameQuantiles=TRUE. Regarding \"aggregation\" argument,     controls PRS SNP candidates different     PRS algorithms consolidated.     \"intersection\", SNPs included PRS     suggested algorithms synthesize PRS     candidate set. \"union\", union     SNPs present PRSs. final SNP set     used create distribution appearances     (frequency SNP across \"niter\"     iterations) basis later selection. Regarding effectWeight argument,     controls SNP effects PRS candidates     summarized niter iterations produce     final effects calculation weighted PRS.     \"mean\" (default), final effect SNP     mean effects across niter     iterations, appears. \"median\",     respective median \"weight\",     SNP effects weighted 1 minus recorded     PRS R^2 \"best\" runs can given     value. Regarding prsSelectMethod argument,     controls final PRS selected end     niter iterations based requested     evaluation metrics (typically PRS R^2).     \"maxima\"(default), distribution PRS R^2     values created PRS R^2 values (rarer,      chosen metric) derived niter      iterations. distribution (R^2-related) may     adjusted according number SNPs     comrpising PRS, according      prsSelectR2 argument. ,      distribution, local maxima calculated. local     maximum highest R^2 considered best     candidate provides number SNPs.      maxima returned also candidates.     \"elbow\" , elbow point method used     determining optimal number SNPs. elbow method     heuristic used determining number      features data set respect optimization     criterion. case criterion value     PRS R^2 method consists plotting PRS     explained variation (depicted R^2) function      number SNPs PRS. Regarding prsSelectCrit argument,     controls criterion used select final PRS     end iterative process according     evaluation metrics. \"prs_r2\"      (default), decision making plots      prsSelectMethod operate PRS R^2 calculated     PRS extraction iteration.      \"prs_pvalue\", -log_10(PRS p-valye) used     \"prs_aic\", AIC (Akaike's Information     Criterion) used. Regarding sigTest argument, controls     () statistical significance assessed     comparison initial PRS R^2 calculations (    returned PRSice2) PRS R^2 prisma     combined approach. Essentially, two PRS R^2 (    full model R^2 determined prsSelectCrit)     distributions compared using t-test (default),     Wilcoxon rank test empirical test. latter     case, 'p-value' number times     R^2 prisma combination method smaller     initial R^2 divided number iterations.     outcome presented prisma report. Regarding imputeMissing argument,     practically used pre-processed dataset     contain missing values. initial      dataset missing values, imputation performed     step, slowing procedure. Regarding prsWorkspace argument,     controls prisma intermediate files     results well configuration files stored.     NULL (recommended!), temporary     directory used. directory hosts: JSON file run parameters called         params.json. one subdirectory iteration          contains intermediate files used e.g. SNPTEST,         PLINK, PRSice2 etc. directories named         based runId iteration number. log file iteration, named similarly         run subdirectory. Regarding continue argument, can     set TRUE continue crashed pipeline,      given initial gwe argument prisma     workspace. workspace found, new run     started. Generally, prisma pipeline     combines several often disjoint components (including     several system commands), possible something     can go wrong. done best modularize     pipeline can restarted various      automatically detected checkpoints. Regarding useDenovoWorkspace argument,     useDenovoWorkspace valid prisma workspace     list output prsPipeline, PRS validation     performed using original data split.      NULL, completely new split generated.     later can take long time, advised      use existing split available. argument      available prsPipeline      prsSelection functions used directly.     executing complete pipeline prisma,     controlled evalOnSplit argument.     latter evalOnSplit=\"original\",      workspace generated prisma initiation used.      evalOnSplit=\"new\", initial split     ignored new split created evaluated,     taking much time SNP effect calculation     takes place .","code":""},{"path":"/reference/prismaFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Main prisma PRS extraction and validation pipelines — prismaFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/prismaFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Main prisma PRS extraction and validation pipelines — prismaFuns","text":"","code":"data(toy,package=\"prisma\") gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")  # Lose filters for the toy dataset filts <- getDefaults(\"filters\") filts$IBD <- NA filts$hwe <- 1e-3 filts$pcaOut <- FALSE filts$inbreed <- NA  # Workspace d1 <- tempfile() wspace1 <- file.path(tempdir(),d1)  # Traits response <- \"BMI\" covariates <- c(\"Case_Control\",\"Gender\",\"Age\")  # Complete 4-iteration PRS pipeline - ~1 min to run with 4 cores - no PCA if (Sys.which(\"PRSice_linux\") != \"\") {  prismaOut <- prisma(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=c(\"glm\",\"statgen\"),     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace1,     cleanup=\"intermediate\",     logging=\"file\",     output=\"normal\"#,     #rc=0.25 )  # Below, individual wrapper steps implemented in prisma as whole # Output only of the discovery PRS pipeline with statgenGWAS d2 <- tempfile() wspace2 <- file.path(tempdir(),d2) dnList <- prsPipeline(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=\"statgen\",     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace2,     cleanup=\"intermediate\",     logging=\"file\"#,     #rc=0.25 )  # After, calculate the evaluation metrics d3 <- tempfile() wspace3 <- file.path(tempdir(),d3) evalMetrics <- prsSelection(     dnList=dnList,     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=\"statgen\",     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace3,     cleanup=\"intermediate\",     logging=\"file\",     output=\"summary\",     useDenovoWorkspace=dnList#,     #rc=0.25 )  candidates <- selectPrs(     metrics=evalMetrics$metrics,     snpSelection=evalMetrics$pgs,     gwe=toy,     base=evalMetrics$baseline )  } #>  #> 2022-06-06 20:08:40: Data processing started... #>  #> Input #> -------------------------------------------------------------------- #> Input object (gwe) : a GWASExperiment object with 1000 markers (SNPs) and 100 samples #>  #> Regression parameters #> -------------------------------------------------------------------- #> Phenotypic response (phenotype)          : BMI #> Regression covariates (covariates)       : Case_Control, Gender, Age #> Principal Components in covariates (pcs) : No #> Number of Principal Components (npcs)    : - #>  #> Preprocessing options #> -------------------------------------------------------------------- #> Sample and genotype filtering options (filters)     : #>   snpCallRate    : 0.98 #>   sampleCallRate : 0.95 #>   maf            : 0.05 #>   hwe            : 0.001 #>   heteroStat     : median #>   heteroFac      : 3 #>   heteroHard     : NA #>   pcaOut         : No #>   pcaRobust      : hubert #>   nPC            : NA #>   LD             : 0.2 #>   IBD            : NA #>   inbreed        : NA #> Principal Components calculation method (pcaMethod) : snprel #> Impute missing genotypes (imputeMissing)            : No #> Missing genotype imputation method (imputeMethod)   : singlesplit #>  #> GWA analysis options #> -------------------------------------------------------------------- #> Genome-Wide Association tests (gwaMethods)        : glm, statgen #> Association tests combination method (gwaCombine) : fishersimesmaxminharmonicwhitlockpandora #> Association tests options                         :  #>   glm :  #>     family : - #>     size   : 1 #>   statgen :  #>     kinship : astle #>     reml    : EMMA #>     gls     : single #>  #> PRS candidate extraction options #> -------------------------------------------------------------------- #> PRS extraction algorithms (prsMethods) : lassosum, prsice #> PRS algorithms options (prsMethods)    :  #>   lassosum :  #>     anc   : eur #>     valid : auto #>   prsice :  #>     clump_kb : 250 #>     clump_r2 : 0.1 #>     clump_p  : 0.75 #>     score    : avg #>     perm     : 100 #>     seed     : 42 #>  #> PRS construction and evaluation options #> -------------------------------------------------------------------- #> Training set size (trainSize)                               : 80% #> Number of PRS selection iterations (niter)                  : 4 #> PRS selection resolution method (resolution)                : frequency #> PRS selection resolution step (step)                        : 1 #> Minimum SNP frequency in PRS (minFreq)                      : 2 #> Minimum number of SNPs in PRS (minSnps)                     : 2 #> Drop quantiles with same number of SNPs (dropSameQuantiles) : Yes #> PRS aggregation method (aggregation)                        : intersectionunion #> SNP effect summarization method (effectWeight)              : meanmedianweight #> PRS evaluation framework (evalWith)                         : vanillaprscice #>  #> PRS selection options #> -------------------------------------------------------------------- #> PRS selection method (prsSelectMethod)           : maxima #> PRS selection criterion (prsSelectCrit)          : prs_r2 #> PRS criterion summarization (prsSelectStat)      : mean #> R^2 type if criterion includes R^2 (prsSelectR2) : adjusted #>  #> Miscellaneous options #> -------------------------------------------------------------------- #> Local workspace directory (prsWorkspace) : /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795 #> Cleanup level (cleanup)                  : intermediate #> PRS pipeline output type (dnOutput)      : normal #> Output level (output)                    : normal #> Run ID (runId)                           : auto #> Available cores fraction (rc)            : single core #>  #> **************************************************************** #> Executing PRISMA pipeline with glm #> **************************************************************** #>  #> ################################################################ #> 1. Discovery of de novo PRS candidates #> ################################################################ #> prisma operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline #>   #> Executing denovo pipeline iteration 1, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_iter_1.log #> ================================================================ #> -----> Denovo pipeline iteration 1 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 122 #>   Hardy-Weinberg equilibrium: 5 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 133 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: glm #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 24 associations (uncorrected p-values). #>  #> Overall, found 24 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 11 associations (uncorrected p-values). #>  #> Overall, found 11 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 24 associations found out of 561 markers #>   Part 21: 11 associations found out of 313 markers #>  #> Overall, found 35 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.00433642030136858 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1/base_AKJAD3604X \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1/pheno_AKJAD3604X \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1/plink_prsice_AKJAD3604X \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1/covar_AKJAD3604X \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_AKJAD3604X \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0880657 #> Full model R^2 is: 0.611383 #> Null model R^2 is: 0.523317 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_1/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 2, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_iter_2.log #> ================================================================ #> -----> Denovo pipeline iteration 2 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 119 #>   Hardy-Weinberg equilibrium: 5 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 120 #>   Hardy-Weinberg equilibrium: 3 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: glm #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 24 associations (uncorrected p-values). #>  #> Overall, found 24 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 20 associations (uncorrected p-values). #>  #> Overall, found 20 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 24 associations found out of 567 markers #>   Part 21: 20 associations found out of 311 markers #>  #> Overall, found 44 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.52053653038099 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2/base_FPZBY3337F \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2/pheno_FPZBY3337F \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2/plink_prsice_FPZBY3337F \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2/covar_FPZBY3337F \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_FPZBY3337F \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.204038 #> Full model R^2 is: 0.873717 #> Null model R^2 is: 0.66968 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_2/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 3, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_iter_3.log #> ================================================================ #> -----> Denovo pipeline iteration 3 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 121 #>   Hardy-Weinberg equilibrium: 3 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 119 #>   Hardy-Weinberg equilibrium: 0 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: glm #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 21 associations (uncorrected p-values). #>  #> Overall, found 21 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 14 associations (uncorrected p-values). #>  #> Overall, found 14 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 21 associations found out of 562 markers #>   Part 21: 14 associations found out of 315 markers #>  #> Overall, found 35 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.0400010719796725 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3/base_IQHZE4132U \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3/pheno_IQHZE4132U \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3/plink_prsice_IQHZE4132U \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3/covar_IQHZE4132U \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_IQHZE4132U \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.022937 #> Full model R^2 is: 0.463183 #> Null model R^2 is: 0.440246 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_3/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 4, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_iter_4.log #> ================================================================ #> -----> Denovo pipeline iteration 4 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 124 #>   Hardy-Weinberg equilibrium: 3 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 117 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: glm #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 22 associations (uncorrected p-values). #>  #> Overall, found 22 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 9 associations (uncorrected p-values). #>  #> Overall, found 9 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 22 associations found out of 562 markers #>   Part 21: 9 associations found out of 312 markers #>  #> Overall, found 31 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.0904002403440418 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4/base_WIDOQ1376X \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4/pheno_WIDOQ1376X \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4/plink_prsice_WIDOQ1376X \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4/covar_WIDOQ1376X \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_WIDOQ1376X \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0534201 #> Full model R^2 is: 0.653311 #> Null model R^2 is: 0.59989 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline/JUMSPCEZUPG2807Q_denovo_4/denovo_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/baseline #>  #> ################################################################ #> 2. Calculation of PRS evaluation metrics #> ################################################################ #> Aggregation mode: intersect #>   iteration 1 yields 2 markers #>   iteration 2 yields 47 markers #>   iteration 3 yields 3 markers #>   iteration 4 yields 61 markers #> Calculating frequencies #> Averaging effects with mean #> Constructing output #> Done! #>  #> ================================================================ #> -----> Frequency 2 <----- #> ================================================================ #> prisma operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2 #>   #> Executing evaluation pipeline iteration 1, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2/2_iter_1.log #> ================================================================ #> -----> Evaluation pipeline iteration 1 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9635852 #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2/2_evaluate_1/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 2, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2/2_iter_2.log #> ================================================================ #> -----> Evaluation pipeline iteration 2 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9635852 #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2/2_evaluate_2/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 3, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2/2_iter_3.log #> ================================================================ #> -----> Evaluation pipeline iteration 3 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9635852 #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2/2_evaluate_3/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 4, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2/2_iter_4.log #> ================================================================ #> -----> Evaluation pipeline iteration 4 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9635852 #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2/2_evaluate_4/evaluate_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/2 #>  #> ================================================================ #> -----> Frequency 3 <----- #> ================================================================ #> prisma operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3 #>   #> Executing evaluation pipeline iteration 1, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3/3_iter_1.log #> ================================================================ #> -----> Evaluation pipeline iteration 1 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs8093690 #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3/3_evaluate_1/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 2, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3/3_iter_2.log #> ================================================================ #> -----> Evaluation pipeline iteration 2 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs8093690 #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3/3_evaluate_2/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 3, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3/3_iter_3.log #> ================================================================ #> -----> Evaluation pipeline iteration 3 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs8093690 #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3/3_evaluate_3/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 4, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3/3_iter_4.log #> ================================================================ #> -----> Evaluation pipeline iteration 4 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs8093690 #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3/3_evaluate_4/evaluate_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/glm/selection/3 #>  #> ################################################################ #> 3. Selection of best PRS candidate markers #> ################################################################ #> The optimal number of markers for PRS based on prs_r2 is 4 at prs_r2=0.10411 #>  #> ################################################################ #> 4. Wrap-up and graphics #> ################################################################ #> sitadela database found at /home/panos/.local/share/R/sitadela directory #> Getting latest annotation on the fly for hg19 from refseq #> Retrieving genome information for hg19 from refseq #> Retrieving latest gene annotation for hg19 from refseq #> Loading required namespace: RMySQL #> Converting annotation to GenomicRanges object... #>  #> Attaching package: ‘Biostrings’ #> The following object is masked from ‘package:base’: #>  #>     strsplit #> Getting DNA sequences... #> Getting GC content... #>  #> **************************************************************** #> Executing PRISMA pipeline with statgen #> **************************************************************** #>  #> ################################################################ #> 1. Discovery of de novo PRS candidates #> ################################################################ #> prisma operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline #>   #> Executing denovo pipeline iteration 1, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_iter_1.log #> ================================================================ #> -----> Denovo pipeline iteration 1 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 116 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 134 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 17 associations (uncorrected p-values). #>  #> Overall, found 17 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 13 associations (uncorrected p-values). #>  #> Overall, found 13 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 17 associations found out of 568 markers #>   Part 21: 13 associations found out of 316 markers #>  #> Overall, found 30 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.0345300904223554 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1/base_LMEOS4099F \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1/pheno_LMEOS4099F \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1/plink_prsice_LMEOS4099F \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1/covar_LMEOS4099F \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_LMEOS4099F \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0384586 #> Full model R^2 is: 0.600874 #> Null model R^2 is: 0.562416 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_1/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 2, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_iter_2.log #> ================================================================ #> -----> Denovo pipeline iteration 2 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 118 #>   Hardy-Weinberg equilibrium: 7 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 129 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 32 associations (uncorrected p-values). #>  #> Overall, found 32 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 14 associations (uncorrected p-values). #>  #> Overall, found 14 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 32 associations found out of 565 markers #>   Part 21: 14 associations found out of 313 markers #>  #> Overall, found 46 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.154268723191176 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2/base_WAZVG6475F \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2/pheno_WAZVG6475F \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2/plink_prsice_WAZVG6475F \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2/covar_WAZVG6475F \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_WAZVG6475F \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.097563 #> Full model R^2 is: 0.490894 #> Null model R^2 is: 0.393331 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_2/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 3, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_iter_3.log #> ================================================================ #> -----> Denovo pipeline iteration 3 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 123 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 129 #>   Hardy-Weinberg equilibrium: 0 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 27 associations (uncorrected p-values). #>  #> Overall, found 27 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 14 associations (uncorrected p-values). #>  #> Overall, found 14 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 27 associations found out of 565 markers #>   Part 21: 14 associations found out of 312 markers #>  #> Overall, found 41 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.236351467360557 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3/base_XVUPR2986P \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3/pheno_XVUPR2986P \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3/plink_prsice_XVUPR2986P \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3/covar_XVUPR2986P \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_XVUPR2986P \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.104648 #> Full model R^2 is: 0.604003 #> Null model R^2 is: 0.499356 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_3/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 4, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_iter_4.log #> ================================================================ #> -----> Denovo pipeline iteration 4 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 121 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 135 #>   Hardy-Weinberg equilibrium: 5 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 24 associations (uncorrected p-values). #>  #> Overall, found 24 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 13 associations (uncorrected p-values). #>  #> Overall, found 13 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 24 associations found out of 565 markers #>   Part 21: 13 associations found out of 314 markers #>  #> Overall, found 37 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.0771703588765321 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4/base_QDNRW9625K \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4/pheno_QDNRW9625K \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4/plink_prsice_QDNRW9625K \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4/covar_QDNRW9625K \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_QDNRW9625K \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.174849 #> Full model R^2 is: 0.701351 #> Null model R^2 is: 0.526502 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline/JUMSPCEZUPG2807Q_denovo_4/denovo_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/baseline #>  #> ################################################################ #> 2. Calculation of PRS evaluation metrics #> ################################################################ #> Aggregation mode: intersect #>   iteration 1 yields 2 markers #>   iteration 2 yields 44 markers #>   iteration 3 yields 98 markers #>   iteration 4 yields 10 markers #> Calculating frequencies #> Averaging effects with mean #> Constructing output #> Done! #>  #> ================================================================ #> -----> Frequency 2 <----- #> ================================================================ #> prisma operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2 #>   #> Executing evaluation pipeline iteration 1, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2/2_iter_1.log #> ================================================================ #> -----> Evaluation pipeline iteration 1 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9977668 #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2/2_evaluate_1/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 2, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2/2_iter_2.log #> ================================================================ #> -----> Evaluation pipeline iteration 2 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9977668 #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2/2_evaluate_2/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 3, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2/2_iter_3.log #> ================================================================ #> -----> Evaluation pipeline iteration 3 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9977668 #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2/2_evaluate_3/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 4, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2/2_iter_4.log #> ================================================================ #> -----> Evaluation pipeline iteration 4 #> ================================================================ #> 1 SNPs not found in target data! Excluding... #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9977668 #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2/2_evaluate_4/evaluate_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/2 #>  #> ================================================================ #> -----> Frequency 3 <----- #> ================================================================ #> prisma operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3 #>   #> Executing evaluation pipeline iteration 1, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3/3_iter_1.log #> ================================================================ #> -----> Evaluation pipeline iteration 1 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9303974 #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3/3_evaluate_1/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 2, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3/3_iter_2.log #> ================================================================ #> -----> Evaluation pipeline iteration 2 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9303974 #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3/3_evaluate_2/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 3, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3/3_iter_3.log #> ================================================================ #> -----> Evaluation pipeline iteration 3 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9303974 #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3/3_evaluate_3/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 4, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3/3_iter_4.log #> ================================================================ #> -----> Evaluation pipeline iteration 4 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9303974 #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3/3_evaluate_4/evaluate_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e32ae2795/statgen/selection/3 #>  #> ################################################################ #> 3. Selection of best PRS candidate markers #> ################################################################ #> The optimal number of markers for PRS based on prs_r2 is 5 at prs_r2=0.11178 #>  #> ################################################################ #> 4. Wrap-up and graphics #> ################################################################ #> sitadela database found at /home/panos/.local/share/R/sitadela directory #> Getting latest annotation on the fly for hg19 from refseq #> Retrieving genome information for hg19 from refseq #> Retrieving latest gene annotation for hg19 from refseq #> Converting annotation to GenomicRanges object... #> Getting DNA sequences... #> Getting GC content... #>  #> 2022-06-06 20:12:38: Data processing finished! #> Total processing time: 03 minutes 58 seconds #>  #> prisma operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0 #>  #> Input #> -------------------------------------------------------------------- #> Input pipeline list (dnList) : a list of PRS pipeline summaries #> Input dataset object (gwe)   : a GWASExperiment object with 1000 markers (SNPs) and 100 samples #>  #> Regression parameters #> -------------------------------------------------------------------- #> Phenotypic response (phenotype)          : BMI #> Regression covariates (covariates)       : Case_Control, Gender, Age #> Principal Components in covariates (pcs) : No #> Number of Principal Components (npcs)    : - #>  #> Preprocessing options #> -------------------------------------------------------------------- #> Sample and genotype filtering options (filters)     : #>   snpCallRate    : 0.98 #>   sampleCallRate : 0.95 #>   maf            : 0.05 #>   hwe            : 0.001 #>   heteroStat     : median #>   heteroFac      : 3 #>   heteroHard     : NA #>   pcaOut         : No #>   pcaRobust      : hubert #>   nPC            : NA #>   LD             : 0.2 #>   IBD            : NA #>   inbreed        : NA #> Principal Components calculation method (pcaMethod) : snprel #> Impute missing genotypes (imputeMissing)            : No #> Missing genotype imputation method (imputeMethod)   : single #>  #> GWA analysis options #> -------------------------------------------------------------------- #> Genome-Wide Association tests (gwaMethods)        : statgen #> Association tests combination method (gwaCombine) : fisher #> Association tests options                         :  #>   statgen :  #>     kinship : astle #>     reml    : EMMA #>     gls     : single #>  #> PRS candidate extraction options #> -------------------------------------------------------------------- #> PRS extraction algorithms (prsMethods) : lassosum, prsice #> PRS algorithms options (prsMethods)    :  #>   lassosum :  #>     anc   : eur #>     valid : auto #>   prsice :  #>     clump_kb : 250 #>     clump_r2 : 0.1 #>     clump_p  : 0.75 #>     score    : avg #>     perm     : 100 #>     seed     : 42 #>  #> PRS construction and evaluation options #> -------------------------------------------------------------------- #> Training set size (trainSize)              : 80% #> Number of PRS selection iterations (niter) : 4 #> PRS evaluation framework (evalWith)        : vanilla #>  #> Miscellaneous options #> -------------------------------------------------------------------- #> Local workspace directory (prsWorkspace) : /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0 #> Cleanup level (cleanup)                  : intermediate #> Output type (output)                     : gwaslist #> Run ID (runId)                           : XCLQPXOSPSO9247L #> Available cores fraction (rc)            : single core #>   #> Executing denovo pipeline iteration 1, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_iter_1.log #> ================================================================ #> -----> Denovo pipeline iteration 1 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 119 #>   Hardy-Weinberg equilibrium: 3 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 131 #>   Hardy-Weinberg equilibrium: 0 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 25 associations (uncorrected p-values). #>  #> Overall, found 25 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 10 associations (uncorrected p-values). #>  #> Overall, found 10 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 25 associations found out of 564 markers #>   Part 21: 10 associations found out of 316 markers #>  #> Overall, found 35 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.014729117709171 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1/base_JVXIR2543F \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1/pheno_JVXIR2543F \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1/plink_prsice_JVXIR2543F \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1/covar_JVXIR2543F \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_JVXIR2543F \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.075073 #> Full model R^2 is: 0.513838 #> Null model R^2 is: 0.438765 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_1/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 2, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_iter_2.log #> ================================================================ #> -----> Denovo pipeline iteration 2 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 120 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 125 #>   Hardy-Weinberg equilibrium: 0 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 30 associations (uncorrected p-values). #>  #> Overall, found 30 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 12 associations (uncorrected p-values). #>  #> Overall, found 12 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 30 associations found out of 566 markers #>   Part 21: 12 associations found out of 314 markers #>  #> Overall, found 42 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.189424254816086 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2/base_ISNSU0521Y \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2/pheno_ISNSU0521Y \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2/plink_prsice_ISNSU0521Y \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2/covar_ISNSU0521Y \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_ISNSU0521Y \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.204691 #> Full model R^2 is: 0.644458 #> Null model R^2 is: 0.439766 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_2/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 3, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_iter_3.log #> ================================================================ #> -----> Denovo pipeline iteration 3 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 115 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 121 #>   Hardy-Weinberg equilibrium: 4 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 26 associations (uncorrected p-values). #>  #> Overall, found 26 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 12 associations (uncorrected p-values). #>  #> Overall, found 12 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 26 associations found out of 567 markers #>   Part 21: 12 associations found out of 317 markers #>  #> Overall, found 38 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.0803632054297046 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3/base_MSANV2643F \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3/pheno_MSANV2643F \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3/plink_prsice_MSANV2643F \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3/covar_MSANV2643F \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_MSANV2643F \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.152777 #> Full model R^2 is: 0.724196 #> Null model R^2 is: 0.571419 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_3/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 4, log is at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_iter_4.log #> ================================================================ #> -----> Denovo pipeline iteration 4 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 117 #>   Hardy-Weinberg equilibrium: 4 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 134 #>   Hardy-Weinberg equilibrium: 3 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 24 associations (uncorrected p-values). #>  #> Overall, found 24 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 14 associations (uncorrected p-values). #>  #> Overall, found 14 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 24 associations found out of 569 markers #>   Part 21: 14 associations found out of 312 markers #>  #> Overall, found 38 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.00882964763212319 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4/base_AJXPV2017Q \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4/pheno_AJXPV2017Q \\ #>   --target /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4/plink_prsice_AJXPV2017Q \\ #>   --cov /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4/covar_AJXPV2017Q \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_AJXPV2017Q \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0364975 #> Full model R^2 is: 0.355984 #> Null model R^2 is: 0.319487 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0/XCLQPXOSPSO9247L_denovo_4/denovo_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha//tmp/Rtmpxo9Dha/file381e1139bcc0 #> Aggregation mode: intersect #>   iteration 1 yields 4 markers #>   iteration 2 yields 68 markers #>   iteration 3 yields 2 markers #>   iteration 4 yields 4 markers #> Calculating frequencies #> Averaging effects with mean #> Constructing output #> Done! #>  #> Input #> -------------------------------------------------------------------- #> Input object (gwe) : a GWASExperiment object with 1000 markers (SNPs) and 100 samples #>  #> Regression parameters #> -------------------------------------------------------------------- #> Error in eval(args$phenotype): object 'response' not found  # Complete pipeline with report and checkpoints # Complete 4-iteration PRS pipeline - ~1 min to run with 4 cores - no PCA if (Sys.which(\"PRSice_linux\") != \"\") {  outPath <- tempfile() d4 <- tempfile() wspace4 <- file.path(outPath,d4) prismaPipeline(     gwe=toy,     phenotype=response,     covariates=covariates,     pcs=FALSE,     trainSize=0.8,     niter=4,     resolution=\"frequency\",     minSnps=2,     filters=filts,     pcaMethod=\"snprel\",     imputeMissing=FALSE,     gwaMethods=c(\"glm\",\"statgen\"),     prsiceOpts=list(clump_p=0.75,perm=100),     prsWorkspace=wspace4,     cleanup=\"intermediate\",     logging=\"file\",     output=\"normal\",     #rc=0.25,     outPath=outPath )  file.exists(file.path(outPath,\"prismaOut.RData\")) # TRUE  } #>  #> $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ #> This is PRISMA 0.0.2 PRS builder #> $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ #>  #> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ #> 2022-06-06 20:13:58 - Try 1 #> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ #>  #> 2022-06-06 20:13:58: Data processing started... #>  #> Input #> -------------------------------------------------------------------- #> Input object (gwe) : a GWASExperiment object with 1000 markers (SNPs) and 100 samples #>  #> Regression parameters #> -------------------------------------------------------------------- #> Phenotypic response (phenotype)          : BMI #> Regression covariates (covariates)       : Case_Control, Gender, Age #> Principal Components in covariates (pcs) : No #> Number of Principal Components (npcs)    : - #>  #> Preprocessing options #> -------------------------------------------------------------------- #> Sample and genotype filtering options (filters)     : #>   snpCallRate    : 0.98 #>   sampleCallRate : 0.95 #>   maf            : 0.05 #>   hwe            : 0.001 #>   heteroStat     : median #>   heteroFac      : 3 #>   heteroHard     : NA #>   pcaOut         : No #>   pcaRobust      : hubert #>   nPC            : NA #>   LD             : 0.2 #>   IBD            : NA #>   inbreed        : NA #> Principal Components calculation method (pcaMethod) : snprel #> Impute missing genotypes (imputeMissing)            : No #> Missing genotype imputation method (imputeMethod)   : singlesplit #>  #> GWA analysis options #> -------------------------------------------------------------------- #> Genome-Wide Association tests (gwaMethods)        : glm, statgen #> Association tests combination method (gwaCombine) : fishersimesmaxminharmonicwhitlockpandora #> Association tests options                         :  #>   glm :  #>     family : - #>     size   : 1 #>   statgen :  #>     kinship : astle #>     reml    : EMMA #>     gls     : single #>  #> PRS candidate extraction options #> -------------------------------------------------------------------- #> PRS extraction algorithms (prsMethods) : lassosum, prsice #> PRS algorithms options (prsMethods)    :  #>   lassosum :  #>     anc   : eur #>     valid : auto #>   prsice :  #>     clump_kb : 250 #>     clump_r2 : 0.1 #>     clump_p  : 0.75 #>     score    : avg #>     perm     : 100 #>     seed     : 42 #>  #> PRS construction and evaluation options #> -------------------------------------------------------------------- #> Training set size (trainSize)                               : 80% #> Number of PRS selection iterations (niter)                  : 4 #> PRS selection resolution method (resolution)                : frequency #> PRS selection resolution step (step)                        : 1 #> Minimum SNP frequency in PRS (minFreq)                      : 2 #> Minimum number of SNPs in PRS (minSnps)                     : 2 #> Drop quantiles with same number of SNPs (dropSameQuantiles) : Yes #> PRS aggregation method (aggregation)                        : intersectionunion #> SNP effect summarization method (effectWeight)              : meanmedianweight #> PRS evaluation framework (evalWith)                         : vanillaprscice #>  #> PRS selection options #> -------------------------------------------------------------------- #> PRS selection method (prsSelectMethod)           : maxima #> PRS selection criterion (prsSelectCrit)          : prs_r2 #> PRS criterion summarization (prsSelectStat)      : mean #> R^2 type if criterion includes R^2 (prsSelectR2) : adjusted #>  #> Miscellaneous options #> -------------------------------------------------------------------- #> Local workspace directory (prsWorkspace) : /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458 #> Cleanup level (cleanup)                  : intermediate #> PRS pipeline output type (dnOutput)      : normal #> Output level (output)                    : normal #> Run ID (runId)                           : auto #> Available cores fraction (rc)            : single core #>  #> **************************************************************** #> Executing PRISMA pipeline with glm #> **************************************************************** #>  #> ################################################################ #> 1. Discovery of de novo PRS candidates #> ################################################################ #> prisma operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline #>   #> Executing denovo pipeline iteration 1, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_iter_1.log #> ================================================================ #> -----> Denovo pipeline iteration 1 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 118 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 128 #>   Hardy-Weinberg equilibrium: 6 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: glm #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 22 associations (uncorrected p-values). #>  #> Overall, found 22 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 15 associations (uncorrected p-values). #>  #> Overall, found 15 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 22 associations found out of 565 markers #>   Part 21: 15 associations found out of 316 markers #>  #> Overall, found 37 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.00454763100621826 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1/base_UUOHQ4284D \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1/pheno_UUOHQ4284D \\ #>   --target /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1/plink_prsice_UUOHQ4284D \\ #>   --cov /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1/covar_UUOHQ4284D \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_UUOHQ4284D \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0800997 #> Full model R^2 is: 0.550064 #> Null model R^2 is: 0.469964 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_1/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 2, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_iter_2.log #> ================================================================ #> -----> Denovo pipeline iteration 2 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 119 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 118 #>   Hardy-Weinberg equilibrium: 0 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: glm #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 24 associations (uncorrected p-values). #>  #> Overall, found 24 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 21 associations (uncorrected p-values). #>  #> Overall, found 21 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 24 associations found out of 566 markers #>   Part 21: 21 associations found out of 314 markers #>  #> Overall, found 45 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.104679411827688 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2/base_GTKRN1473Y \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2/pheno_GTKRN1473Y \\ #>   --target /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2/plink_prsice_GTKRN1473Y \\ #>   --cov /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2/covar_GTKRN1473Y \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_GTKRN1473Y \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0962855 #> Full model R^2 is: 0.603342 #> Null model R^2 is: 0.507056 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_2/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 3, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_iter_3.log #> ================================================================ #> -----> Denovo pipeline iteration 3 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 120 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 118 #>   Hardy-Weinberg equilibrium: 0 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: glm #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 22 associations (uncorrected p-values). #>  #> Overall, found 22 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 13 associations (uncorrected p-values). #>  #> Overall, found 13 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 22 associations found out of 564 markers #>   Part 21: 13 associations found out of 315 markers #>  #> Overall, found 35 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.00205692052718663 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3/base_TBJCU2021O \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3/pheno_TBJCU2021O \\ #>   --target /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3/plink_prsice_TBJCU2021O \\ #>   --cov /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3/covar_TBJCU2021O \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_TBJCU2021O \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0822372 #> Full model R^2 is: 0.769317 #> Null model R^2 is: 0.68708 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_3/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 4, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_iter_4.log #> ================================================================ #> -----> Denovo pipeline iteration 4 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 120 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 128 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: glm #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs1009238 to rs1568327 #> Found 19 associations (uncorrected p-values). #>  #> Overall, found 19 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>   testing SNPs from rs2824974 to rs2828316 #> Found 18 associations (uncorrected p-values). #>  #> Overall, found 18 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 19 associations found out of 565 markers #>   Part 21: 18 associations found out of 315 markers #>  #> Overall, found 37 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.00764704864422903 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4/base_GPKSB7920W \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4/pheno_GPKSB7920W \\ #>   --target /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4/plink_prsice_GPKSB7920W \\ #>   --cov /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4/covar_GPKSB7920W \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_GPKSB7920W \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0540151 #> Full model R^2 is: 0.634166 #> Null model R^2 is: 0.580151 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline/ETQQBQRMODZ4103Z_denovo_4/denovo_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/baseline #>  #> ################################################################ #> 2. Calculation of PRS evaluation metrics #> ################################################################ #> Aggregation mode: intersect #>   iteration 1 yields 4 markers #>   iteration 2 yields 65 markers #>   iteration 3 yields 8 markers #>   iteration 4 yields 61 markers #> Calculating frequencies #> Averaging effects with mean #> Constructing output #> Done! #>  #> ================================================================ #> -----> Frequency 2 <----- #> ================================================================ #> prisma operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2 #>   #> Executing evaluation pipeline iteration 1, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2/2_iter_1.log #> ================================================================ #> -----> Evaluation pipeline iteration 1 #> ================================================================ #> 1 SNPs not found in target data! Excluding... #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs9949696 #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2/2_evaluate_1/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 2, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2/2_iter_2.log #> ================================================================ #> -----> Evaluation pipeline iteration 2 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs9949696 #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2/2_evaluate_2/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 3, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2/2_iter_3.log #> ================================================================ #> -----> Evaluation pipeline iteration 3 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs9949696 #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2/2_evaluate_3/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 4, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2/2_iter_4.log #> ================================================================ #> -----> Evaluation pipeline iteration 4 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs9949696 #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2/2_evaluate_4/evaluate_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/2 #>  #> ================================================================ #> -----> Frequency 3 <----- #> ================================================================ #> prisma operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3 #>   #> Executing evaluation pipeline iteration 1, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3/3_iter_1.log #> ================================================================ #> -----> Evaluation pipeline iteration 1 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs9635852 #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3/3_evaluate_1/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 2, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3/3_iter_2.log #> ================================================================ #> -----> Evaluation pipeline iteration 2 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs9635852 #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3/3_evaluate_2/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 3, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3/3_iter_3.log #> ================================================================ #> -----> Evaluation pipeline iteration 3 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs9635852 #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3/3_evaluate_3/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 4, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3/3_iter_4.log #> ================================================================ #> -----> Evaluation pipeline iteration 4 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs9635852 #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3/3_evaluate_4/evaluate_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/3 #>  #> ================================================================ #> -----> Frequency 4 <----- #> ================================================================ #> prisma operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4 #>   #> Executing evaluation pipeline iteration 1, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4/4_iter_1.log #> ================================================================ #> -----> Evaluation pipeline iteration 1 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs7280065 #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4/4_evaluate_1/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 2, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4/4_iter_2.log #> ================================================================ #> -----> Evaluation pipeline iteration 2 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs7280065 #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4/4_evaluate_2/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 3, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4/4_iter_3.log #> ================================================================ #> -----> Evaluation pipeline iteration 3 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs7280065 #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4/4_evaluate_3/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 4, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4/4_iter_4.log #> ================================================================ #> -----> Evaluation pipeline iteration 4 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs16943205 to rs7280065 #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4/4_evaluate_4/evaluate_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/glm/selection/4 #>  #> ################################################################ #> 3. Selection of best PRS candidate markers #> ################################################################ #> The optimal number of markers for PRS based on prs_r2 is 3 at prs_r2=0.04812 #>  #> ################################################################ #> 4. Wrap-up and graphics #> ################################################################ #> sitadela database found at /home/panos/.local/share/R/sitadela directory #> Getting latest annotation on the fly for hg19 from refseq #> Retrieving genome information for hg19 from refseq #> Retrieving latest gene annotation for hg19 from refseq #> Converting annotation to GenomicRanges object... #> Getting DNA sequences... #> Getting GC content... #>  #> **************************************************************** #> Executing PRISMA pipeline with statgen #> **************************************************************** #>  #> ################################################################ #> 1. Discovery of de novo PRS candidates #> ################################################################ #> prisma operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline #>   #> Executing denovo pipeline iteration 1, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_iter_1.log #> ================================================================ #> -----> Denovo pipeline iteration 1 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 120 #>   Hardy-Weinberg equilibrium: 4 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 120 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 3 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 15 associations (uncorrected p-values). #>  #> Overall, found 15 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 14 associations (uncorrected p-values). #>  #> Overall, found 14 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 15 associations found out of 565 markers #>   Part 21: 14 associations found out of 313 markers #>  #> Overall, found 29 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 17 out of 17 samples kept in pheno. #> 17 out of 17 samples kept in covar. #> Done! R^2 is: 0.0216081429776474 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1/base_IPQEJ9475C \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1/pheno_IPQEJ9475C \\ #>   --target /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1/plink_prsice_IPQEJ9475C \\ #>   --cov /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1/covar_IPQEJ9475C \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_IPQEJ9475C \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.332271 #> Full model R^2 is: 0.817882 #> Null model R^2 is: 0.485611 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_1/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 2, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_iter_2.log #> ================================================================ #> -----> Denovo pipeline iteration 2 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 119 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 126 #>   Hardy-Weinberg equilibrium: 0 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 28 associations (uncorrected p-values). #>  #> Overall, found 28 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 13 associations (uncorrected p-values). #>  #> Overall, found 13 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 28 associations found out of 566 markers #>   Part 21: 13 associations found out of 314 markers #>  #> Overall, found 41 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.110477819737347 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2/base_BHQOG6084H \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2/pheno_BHQOG6084H \\ #>   --target /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2/plink_prsice_BHQOG6084H \\ #>   --cov /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2/covar_BHQOG6084H \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_BHQOG6084H \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0987099 #> Full model R^2 is: 0.685136 #> Null model R^2 is: 0.586426 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_2/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 3, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_iter_3.log #> ================================================================ #> -----> Denovo pipeline iteration 3 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 116 #>   Hardy-Weinberg equilibrium: 2 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 125 #>   Hardy-Weinberg equilibrium: 0 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 26 associations (uncorrected p-values). #>  #> Overall, found 26 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 10 associations (uncorrected p-values). #>  #> Overall, found 10 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 26 associations found out of 568 markers #>   Part 21: 10 associations found out of 316 markers #>  #> Overall, found 36 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.0184869548478244 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3/base_IWVRP9947M \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3/pheno_IWVRP9947M \\ #>   --target /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3/plink_prsice_IWVRP9947M \\ #>   --cov /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3/covar_IWVRP9947M \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_IWVRP9947M \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0551661 #> Full model R^2 is: 0.720956 #> Null model R^2 is: 0.66579 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_3/denovo_result.RData----- #> ================================================================ #> Executing denovo pipeline iteration 4, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_iter_4.log #> ================================================================ #> -----> Denovo pipeline iteration 4 #> ================================================================ #> ----- Dataset partitioning ----- #> Partitioning dataset into 1 partitions by BMI #>  #> ----- Training (base) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 119 #>   Hardy-Weinberg equilibrium: 3 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Test (target) QC ----- #>  #> Performing basic filtering #>   Calculating SNP summaries for filtering #>   SNP filters #>     Call rate #>     Minor Allele Frequency #>     Hardy-Weinberg equilibrium #>   Sample filters #>     Call rate #>     Heterozygosity #>   Summarizing SNP filter results #>   Summarizing sample filter results #>  #> ----- Filtering report: ----- #> Filtered SNPs: #>   SNP call rate             : 0 #>   Minor Allele Frequency    : 129 #>   Hardy-Weinberg equilibrium: 1 #>  #> Filtered samples: #>   Sample call rate          : 0 #>   Heterozygosity            : 0 #>   Inbreed                   : 0 #>  #>  #> ----- Training (base) GWAS ----- #>  #> Starting GWA analysis in 2 chunks with 1 methods: statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 25 associations (uncorrected p-values). #>  #> Overall, found 25 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Use PCs     : No #> Found 8 associations (uncorrected p-values). #>  #> Overall, found 8 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 25 associations found out of 565 markers #>   Part 21: 8 associations found out of 315 markers #>  #> Overall, found 33 associations with (uncorrected) combined p-values). #>  #> ----- PRS analysis with base and target ----- #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4 #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4 #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Running lassosum validation and PRS calculation #> 20 out of 20 samples kept in pheno. #> 20 out of 20 samples kept in covar. #> Done! R^2 is: 0.0321168599104062 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4 #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4 #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4/base_NSNNX5893N \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4/pheno_NSNNX5893N \\ #>   --target /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4/plink_prsice_NSNNX5893N \\ #>   --cov /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4/covar_NSNNX5893N \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 0.75 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_NSNNX5893N \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.0755859 #> Full model R^2 is: 0.569995 #> Null model R^2 is: 0.494409 #>  #> Running PRS algorithms finished! Processing the results... #> Done! #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline/ETQQBQRMODZ4103Z_denovo_4/denovo_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/baseline #>  #> ################################################################ #> 2. Calculation of PRS evaluation metrics #> ################################################################ #> Aggregation mode: intersect #>   iteration 1 yields 1 markers #>   iteration 2 yields 17 markers #>   iteration 3 yields 74 markers #>   iteration 4 yields 6 markers #> Calculating frequencies #> Averaging effects with mean #> Constructing output #> Done! #>  #> ================================================================ #> -----> Frequency 2 <----- #> ================================================================ #> prisma operations will be executed at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2 #>   #> Executing evaluation pipeline iteration 1, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2/2_iter_1.log #> ================================================================ #> -----> Evaluation pipeline iteration 1 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9635852 #>  #> ----- Saving iteration 1 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2/2_evaluate_1/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 2, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2/2_iter_2.log #> ================================================================ #> -----> Evaluation pipeline iteration 2 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9635852 #>  #> ----- Saving iteration 2 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2/2_evaluate_2/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 3, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2/2_iter_3.log #> ================================================================ #> -----> Evaluation pipeline iteration 3 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9635852 #>  #> ----- Saving iteration 3 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2/2_evaluate_3/evaluate_result.RData----- #> ================================================================ #> Executing evaluation pipeline iteration 4, log is at /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2/2_iter_4.log #> ================================================================ #> -----> Evaluation pipeline iteration 4 #> ================================================================ #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs1740090 to rs9635852 #>  #> ----- Saving iteration 4 result to /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2/2_evaluate_4/evaluate_result.RData----- #> ================================================================ #> Cleaning up temporary program-specific intermediate files from /tmp/Rtmpxo9Dha/file381e281d1c85//tmp/Rtmpxo9Dha/file381e3f707458/statgen/selection/2 #>  #> ################################################################ #> 3. Selection of best PRS candidate markers #> ################################################################ #> The optimal number of markers for PRS based on prs_r2 is 14 at prs_r2=0.15788 #>  #> ################################################################ #> 4. Wrap-up and graphics #> ################################################################ #> sitadela database found at /home/panos/.local/share/R/sitadela directory #> Getting latest annotation on the fly for hg19 from refseq #> Retrieving genome information for hg19 from refseq #> Retrieving latest gene annotation for hg19 from refseq #> Converting annotation to GenomicRanges object... #> Getting DNA sequences... #> Getting GC content... #>  #> 2022-06-06 20:17:45: Data processing finished! #> Total processing time: 03 minutes 47 seconds #>  #> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ #> 2022-06-06 20:17:48 - Cross-validation #> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ #>  #> ################################################################ #> Running cross-validations for glm with 10 leave-out cases across 1 PRS candidates #> ################################################################ #>  #> ================================================================ #> -----> Cross-validating PRS candidate with 3 markers #> ================================================================ #>  #> ----- Leave-out percentage 5% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 10% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 15% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 20% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 25% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 30% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 35% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 40% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 45% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 50% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ################################################################ #> Running cross-validations for statgen with 10 leave-out cases across 1 PRS candidates #> ################################################################ #>  #> ================================================================ #> -----> Cross-validating PRS candidate with 14 markers #> ================================================================ #>  #> ----- Leave-out percentage 5% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 10% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 15% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 20% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 25% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 30% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 35% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 40% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 45% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ----- Leave-out percentage 50% ----- #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #>  #> ================================================================ #> -----> Cross-validation iteration 1 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 2 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 3 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 4 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 5 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 6 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 7 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 8 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 9 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ================================================================ #> -----> Cross-validation iteration 10 #> ================================================================ #> Partitioning dataset into 1 partitions by BMI #> Creating the reduced model #> Creating the full model #>  #> ################################################################ #> Done! Use summarizeCvMetrics() and plotCvMetrics() to summarize and inspect the results. #> ################################################################ #>  #> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ #> 2022-06-06 20:18:04 - GWAS Catalog lookup #> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ #> -----> Querying for glm #> Querying GWAS Catalog with the largest PRS #> -----> Querying for statgen #> Querying GWAS Catalog with the largest PRS #>  #> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ #> 2022-06-06 20:18:05 - Report #> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ #>  #>  #> processing file: prisma_report.Rmd #>    |                                                                               |                                                                      |   0%   |                                                                               |.                                                                     |   1% #>    inline R code fragments #>  #> A project name here   |                                                                               |.                                                                     |   2% #> label: knitr_init (with options)  #> List of 2 #>  $ echo : logi FALSE #>  $ cache: logi FALSE #>  #>    |                                                                               |..                                                                    |   3% #>    |                                                                               |..                                                                    |   4% #>  #> Attaching package: 'pander' #> The following object is masked from 'package:htmltools': #>  #>     p #>  #> Attaching package: 'grid' #> The following object is masked from 'package:Biostrings': #>  #>     pattern #> Summarizing cross-validation statistics for PRS with 3 SNPs #> Summarizing cross-validation statistics for PRS with 14 SNPs #>    |                                                                               |...                                                                   |   4% #>    |                                                                               |....                                                                  |   5% #>    |                                                                               |....                                                                  |   6% #>    |                                                                               |.....                                                                 |   7% #>    |                                                                               |......                                                                |   8% #>    |                                                                               |......                                                                |   9% #>    |                                                                               |.......                                                               |  10% #>    |                                                                               |.......                                                               |  11% #>    |                                                                               |........                                                              |  11% #>    |                                                                               |.........                                                             |  12% #>    |                                                                               |.........                                                             |  13% #>    |                                                                               |..........                                                            |  14% #>    |                                                                               |..........                                                            |  15% #>    |                                                                               |...........                                                           |  16% #>    |                                                                               |............                                                          |  17% #>    |                                                                               |............                                                          |  18% #>    |                                                                               |.............                                                         |  18% #>    |                                                                               |..............                                                        |  19% #>    |                                                                               |..............                                                        |  20% #>    |                                                                               |...............                                                       |  21% #>    |                                                                               |...............                                                       |  22% #>    |                                                                               |................                                                      |  23% #>    |                                                                               |.................                                                     |  24% #>    |                                                                               |.................                                                     |  25% #>    |                                                                               |..................                                                    |  25% #>    |                                                                               |..................                                                    |  26% #>    |                                                                               |...................                                                   |  27% #>    |                                                                               |....................                                                  |  28% #>    |                                                                               |....................                                                  |  29% #>    |                                                                               |.....................                                                 |  30% #>    |                                                                               |.....................                                                 |  31% #>    |                                                                               |......................                                                |  32% #>    |                                                                               |.......................                                               |  32% #>    |                                                                               |.......................                                               |  33% #>    |                                                                               |........................                                              |  34% #>    |                                                                               |.........................                                             |  35% #>    |                                                                               |.........................                                             |  36% #>    |                                                                               |..........................                                            |  37% #>    |                                                                               |..........................                                            |  38% #>    |                                                                               |...........................                                           |  39% #>    |                                                                               |............................                                          |  39% #>    |                                                                               |............................                                          |  40% #>    |                                                                               |.............................                                         |  41% #>    |                                                                               |.............................                                         |  42% #>    |                                                                               |..............................                                        |  43% #>    |                                                                               |...............................                                       |  44% #>    |                                                                               |...............................                                       |  45% #>    |                                                                               |................................                                      |  46% #>    |                                                                               |.................................                                     |  46% #>    |                                                                               |.................................                                     |  47% #>    |                                                                               |..................................                                    |  48% #>    |                                                                               |..................................                                    |  49% #>    |                                                                               |...................................                                   |  50% #>    |                                                                               |....................................                                  |  51% #>    |                                                                               |....................................                                  |  52% #>    |                                                                               |.....................................                                 |  53% #>    |                                                                               |.....................................                                 |  54% #>    |                                                                               |......................................                                |  54% #>    |                                                                               |.......................................                               |  55% #>    |                                                                               |.......................................                               |  56% #>    |                                                                               |........................................                              |  57% #>    |                                                                               |.........................................                             |  58% #>    |                                                                               |.........................................                             |  59% #>    |                                                                               |..........................................                            |  60% #>    |                                                                               |..........................................                            |  61% #>    |                                                                               |...........................................                           |  61% #>    |                                                                               |............................................                          |  62% #>    |                                                                               |............................................                          |  63% #>    |                                                                               |.............................................                         |  64% #>    |                                                                               |.............................................                         |  65% #>    |                                                                               |..............................................                        |  66% #>    |                                                                               |...............................................                       |  67% #>    |                                                                               |...............................................                       |  68% #>    |                                                                               |................................................                      |  68% #>    |                                                                               |.................................................                     |  69% #>    |                                                                               |.................................................                     |  70% #>    |                                                                               |..................................................                    |  71% #>    |                                                                               |..................................................                    |  72% #>    |                                                                               |...................................................                   |  73% #>    |                                                                               |....................................................                  |  74% #>    |                                                                               |....................................................                  |  75% #>    |                                                                               |.....................................................                 |  75% #>    |                                                                               |.....................................................                 |  76% #>    |                                                                               |......................................................                |  77% #>    |                                                                               |.......................................................               |  78% #>    |                                                                               |.......................................................               |  79% #>    |                                                                               |........................................................              |  80% #>    |                                                                               |........................................................              |  81% #>    |                                                                               |.........................................................             |  82% #>    |                                                                               |..........................................................            |  82% #>    |                                                                               |..........................................................            |  83% #>    |                                                                               |...........................................................           |  84% #>    |                                                                               |............................................................          |  85% #>    |                                                                               |............................................................          |  86% #>    |                                                                               |.............................................................         |  87% #>    |                                                                               |.............................................................         |  88% #>    |                                                                               |..............................................................        |  89% #>    |                                                                               |...............................................................       |  89% #>    |                                                                               |...............................................................       |  90% #>    |                                                                               |................................................................      |  91% #>    |                                                                               |................................................................      |  92% #>    |                                                                               |.................................................................     |  93% #>    |                                                                               |..................................................................    |  94% #>    |                                                                               |..................................................................    |  95% #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. #>    |                                                                               |...................................................................   |  96% #>    |                                                                               |....................................................................  |  96% #>    |                                                                               |....................................................................  |  97% #>    |                                                                               |..................................................................... |  98% #>    |                                                                               |..................................................................... |  99% #>    |                                                                               |......................................................................| 100% #>  #> output file: prisma_report.knit.md #> /usr/bin/pandoc +RTS -K512m -RTS prisma_report.knit.md --to html4 --from markdown+autolink_bare_uris+tex_math_single_backslash --output /tmp/Rtmpxo9Dha/file381e281d1c85/index.html --variable 'robobook:true' --variable 'lightbox:true' --variable 'gallery:false' --variable 'cards:true' --variable bs3=TRUE --standalone --section-divs --table-of-contents --toc-depth 2 --template /home/panos/R/x86_64-pc-linux-gnu-library/4.1/rmdformats/templates/template.html --highlight-style kate --variable theme=bootstrap --include-in-header /tmp/Rtmpxo9Dha/rmarkdown-str381e67ab561b.html  #>  #> Output created: /tmp/Rtmpxo9Dha/file381e281d1c85/index.html #> [1] TRUE"},{"path":"/reference/prismaOut.html","id":null,"dir":"Reference","previous_headings":"","what":"A sample output from the prisma pipeline — prismaOut","title":"A sample output from the prisma pipeline — prismaOut","text":"output prisma function produced     toy dataset included package. used     speed purposes prisma downstream functions.","code":""},{"path":"/reference/prismaOut.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A sample output from the prisma pipeline — prismaOut","text":"prisma function output list.","code":""},{"path":"/reference/prismaOut.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A sample output from the prisma pipeline — prismaOut","text":"Kalafati et al. (https://doi.org/10.1016/j.nut.2018.10.032)","code":""},{"path":"/reference/prismaOut.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A sample output from the prisma pipeline — prismaOut","text":"Panagiotis Moulos","code":""},{"path":"/reference/prismaOutFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to get data from PRISMA outputs — prismaOutFuns","title":"Functions to get data from PRISMA outputs — prismaOutFuns","text":"getPrsCandidates function facilitates     retrieval PRS candidates (data frames)     complex output link{prisma}. gwaTests function lists GWA methods     used prisma call.","code":""},{"path":"/reference/prismaOutFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to get data from PRISMA outputs — prismaOutFuns","text":"","code":"getPrsCandidates(prismaOut, method, index = NULL)          gwaTests(prismaOut)          prismaReport(gwe, prismaOut, cvMetricsOut, lookupOut,         path = NULL)"},{"path":"/reference/prismaOutFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to get data from PRISMA outputs — prismaOutFuns","text":"prismaOut output object prisma     list PRS candidate data frames. method GWA method supported, see also      gwa function. index integer denoting candidate get     available ones. NULL, list     candidates returned. gwe GWASExperiment object used generate     prismaOut. cvMetricsOut output      prismaCrossValidate function. lookupOut output prismaLookup      function. path path write interactive prisma      report. Defaults NULL auto-generation     current path (getwd()).","code":""},{"path":"/reference/prismaOutFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to get data from PRISMA outputs — prismaOutFuns","text":"data frame list data frame SNPs comprising     PRS candidate(s). case prismaReport,     interactive HTML report.","code":""},{"path":"/reference/prismaOutFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to get data from PRISMA outputs — prismaOutFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/prismaOutFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to get data from PRISMA outputs — prismaOutFuns","text":"","code":"data(prisma_out,package=\"prisma\")          can <- getPrsCandidates(prismaOut,\"glm\",1)     gwaTests(prismaOut) #> [1] \"glm\"     \"statgen\""},{"path":"/reference/prismaVerbosity.html","id":null,"dir":"Reference","previous_headings":"","what":"Verbosity of output messages — prismaVerbosity","title":"Verbosity of output messages — prismaVerbosity","text":"function prints () helpful user messages.","code":""},{"path":"/reference/prismaVerbosity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Verbosity of output messages — prismaVerbosity","text":"","code":"prismaVerbosity(level = NULL)"},{"path":"/reference/prismaVerbosity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Verbosity of output messages — prismaVerbosity","text":"level verbosity level, one \"silent\",     \"normal\" (default), \"full\"      \"debug\". See also Details","code":""},{"path":"/reference/prismaVerbosity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Verbosity of output messages — prismaVerbosity","text":"function return value. Instead,      sets R option controls verbosity level.","code":""},{"path":"/reference/prismaVerbosity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Verbosity of output messages — prismaVerbosity","text":"Regarding level argument, \"silent\"     output messages suppressed,      \"normal\", reasonable informative output     produced. \"full\", verbose output     produced fuction messages     produced \"debug\" mode.","code":""},{"path":"/reference/prismaVerbosity.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Verbosity of output messages — prismaVerbosity","text":"Panagiotis Moulos","code":""},{"path":"/reference/prismaVerbosity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Verbosity of output messages — prismaVerbosity","text":"","code":"prismaVerbosity(\"silent\")     prismaVerbosity(\"normal\")"},{"path":"/reference/prsFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to extract PRS candidates with various algorithms — prsFuns","title":"Functions to extract PRS candidates with various algorithms — prsFuns","text":"functions perform PRS extraction given one     two (base target) GWASExperiment objects.     lassosumPRS wrapper around lassosum     PRS extraction algorithm prsicePRS     wrapper around PRSice2 PRS extraction algorithm.     runPRS wrapper around two others     makes sure proper objects retured.","code":""},{"path":"/reference/prsFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to extract PRS candidates with various algorithms — prsFuns","text":"","code":"lassosumPRS(base, target = base, response, covariates = NULL,         pcs = FALSE, wspace = NULL, anc = c(\"eur\", \"asn\", \"afr\"),         valid = c(\"auto\", \"stack\", \"split\"), rc = NULL)          PRS(gwe, snpSelection, type = c(\"avg\", \"sum\", \"std\"))          prsicePRS(base, target = base, response, covariates = NULL,         pcs = FALSE, mode = c(\"calculate\", \"apply\"), wspace = NULL,         clump_kb = 250, clump_r2 = 0.1, clump_p = 1,         score = c(\"avg\", \"sum\", \"std\", \"con-std\"), perm = 10000,         seed = 42, rc = NULL)          runPRS(base, target = base, response, covariates = NULL,         pcs = FALSE, methods = c(\"lassosum\", \"prsice\"),         lassosumOpts = getDefaults(\"lassosum\"),         prsiceOpts = getDefaults(\"prsice\"), wspace = NULL,          rc = NULL)"},{"path":"/reference/prsFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to extract PRS candidates with various algorithms — prsFuns","text":"base GWASExperiment object GWA     tests performed containing summary statistics apart     genotypes. target GWASExperiment object     without GWA tests, ignored. PRS      calculated based target dataset. response trait PRS sought     extracted. character length 1 exist     phenotypes base target. covariates covariates include regression     models. character vector traits      existing phenotypes base      target. pcs Inlcude PCs regression model? Defaults     FALSE. mode mode run PRSice2. One calculating     extracting PRS (\"calculate\", default) applying     PRS given GWASExperiment existing prsbetas     (\"apply\"). wspace path workspace directory      PRSice. NULL, temporary folder used. anc One precalculated LD structures     lassosum, taken account extracting     PRS. can \"eur\" (default) European     ancestry, \"asn\" Asian \"afr\"     African. valid Validation mode lassosum PRS extraction.      One \"auto\" (default), \"split\"      \"stack\". See also lassosum package. gwe codeGWASExperiment object     slot effects /prsbetas filled. snpSelection data frame candidate SNPs,     output, part output      aggregatePrsMarkers, one list      members output selectPrs. type score prsicePRS     function (first three cases). clump_kb genomic interval (kbs) within      PRSice2 performs clumping. Defaults      250. clump_r2 R^2 threshold keep SNPs     clumping PRSice2. Defaults 0.1. clump_p p-value threshold SNPs      include clumping. Defaults 1. score PRSice2 calculate PRS?     One \"avg\" (default), \"sum\",      \"std\", \"con-std\". See also manual     PRSice2 Details. perm many permutations PRSice2     perform? Defaults 10000. seed Seed PRSice2 permutations,      reproducibility. Defaults 42. methods methods use PRS extraction,     one \"prsice\" \"lassosum\". lassosumOpts List options passed lassosum     (lassosumPRS). See also Details. prsiceOpts List options passed PRSice2     (prsicePRS). See also Details. rc fraction available cores use      parallel calculations. Default NULL     parallelization.","code":""},{"path":"/reference/prsFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to extract PRS candidates with various algorithms — prsFuns","text":"lassosumPRS prsicePRS, data     frame SNPs comprising extracted PRS,     compatible score files returned PGS     Catalog candidates returned complete prisma pipeline.     runPRS, input target    GWASExperiment object prsbetas    slots filled. Essentially effect weights     ORs SNPs comprising PRS.","code":""},{"path":"/reference/prsFuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Functions to extract PRS candidates with various algorithms — prsFuns","text":"Regarding score argument, controls     PRSice2 calculates PRS creates regression models     well reports . Although typically      prsiceOpts$score     argument main prisma pipeline     (prisma used),     obligatory PRISMA recalculates final PRS     reporting validating. However,     , actual score distribution differ much     PRSice2 results PRISMA results.","code":""},{"path":"/reference/prsFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to extract PRS candidates with various algorithms — prsFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/prsFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to extract PRS candidates with various algorithms — prsFuns","text":"","code":"data(toy,package=\"prisma\")     gdsfile(toy) <- system.file(package=\"prisma\",\"extdata\",\"toy.gds\")          # Only 1 PC will be returned because of dataset size     toy <- suppressWarnings(calcPcaCovar(toy,method=\"snprel\")) #> Performing PCA to select covariates to include in associations #> Reading GDS file /tmp/RtmpezHjqb/temp_libpath372f48f1c2bc/prisma/extdata/toy.gds... #> Performing LD pruning... #> SNP pruning based on LD: #> Excluding 0 SNP (non-autosomes or non-selection) #> Excluding 38 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) #>     # of samples: 100 #>     # of SNPs: 962 #>     using 1 thread #>     sliding window: 500,000 basepairs, Inf SNPs #>     |LD| threshold: 0.2 #>     method: composite #> Chromosome 18: 23.44%, 154/657 #> Chromosome 21: 21.28%, 73/343 #> 227 markers are selected in total. #> LD pruning finished! 227 SNPs will be used for PCA. #>  #> Performing PCA... #> Principal Component Analysis (PCA) on genotypes: #> Excluding 773 SNPs (non-autosomes or non-selection) #> Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) #>     # of samples: 100 #>     # of SNPs: 227 #>     using 1 thread #>     # of principal components: 32 #> PCA:    the sum of all selected genotypes (0,1,2) = 10268 #> CPU capabilities: Double-Precision SSE2 #> Mon Jun  6 20:20:29 2022    (internal increment: 13024) #>  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 1s #> Mon Jun  6 20:20:30 2022    Begin (eigenvalues and eigenvectors) #> Mon Jun  6 20:20:30 2022    Done. #> Selecting number of PCs to include #>   with Tracy-Widom test for significant eigenvalues #>     selected 1 PCs          toy <- gwa(toy,response=\"BMI\",covariates=c(\"Age\",\"Gender\"),         pcs=TRUE,psig=0.05,methods=c(\"glm\",\"statgen\")) #>  #> Starting GWA analysis in 2 chunks with 2 methods: glm, statgen #>  #> ========== Analyzing chromosome/part 18 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : Yes #>   testing SNPs from rs1009238 to rs1568327 #> Found 24 associations (uncorrected p-values). #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #> Found 24 associations (uncorrected p-values). #>  #> Combining p-values from multi-GWAS using fisher method #>  #> Overall, found 54 associations with (uncorrected) combined p-values). #>  #> ========== Analyzing chromosome/part 21 #>  #> Performing GWAS with GLM over 1 chunks #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Regression  : gaussian (predicted) #> Use PCs     : Yes #>   testing SNPs from rs2824974 to rs2828316 #> Found 18 associations (uncorrected p-values). #>  #> Preparing data for statgenGWAS... #> Performing GWAS with statgenGWAS model #> Trait(s)    : BMI #> Covariate(s): Age, Gender #> Use PCs     : Yes #> Found 18 associations (uncorrected p-values). #>  #> Combining p-values from multi-GWAS using fisher method #>  #> Overall, found 35 associations with (uncorrected) combined p-values). #>  #> Finished, the following putative associations were found per part: #>   Part 18: 54 associations found out of 657 markers #>   Part 21: 35 associations found out of 343 markers #>  #> Overall, found 89 associations with (uncorrected) combined p-values).          prsiceOpts <- getDefaults(\"prsice\")     prsiceOpts$perm <- 100          if (Sys.which(\"PRSice_linux\") != \"\")         toy <- runPRS(base=toy,response=\"BMI\",             covariates=c(\"Age\",\"Gender\"),pcs=TRUE,             prsiceOpts=prsiceOpts) #>  #> Starting PRS analysis with lassosum, prsice #>  #> ========== Running PRS analysis with lassosum #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/lassosum_WSJPC7148G #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/lassosum_WSJPC7148G #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/lassosum_WSJPC7148G/plink_lassosum_target_EIRID5993K.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/lassosum_WSJPC7148G/plink_lassosum_target_EIRID5993K.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/lassosum_WSJPC7148G/plink_lassosum_target_EIRID5993K.bed (SNP-major mode) #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Coordinating summary stats with reference panel... #> Coordinating summary stats with test data... #> Coordinating summary stats, reference panel, and test data... #> Splitting genome by LD blocks ... #> Running lassosum ... #> s =  0.2  #> s =  0.5  #> s =  0.9  #> Running lassosum with s=1... #> Calculating polygenic scores ... #> Running lassosum validation and PRS calculation #> 100 out of 100 samples kept in pheno. #> 100 out of 100 samples kept in covar. #> Done! R^2 is: 0.756356747467697 #>  #> ========== Running PRS analysis with prsice #> prsice operations will be executed at /tmp/Rtmpxo9Dha/prsice_FKVJN3606M #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/prsice_FKVJN3606M #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/prsice_FKVJN3606M/plink_prsice_WOGET5330Y.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/prsice_FKVJN3606M/plink_prsice_WOGET5330Y.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/prsice_FKVJN3606M/plink_prsice_WOGET5330Y.bed (SNP-major mode) #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/prsice_FKVJN3606M/base_WOGET5330Y \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/prsice_FKVJN3606M/pheno_WOGET5330Y \\ #>   --target /tmp/Rtmpxo9Dha/prsice_FKVJN3606M/plink_prsice_WOGET5330Y \\ #>   --cov /tmp/Rtmpxo9Dha/prsice_FKVJN3606M/covar_WOGET5330Y \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 1 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_WOGET5330Y \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.708854 #> Full model R^2 is: 0.867266 #> Null model R^2 is: 0.158412 #>  #> Running PRS algorithms finished! Processing the results... #> Done!          lprs <- lassosumPRS(base=toy,response=\"BMI\",         covariates=c(\"Age\",\"Gender\"),pcs=TRUE) #> lassosum operations will be executed at /tmp/Rtmpxo9Dha/lassosum_OAORP9897W #> Preparing lassosum run at workspace directory: /tmp/Rtmpxo9Dha/lassosum_OAORP9897W #>   preparing summary statistics... #>   preparing PLINK temporary files for target... #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/lassosum_OAORP9897W/plink_lassosum_target_VDWTZ8527W.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/lassosum_OAORP9897W/plink_lassosum_target_VDWTZ8527W.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/lassosum_OAORP9897W/plink_lassosum_target_VDWTZ8527W.bed (SNP-major mode) #>   copying linkage disequilibrium block files... #> Preparation done! #> Running lassosum PRS algorithm #> Coordinating summary stats with reference panel... #> Coordinating summary stats with test data... #> Coordinating summary stats, reference panel, and test data... #> Splitting genome by LD blocks ... #> Running lassosum ... #> s =  0.2  #> s =  0.5  #> s =  0.9  #> Running lassosum with s=1... #> Calculating polygenic scores ... #> Running lassosum validation and PRS calculation #> 100 out of 100 samples kept in pheno. #> 100 out of 100 samples kept in covar. #> Done! R^2 is: 0.756356747467697          if (Sys.which(\"PRSice_linux\") != \"\")         pprs <- prsicePRS(base=toy,response=\"BMI\",             covariates=c(\"Age\",\"Gender\"),pcs=TRUE,perm=100) #> prsice operations will be executed at /tmp/Rtmpxo9Dha/prsice_AYASI0629U #> Preparing PRSice run at workspace directory: /tmp/Rtmpxo9Dha/prsice_AYASI0629U #>   preparing summary statistics for the base file... #>   preparing the covariates file... #>   preparing the phenotype file... #>   preparing PLINK temporary files - target... #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/prsice_AYASI0629U/plink_prsice_RNNVO2324P.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/prsice_AYASI0629U/plink_prsice_RNNVO2324P.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/prsice_AYASI0629U/plink_prsice_RNNVO2324P.bed (SNP-major mode) #> Preparation done! #> Running PRSice PRS algorithm in calculate mode #>  #> Executing: #> Rscript /home/panos/.local/share/R/prsice-2.3.3/PRSice.R \\ #>   --prsice /home/panos/.local/share/R/prsice-2.3.3/PRSice_linux \\ #>   --base /tmp/Rtmpxo9Dha/prsice_AYASI0629U/base_RNNVO2324P \\ #>   --beta \\ #>   --binary-target F \\ #>   --pheno /tmp/Rtmpxo9Dha/prsice_AYASI0629U/pheno_RNNVO2324P \\ #>   --target /tmp/Rtmpxo9Dha/prsice_AYASI0629U/plink_prsice_RNNVO2324P \\ #>   --cov /tmp/Rtmpxo9Dha/prsice_AYASI0629U/covar_RNNVO2324P \\ #>   --clump-kb 250 \\ #>   --clump-r2 0.1 \\ #>   --clump-p 1 \\ #>   --score avg \\ #>   --seed 42 \\ #>   --out prsice_out_RNNVO2324P \\ #>   --print-snp \\ #>   --perm 100 #> Done! #> Adjusted PRSice R^2 is: 0.708854 #> Full model R^2 is: 0.867266 #> Null model R^2 is: 0.158412"},{"path":"/reference/prsRegressionMetrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate PRS evaluation metrics — prsRegressionMetrics","title":"Calculate PRS evaluation metrics — prsRegressionMetrics","text":"function fits regression model given number     SNPs PRS calculated, iterative      manner. , several metrics goodness fit     calculated returned.","code":""},{"path":"/reference/prsRegressionMetrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate PRS evaluation metrics — prsRegressionMetrics","text":"","code":"prsRegressionMetrics(snpSelection, gwe, response,          covariates = NULL, pcs = FALSE, step = 10, family = NULL,         rc = NULL, ...)"},{"path":"/reference/prsRegressionMetrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate PRS evaluation metrics — prsRegressionMetrics","text":"snpSelection data frame candidate SNPs,     output, part output      aggregatePrsMarkers, one list      members output selectPrs. gwe GWASExperiment object (one     used generate prismaOut). response trait PRS sought     extracted. character length 1 exist     phenotypes gwe. covariates covariates include regression     models. character vector traits      existing phenotypes gwe. pcs Include PCs gwe regression     models? Defaults FALSE. step Increment step number SNPs     snpSelection include iterative evaluation.     Defaults 10. family Regression family functions, e.g.      \"gaussian\" classical linear regression     \"binomial\" logistic regression. See also     gwa. Defaults NULL trying     set automatically. rc fraction available cores use      parallel calculations. Default NULL     parallelization. ... arguments passed glm     regression functions.","code":""},{"path":"/reference/prsRegressionMetrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate PRS evaluation metrics — prsRegressionMetrics","text":"data frame regression fit metrics, containing     following columns: n_snp: number SNPs PRS          evaluated freq: frequency appearance         SNPs full_r2: R^2 full regression         model, .e. regression model including          covariates PRS full_pvalue: p-value full         regression model prs_pvalue: p-value PRS         coefficient model full_aic: AIC full          regression model reduced_r2: R^2 reduced         model, .e. regression model including          covariates excluding PRS prs_r2: R^2 attributed PRS         (full_r2 - reduced_r2) reduced_pvalue: p-value          reduced regression model reduced_aic: AIC reduced         regression model prs_aic: AIC PRS          (full_aic - reduced_aic)","code":""},{"path":"/reference/prsRegressionMetrics.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate PRS evaluation metrics — prsRegressionMetrics","text":"Panagiotis Moulos","code":""},{"path":"/reference/prsRegressionMetrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate PRS evaluation metrics — prsRegressionMetrics","text":"","code":"data(toy,package=\"prisma\")     data(prisma_out,package=\"prisma\")          response <- \"BMI\"     covariates <- c(\"Case_Control\",\"Gender\",\"Age\")          can <- getPrsCandidates(prismaOut,\"glm\",1)     m <- prsRegressionMetrics(can,toy,response=response,         covariates=covariates,pcs=FALSE) #>  #> Regressing with GLM #> Trait(s)    : BMI #> Covariate(s): Case_Control, Gender, Age #> Regression  : gaussian (predicted) #> Use PCs     : No #> Creating the reduced model #> Creating the null model #> Testing full models #>   testing PRS with SNPs from rs11876399 to rs2825190 #>   testing PRS with SNPs from rs11876399 to rs8093690 #>   testing PRS with SNPs from rs11876399 to rs9977496"},{"path":"/reference/pvalCombineFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"GWA test p-value combination functions — pvalCombineFuns","title":"GWA test p-value combination functions — pvalCombineFuns","text":"group fuctions can used calculate     combined p-values, p-value typically     derived genome-wide association test     SNP group SNPs phenotype.","code":""},{"path":"/reference/pvalCombineFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GWA test p-value combination functions — pvalCombineFuns","text":"","code":"combineHarmonic(p, w = NULL, zerofix = NULL)     combineMaxp(p)     combineMinp(p)     combineSimes(p, zerofix = NULL)     combineWeight(p, w = NULL, zerofix = NULL)          fisherMethod(p, zerofix = NULL)"},{"path":"/reference/pvalCombineFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GWA test p-value combination functions — pvalCombineFuns","text":"p numeric vector p-values matrix     fisherMethod. w weights vector, must sum 1. zerofix NULL (default) fixed      numeric value 0 1.","code":""},{"path":"/reference/pvalCombineFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GWA test p-value combination functions — pvalCombineFuns","text":"new p-value, derived combination  p.","code":""},{"path":"/reference/pvalCombineFuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"GWA test p-value combination functions — pvalCombineFuns","text":"combineHarmonic function combines vector     p-values using method Wilson, 2019      https://www.pnas.org/content/116/4/1195     user- prisma- provided weights. combineMaxp, combineMinp functions      combine vector p-values using maximum p-value     (equivalent interesection lists significant     SNPs returned several GWA tests) using     minimum p-value (equivalent union lists      significant SNPs returned several GWA tests). combineSimes function combines vector     p-values using method Simes, 1986 method. combineWeight function combines vector     p-values using PANDORA algorithm described     Moulos Hatzis, 2015 (PMID: 25452340) Fanidis     Moulos, 2020 (PMID: 32778872), based     weighted p-value combination based simulations     real data. fisherMethod function combines vector     p-values using respective method Fisher. argument zerofix used correct     case p-value equal 0 result     internal numerical approximation procedures.     NULL, random numbers greater 0     less equal 0.5 used multiply     offending p-values lowest provided non-zero     p-value, maintaining thus virtual order      significance, avoiding p-values      two tests assuming zero p-values represent     extreme statistical significance. numeric     0 1, number used     multiplication instead.","code":""},{"path":"/reference/pvalCombineFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"GWA test p-value combination functions — pvalCombineFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/pvalCombineFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GWA test p-value combination functions — pvalCombineFuns","text":"","code":"w <- c(0.2,0.5,0.3)     p <- runif(3)          pha <- combineHarmonic(p,w)     pma <- combineMaxp(p)     pmi <- combineMinp(p)     psi <- combineSimes(p)     pwe <- combineWeight(p,w)          pm <- matrix(runif(300),100,3)          pha <- apply(pm,1,combineHarmonic,w)     pma <- apply(pm,1,combineMaxp)     pmi <- apply(pm,1,combineMinp)     psi <- apply(pm,1,combineSimes)     pwe <- apply(pm,1,combineWeight,w)          pwf <- fisherMethod(pm)"},{"path":"/reference/rsLocsFromEnsembl.html","id":null,"dir":"Reference","previous_headings":"","what":"Fill up missing SNP locations using biomaRt — rsLocsFromEnsembl","title":"Fill up missing SNP locations using biomaRt — rsLocsFromEnsembl","text":"function queries Ensembl retrieve SNP info     set rs ids. can used retrieve     information salvage ambiguous previously      unmapped SNPs older datasets. Also heavily used     mergeGWAS function.","code":""},{"path":"/reference/rsLocsFromEnsembl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fill up missing SNP locations using biomaRt — rsLocsFromEnsembl","text":"","code":"rsLocsFromEnsembl(rs, gv = c(\"hg38\", \"hg19\"),          canonical = TRUE)"},{"path":"/reference/rsLocsFromEnsembl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fill up missing SNP locations using biomaRt — rsLocsFromEnsembl","text":"rs character vector SNP (rs) ids. gv human genome version (\"hg38\",      \"hg19\"). canonical check canonical chromosomes?      Defaults TRUE.","code":""},{"path":"/reference/rsLocsFromEnsembl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fill up missing SNP locations using biomaRt — rsLocsFromEnsembl","text":"data frame following columns: chr_name: chromosome name chrom_start: SNP position refsnp_id: reference SNP id          (usually dbSNP) allele: major allele minor_allele: minor allele minor_allele_freq: recorded minor          allele frequency chrom_strand: SNP strand","code":""},{"path":"/reference/rsLocsFromEnsembl.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fill up missing SNP locations using biomaRt — rsLocsFromEnsembl","text":"Panagiotis Moulos","code":""},{"path":"/reference/rsLocsFromEnsembl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fill up missing SNP locations using biomaRt — rsLocsFromEnsembl","text":"","code":"if (FALSE) {     # Requires active internet connection!     rs <- c(\"rs1009238\",\"rs2212890\")     info <- rsLocsFromEnsembl(rs) }"},{"path":"/reference/selectPrs.html","id":null,"dir":"Reference","previous_headings":"","what":"Select a PRS given validation metrics — selectPrs","title":"Select a PRS given validation metrics — selectPrs","text":"suggests list PRS candidates given series     evaluation metrics selection criteria.     part main PRISMA pipeline.","code":""},{"path":"/reference/selectPrs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select a PRS given validation metrics — selectPrs","text":"","code":"selectPrs(metrics, snpSelection, gwe,          method = c(\"maxima\", \"elbow\"),         crit = c(\"prs_r2\", \"prs_pvalue\", \"prs_aic\"),         stat = c(\"mean\", \"median\", \"none\"),         r2type = c(\"adjusted\", \"raw\"), base = NULL)"},{"path":"/reference/selectPrs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select a PRS given validation metrics — selectPrs","text":"metrics list metrics returned      prsSelection. snpSelection data frame candidate SNPs,     output, part output      aggregatePrsMarkers, one list      members output selectPrs. gwe GWASExperiment object used derive     PRS candidates. method select number SNPs     PRS niter iterations. One     \"maxima\" (default) \"elbow\". See also     Details. crit One \"prs_r2\" (default),      \"prs_pvalue\" \"prs_aic\". Determines     criterion used PRS selection. See also Details. stat One \"mean\" (default),     \"median\" \"none\". Determines     calculated statistic (mean, median) used summarize     prsSelectCrit evaluation metrics     applicable (e.g. applicable p-values). r2type One \"adjusted\" (default)      \"raw\". first one uses PRS contribution     evaluation regression model second one      R^2 full model. base vector preferred R^2 values serve     baseline R^2 result refinement.","code":""},{"path":"/reference/selectPrs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select a PRS given validation metrics — selectPrs","text":"named list names \"main\"  \"others\". former contains best candidate     according selection criteria latter     list rest candidates, named     number SNPs candidate.","code":""},{"path":"/reference/selectPrs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select a PRS given validation metrics — selectPrs","text":"Regarding method argument, controls      final PRS selected based given evaluation     metrics (typically PRS R^2). \"maxima\"      (default), distribution PRS R^2 values created      PRS R^2 values (rarer, chosen metric)      derived niter iterations. distribution      (R^2-related) may adjusted according      number SNPs comrpising PRS, according      crit argument. , distribution,      local maxima calculated. local maximum      highest R^2 considered best candidate      provides number SNPs. maxima      returned also candidates. \"elbow\"      elbow point method used determining      optimal number SNPs. elbow method heuristic      used determining number features data set      respect optimization criterion. case      criterion value PRS R^2 method      consists plotting PRS explained variation (     depicted R^2) function number SNPs      PRS. Regarding crit argument, controls      criterion used select final PRS end      iterative process according evaluation      metrics. \"prs_r2\" (default), decision      making plots prsSelectMethod operate      PRS R^2 calculated PRS extraction iteration.      \"prs_pvalue\", -log_10(PRS p-valye)      used \"prs_aic\", AIC (Akaike's      Information Criterion) used.","code":""},{"path":"/reference/selectPrs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Select a PRS given validation metrics — selectPrs","text":"Panagiotis Moulos","code":""},{"path":"/reference/selectPrs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select a PRS given validation metrics — selectPrs","text":"","code":"# Check the examples in prisma man page"},{"path":"/reference/splitFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to split datasets in training and test samples — splitFuns","title":"Functions to split datasets in training and test samples — splitFuns","text":"functions used create training testing     splits used iterative PRS extraction process     PRISMA. losely based dataset      partitoning functions R package caret can also      used independently general pipeline.","code":""},{"path":"/reference/splitFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to split datasets in training and test samples — splitFuns","text":"","code":"createSplit(y, n = 1, frac = 0.5, ngrp = min(5, length(y)),         replace = FALSE, out = c(\"index\", \"binary\"), rc = NULL)          partitionGWAS(obj, by, n = 1, frac = 0.5,          ngrp = min(5, ncol(obj)), replace = FALSE,         out = c(\"index\", \"train\", \"ttboth\"), rc = NULL)"},{"path":"/reference/splitFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to split datasets in training and test samples — splitFuns","text":"y vector numeric values split     \"training\" \"test\" set return respective     indices. obj Instead y , GWASExperiment     object. phenotype obj used     splitting. scalar character. n many splits create? Defaults 1. frac fraction values remain     \"training\" set. Defaults 0.5. ngrp many \"virtual\" groups y     split? Controls uniformity values two     resulting sets. See also Details. replace Sample values/samples replacement?     Defaults FALSE. createSplit, either \"index\"     (default) return list length n      \"training\" index splits, \"binary\" return     list instead indices, contains     mask 0s 1s indicating samples     selected discarded \"training\"     set. partitionGWAS, either \"index\"      (default createSplitm now     indices refer columns obj),      \"train\" return GWASExperiment     training samples, \"ttboth\" return     list GWASExperiments. latter case,     list named members names train      test respectively value n     ignored, returning one split. rc fraction available cores use      parallel calculations. Default NULL     parallelization.","code":""},{"path":"/reference/splitFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to split datasets in training and test samples — splitFuns","text":"createSplit, list length n    splits form vector indices     binary mask 1s training samples     0s test samples.     partitionGWAS, list indices     list GWASExperiment objects used     training samples, list training     testing GWASExperiment objects.","code":""},{"path":"/reference/splitFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Functions to split datasets in training and test samples — splitFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/splitFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to split datasets in training and test samples — splitFuns","text":"","code":"data(toy,package=\"prisma\")          trainTest <- partitionGWAS(toy,by=\"BMI\",out=\"ttboth\") #> Partitioning dataset into 1 partitions by BMI          y <- phenotypes(toy)$BMI     z <- createSplit(y,frac=0.8,n=5)"},{"path":"/reference/toy.html","id":null,"dir":"Reference","previous_headings":"","what":"A toy GWASExperiment dataset with 2 chromosomes — toy","title":"A toy GWASExperiment dataset with 2 chromosomes — toy","text":"data set contains genotypes chromosomes 18 21     case/control study specified source.     used examples tests prisma package.","code":""},{"path":"/reference/toy.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A toy GWASExperiment dataset with 2 chromosomes — toy","text":"small GWASExperiment demo purposes.","code":""},{"path":"/reference/toy.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A toy GWASExperiment dataset with 2 chromosomes — toy","text":"Kalafati et al. (https://doi.org/10.1016/j.nut.2018.10.032)","code":""},{"path":"/reference/toy.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A toy GWASExperiment dataset with 2 chromosomes — toy","text":"Panagiotis Moulos","code":""},{"path":"/reference/twTest.html","id":null,"dir":"Reference","previous_headings":"","what":"Tracy-Widom test for selection of PCs — twTest","title":"Tracy-Widom test for selection of PCs — twTest","text":"function implements Tracy-Widom statistic     assessment significant principal     components Principal Component Analysis.     implemented based assumptions described Zhao     et al., PMID: 30507552","code":""},{"path":"/reference/twTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tracy-Widom test for selection of PCs — twTest","text":"","code":"twTest(eigv, p = 0.05, tol = 1e-8)"},{"path":"/reference/twTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tracy-Widom test for selection of PCs — twTest","text":"eigv eigen values calculated PCA.     See also Details. p p-value cutoff test significance. tol value replace eigen values     smaller value. Required internal     calculations.","code":""},{"path":"/reference/twTest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tracy-Widom test for selection of PCs — twTest","text":"named list members: tw containing     TW statistic eigen value, pval    containing p-values index containing     index significant eigen values, aka PCs.","code":""},{"path":"/reference/twTest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Tracy-Widom test for selection of PCs — twTest","text":"Regarding eigv input, can retrieved     according method package used     PCA. example, robust PCA used (package     rrcov), getEigenvalues function can used     get eigen values. prcomp     used, eigv squared sdev      component prcomp output.","code":""},{"path":"/reference/twTest.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tracy-Widom test for selection of PCs — twTest","text":"Panagiotis Moulos","code":""},{"path":"/reference/twTest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tracy-Widom test for selection of PCs — twTest","text":"","code":"# Matrix borrowed from prcomp man page C <- chol(S <- toeplitz(0.9^(0:31))) X <- matrix(rnorm(32000),1000,32) Z <- X   P <- prcomp(Z) tw <- twTest(P$sdev^2) #> Warning: No signficant PCs found! Will return the first one... # tw$index provides the significant PCs identical(tw$index,which(tw$pval<0.05)) # TRUE #> [1] FALSE"},{"path":"/reference/writeFuns.html","id":null,"dir":"Reference","previous_headings":"","what":"PLINK and GDS files from GWASExperiment — writeFuns","title":"PLINK and GDS files from GWASExperiment — writeFuns","text":"function writes GWASExperiment object     triplet PLINK BID/BED/BAM file(s). split per     chromosome also possible. pheno argument     controls phenotype written (desired)     respective column FAM file.","code":""},{"path":"/reference/writeFuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PLINK and GDS files from GWASExperiment — writeFuns","text":"","code":"writeGdsFile(obj, gdsfile = NULL)          writePlink(obj, pheno = NULL, outBase = NULL, salvage = FALSE,         reverse = FALSE, perChr = FALSE, overwrite = TRUE)"},{"path":"/reference/writeFuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PLINK and GDS files from GWASExperiment — writeFuns","text":"obj object GWASExperiment class     least genotypic data. gdsfile path GDS file written.     NULL (unadvised!), tempfile. pheno name phenotype written     respective FAM column. outBase full path base PLINK      files triplet. .e. extension .bim,     .bed .fam. salvage try salvage SNPs missing locations?     Defaults FALSE. See also Details. reverse Reverse allele genotypes prior write?     Defaults FALSE. perChr Write one PLINK triplet per chromosome?     Defaults FALSE. overwrite Overwrite previous files     name? Defaults TRUE.","code":""},{"path":"/reference/writeFuns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PLINK and GDS files from GWASExperiment — writeFuns","text":"function return anything, just writes     PLINK files desired location.","code":""},{"path":"/reference/writeFuns.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"PLINK and GDS files from GWASExperiment — writeFuns","text":"Panagiotis Moulos","code":""},{"path":"/reference/writeFuns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PLINK and GDS files from GWASExperiment — writeFuns","text":"","code":"data(toy,package=\"prisma\")     out <- tempfile()     writePlink(toy,pheno=\"BMI\",outBase=out) #> Preflight... #> Writing FAM file to /tmp/Rtmpxo9Dha/file381e52a1601e.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/file381e52a1601e.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/file381e52a1601e.bed (SNP-major mode) #> NULL          gdsf <- tempfile()     writeGdsFile(toy,gdsfile=gdsf) #> Writing FAM file to /tmp/Rtmpxo9Dha/file381e2d526b7e.fam  #> Writing extended MAP file to /tmp/Rtmpxo9Dha/file381e2d526b7e.bim  #> Writing BED file to /tmp/Rtmpxo9Dha/file381e2d526b7e.bed (SNP-major mode) #> Start file conversion from PLINK BED to SNP GDS ... #>     BED file: '/tmp/Rtmpxo9Dha/file381e2d526b7e.bed' #>         SNP-major mode (Sample X SNP), 24.4K #>     FAM file: '/tmp/Rtmpxo9Dha/file381e2d526b7e.fam' #>     BIM file: '/tmp/Rtmpxo9Dha/file381e2d526b7e.bim' #> Mon Jun  6 20:21:14 2022     (store sample id, snp id, position, and chromosome) #>     start writing: 100 samples, 1000 SNPs ... #>  [..................................................]  0%, ETC: ---         [==================================================] 100%, completed, 0s #> Mon Jun  6 20:21:14 2022 \tDone. #> Optimize the access efficiency ... #> Clean up the fragments of GDS file: #>     open the file '/tmp/Rtmpxo9Dha/file381e5c4c588c' (34.6K) #>     # of fragments: 50 #>     save to '/tmp/Rtmpxo9Dha/file381e5c4c588c.tmp' #>     rename '/tmp/Rtmpxo9Dha/file381e5c4c588c.tmp' (34.3K, reduced: 312B) #>     # of fragments: 24 #> [1] \"/tmp/Rtmpxo9Dha/file381e5c4c588c\""}]
